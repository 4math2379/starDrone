<!DOCTYPE html>
<html>
<head>
  <title>browser.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/hawk/lib/browser.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>browser.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>HTTP Hawk Authentication Scheme
Copyright (c) 2012-2014, Eran Hammer <a href="mailto:eran@hammer.io.html">eran@hammer.io</a>
BSD Licensed</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Declare namespace</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> hawk = {
    <span class="hljs-attr">internals</span>: {}
};


hawk.client = {

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Generate an Authorization header for a given request</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>uri: 'http://example.com/resource?a=b' or object generated by hawk.utils.parseUri()
method: HTTP verb (e.g. 'GET', 'POST')
options: {</p>
<p>// Required</p>
<p>credentials: {
id: 'dh37fgj492je',
key: 'aoijedoaijsdlaksjdl',
algorithm: 'sha256'                                 // 'sha1', 'sha256'
},</p>
<p>// Optional</p>
<p>ext: 'application-specific',                        // Application specific data sent via the ext attribute
timestamp: Date.now() / 1000,                       // A pre-calculated timestamp in seconds
nonce: '2334f34f',                                  // A pre-generated nonce
localtimeOffsetMsec: 400,                           // Time offset to sync with server time (ignored if timestamp provided)
payload: '{&quot;some&quot;:&quot;payload&quot;}',                      // UTF-8 encoded string for body hash generation (ignored if hash provided)
contentType: 'application/json',                    // Payload content-type (ignored if hash provided)
hash: 'U4MKKSmiVxk37JCCrAVIjV=',                    // Pre-calculated payload hash
app: '24s23423f34dx',                               // Oz application id
dlg: '234sz34tww3sd'                                // Oz delegated-by application id
}</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    header: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">uri, method, options</span>) </span>{

        <span class="hljs-keyword">var</span> result = {
            <span class="hljs-attr">field</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">artifacts</span>: {}
        };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Validate inputs</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">if</span> (!uri || (<span class="hljs-keyword">typeof</span> uri !== <span class="hljs-string">'string'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> uri !== <span class="hljs-string">'object'</span>) ||
            !method || <span class="hljs-keyword">typeof</span> method !== <span class="hljs-string">'string'</span> ||
            !options || <span class="hljs-keyword">typeof</span> options !== <span class="hljs-string">'object'</span>) {

            result.err = <span class="hljs-string">'Invalid argument type'</span>;
            <span class="hljs-keyword">return</span> result;
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Application time</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> timestamp = options.timestamp || hawk.utils.now(options.localtimeOffsetMsec);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Validate credentials</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> credentials = options.credentials;
        <span class="hljs-keyword">if</span> (!credentials ||
            !credentials.id ||
            !credentials.key ||
            !credentials.algorithm) {

            result.err = <span class="hljs-string">'Invalid credentials object'</span>;
            <span class="hljs-keyword">return</span> result;
        }

        <span class="hljs-keyword">if</span> (hawk.crypto.algorithms.indexOf(credentials.algorithm) === <span class="hljs-number">-1</span>) {
            result.err = <span class="hljs-string">'Unknown algorithm'</span>;
            <span class="hljs-keyword">return</span> result;
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Parse URI</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> uri === <span class="hljs-string">'string'</span>) {
            uri = hawk.utils.parseUri(uri);
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Calculate signature</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> artifacts = {
            <span class="hljs-attr">ts</span>: timestamp,
            <span class="hljs-attr">nonce</span>: options.nonce || hawk.utils.randomString(<span class="hljs-number">6</span>),
            <span class="hljs-attr">method</span>: method,
            <span class="hljs-attr">resource</span>: uri.resource,
            <span class="hljs-attr">host</span>: uri.host,
            <span class="hljs-attr">port</span>: uri.port,
            <span class="hljs-attr">hash</span>: options.hash,
            <span class="hljs-attr">ext</span>: options.ext,
            <span class="hljs-attr">app</span>: options.app,
            <span class="hljs-attr">dlg</span>: options.dlg
        };

        result.artifacts = artifacts;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Calculate payload hash</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">if</span> (!artifacts.hash &amp;&amp;
            (options.payload || options.payload === <span class="hljs-string">''</span>)) {

            artifacts.hash = hawk.crypto.calculatePayloadHash(options.payload, credentials.algorithm, options.contentType);
        }

        <span class="hljs-keyword">var</span> mac = hawk.crypto.calculateMac(<span class="hljs-string">'header'</span>, credentials, artifacts);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Construct header</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> hasExt = artifacts.ext !== <span class="hljs-literal">null</span> &amp;&amp; artifacts.ext !== <span class="hljs-literal">undefined</span> &amp;&amp; artifacts.ext !== <span class="hljs-string">''</span>;       <span class="hljs-comment">// Other falsey values allowed</span>
        <span class="hljs-keyword">var</span> header = <span class="hljs-string">'Hawk id="'</span> + credentials.id +
                     <span class="hljs-string">'", ts="'</span> + artifacts.ts +
                     <span class="hljs-string">'", nonce="'</span> + artifacts.nonce +
                     (artifacts.hash ? <span class="hljs-string">'", hash="'</span> + artifacts.hash : <span class="hljs-string">''</span>) +
                     (hasExt ? <span class="hljs-string">'", ext="'</span> + hawk.utils.escapeHeaderAttribute(artifacts.ext) : <span class="hljs-string">''</span>) +
                     <span class="hljs-string">'", mac="'</span> + mac + <span class="hljs-string">'"'</span>;

        <span class="hljs-keyword">if</span> (artifacts.app) {
            header += <span class="hljs-string">', app="'</span> + artifacts.app +
                      (artifacts.dlg ? <span class="hljs-string">'", dlg="'</span> + artifacts.dlg : <span class="hljs-string">''</span>) + <span class="hljs-string">'"'</span>;
        }

        result.field = header;

        <span class="hljs-keyword">return</span> result;
    },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Generate a bewit value for a given URI</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>uri: 'http://example.com/resource?a=b'
options: {</p>
<p>// Required</p>
<p>credentials: {
id: 'dh37fgj492je',
key: 'aoijedoaijsdlaksjdl',
algorithm: 'sha256'                             // 'sha1', 'sha256'
},
ttlSec: 60 * 60,                                    // TTL in seconds</p>
<p>// Optional</p>
<p>ext: 'application-specific',                        // Application specific data sent via the ext attribute
localtimeOffsetMsec: 400                            // Time offset to sync with server time
};</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    bewit: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">uri, options</span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>Validate inputs</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">if</span> (!uri ||
            (<span class="hljs-keyword">typeof</span> uri !== <span class="hljs-string">'string'</span>) ||
            !options ||
            <span class="hljs-keyword">typeof</span> options !== <span class="hljs-string">'object'</span> ||
            !options.ttlSec) {

            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
        }

        options.ext = (options.ext === <span class="hljs-literal">null</span> || options.ext === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">''</span> : options.ext);       <span class="hljs-comment">// Zero is valid value</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Application time</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> now = hawk.utils.now(options.localtimeOffsetMsec);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>Validate credentials</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> credentials = options.credentials;
        <span class="hljs-keyword">if</span> (!credentials ||
            !credentials.id ||
            !credentials.key ||
            !credentials.algorithm) {

            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
        }

        <span class="hljs-keyword">if</span> (hawk.crypto.algorithms.indexOf(credentials.algorithm) === <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Parse URI</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        uri = hawk.utils.parseUri(uri);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Calculate signature</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> exp = now + options.ttlSec;
        <span class="hljs-keyword">var</span> mac = hawk.crypto.calculateMac(<span class="hljs-string">'bewit'</span>, credentials, {
            <span class="hljs-attr">ts</span>: exp,
            <span class="hljs-attr">nonce</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
            <span class="hljs-attr">resource</span>: uri.resource,                            <span class="hljs-comment">// Maintain trailing '?' and query params</span>
            host: uri.host,
            <span class="hljs-attr">port</span>: uri.port,
            <span class="hljs-attr">ext</span>: options.ext
        });

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>Construct bewit: id\exp\mac\ext</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> bewit = credentials.id + <span class="hljs-string">'\\'</span> + exp + <span class="hljs-string">'\\'</span> + mac + <span class="hljs-string">'\\'</span> + options.ext;
        <span class="hljs-keyword">return</span> hawk.utils.base64urlEncode(bewit);
    },

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>Validate server response</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<div class="dox">
<div class="summary">
<p>request:    object created via 'new XMLHttpRequest()' after response received
artifacts:  object received from header().artifacts
options: {
payload:    optional payload received
required:   specifies if a Server-Authorization header is required. Defaults to 'false'
}</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    authenticate: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">request, credentials, artifacts, options</span>) </span>{

        options = options || {};

        <span class="hljs-keyword">var</span> getHeader = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{

            <span class="hljs-keyword">return</span> request.getResponseHeader ? request.getResponseHeader(name) : request.getHeader(name);
        };

        <span class="hljs-keyword">var</span> wwwAuthenticate = getHeader(<span class="hljs-string">'www-authenticate'</span>);
        <span class="hljs-keyword">if</span> (wwwAuthenticate) {

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>Parse HTTP WWW-Authenticate header</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
            <span class="hljs-keyword">var</span> wwwAttributes = hawk.utils.parseAuthorizationHeader(wwwAuthenticate, [<span class="hljs-string">'ts'</span>, <span class="hljs-string">'tsm'</span>, <span class="hljs-string">'error'</span>]);
            <span class="hljs-keyword">if</span> (!wwwAttributes) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }

            <span class="hljs-keyword">if</span> (wwwAttributes.ts) {
                <span class="hljs-keyword">var</span> tsm = hawk.crypto.calculateTsMac(wwwAttributes.ts, credentials);
                <span class="hljs-keyword">if</span> (tsm !== wwwAttributes.tsm) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }

                hawk.utils.setNtpOffset(wwwAttributes.ts - <span class="hljs-built_in">Math</span>.floor((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getTime() / <span class="hljs-number">1000</span>));     <span class="hljs-comment">// Keep offset at 1 second precision</span>
            }
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>Parse HTTP Server-Authorization header</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> serverAuthorization = getHeader(<span class="hljs-string">'server-authorization'</span>);
        <span class="hljs-keyword">if</span> (!serverAuthorization &amp;&amp;
            !options.required) {

            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }

        <span class="hljs-keyword">var</span> attributes = hawk.utils.parseAuthorizationHeader(serverAuthorization, [<span class="hljs-string">'mac'</span>, <span class="hljs-string">'ext'</span>, <span class="hljs-string">'hash'</span>]);
        <span class="hljs-keyword">if</span> (!attributes) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">var</span> modArtifacts = {
            <span class="hljs-attr">ts</span>: artifacts.ts,
            <span class="hljs-attr">nonce</span>: artifacts.nonce,
            <span class="hljs-attr">method</span>: artifacts.method,
            <span class="hljs-attr">resource</span>: artifacts.resource,
            <span class="hljs-attr">host</span>: artifacts.host,
            <span class="hljs-attr">port</span>: artifacts.port,
            <span class="hljs-attr">hash</span>: attributes.hash,
            <span class="hljs-attr">ext</span>: attributes.ext,
            <span class="hljs-attr">app</span>: artifacts.app,
            <span class="hljs-attr">dlg</span>: artifacts.dlg
        };

        <span class="hljs-keyword">var</span> mac = hawk.crypto.calculateMac(<span class="hljs-string">'response'</span>, credentials, modArtifacts);
        <span class="hljs-keyword">if</span> (mac !== attributes.mac) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">if</span> (!options.payload &amp;&amp;
            options.payload !== <span class="hljs-string">''</span>) {

            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }

        <span class="hljs-keyword">if</span> (!attributes.hash) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">var</span> calculatedHash = hawk.crypto.calculatePayloadHash(options.payload, credentials.algorithm, getHeader(<span class="hljs-string">'content-type'</span>));
        <span class="hljs-keyword">return</span> (calculatedHash === attributes.hash);
    },

    <span class="hljs-attr">message</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">host, port, message, options</span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>Validate inputs</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">if</span> (!host || <span class="hljs-keyword">typeof</span> host !== <span class="hljs-string">'string'</span> ||
            !port || <span class="hljs-keyword">typeof</span> port !== <span class="hljs-string">'number'</span> ||
            message === <span class="hljs-literal">null</span> || message === <span class="hljs-literal">undefined</span> || <span class="hljs-keyword">typeof</span> message !== <span class="hljs-string">'string'</span> ||
            !options || <span class="hljs-keyword">typeof</span> options !== <span class="hljs-string">'object'</span>) {

            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>Application time</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> timestamp = options.timestamp || hawk.utils.now(options.localtimeOffsetMsec);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>Validate credentials</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> credentials = options.credentials;
        <span class="hljs-keyword">if</span> (!credentials ||
            !credentials.id ||
            !credentials.key ||
            !credentials.algorithm) {

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>Invalid credential object</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">if</span> (hawk.crypto.algorithms.indexOf(credentials.algorithm) === <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>Calculate signature</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> artifacts = {
            <span class="hljs-attr">ts</span>: timestamp,
            <span class="hljs-attr">nonce</span>: options.nonce || hawk.utils.randomString(<span class="hljs-number">6</span>),
            <span class="hljs-attr">host</span>: host,
            <span class="hljs-attr">port</span>: port,
            <span class="hljs-attr">hash</span>: hawk.crypto.calculatePayloadHash(message, credentials.algorithm)
        };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p>Construct authorization</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
        <span class="hljs-keyword">var</span> result = {
            <span class="hljs-attr">id</span>: credentials.id,
            <span class="hljs-attr">ts</span>: artifacts.ts,
            <span class="hljs-attr">nonce</span>: artifacts.nonce,
            <span class="hljs-attr">hash</span>: artifacts.hash,
            <span class="hljs-attr">mac</span>: hawk.crypto.calculateMac(<span class="hljs-string">'message'</span>, credentials, artifacts)
        };

        <span class="hljs-keyword">return</span> result;
    },

    <span class="hljs-attr">authenticateTimestamp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message, credentials, updateClock</span>) </span>{           <span class="hljs-comment">// updateClock defaults to true</span>

        <span class="hljs-keyword">var</span> tsm = hawk.crypto.calculateTsMac(message.ts, credentials);
        <span class="hljs-keyword">if</span> (tsm !== message.tsm) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">if</span> (updateClock !== <span class="hljs-literal">false</span>) {
            hawk.utils.setNtpOffset(message.ts - <span class="hljs-built_in">Math</span>.floor((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getTime() / <span class="hljs-number">1000</span>));    <span class="hljs-comment">// Keep offset at 1 second precision</span>
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
};


hawk.crypto = {

    <span class="hljs-attr">headerVersion</span>: <span class="hljs-string">'1'</span>,

    <span class="hljs-attr">algorithms</span>: [<span class="hljs-string">'sha1'</span>, <span class="hljs-string">'sha256'</span>],

    <span class="hljs-attr">calculateMac</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">type, credentials, options</span>) </span>{

        <span class="hljs-keyword">var</span> normalized = hawk.crypto.generateNormalizedString(type, options);

        <span class="hljs-keyword">var</span> hmac = CryptoJS[<span class="hljs-string">'Hmac'</span> + credentials.algorithm.toUpperCase()](normalized, credentials.key);
        <span class="hljs-keyword">return</span> hmac.toString(CryptoJS.enc.Base64);
    },

    <span class="hljs-attr">generateNormalizedString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">type, options</span>) </span>{

        <span class="hljs-keyword">var</span> normalized = <span class="hljs-string">'hawk.'</span> + hawk.crypto.headerVersion + <span class="hljs-string">'.'</span> + type + <span class="hljs-string">'\n'</span> +
                         options.ts + <span class="hljs-string">'\n'</span> +
                         options.nonce + <span class="hljs-string">'\n'</span> +
                         (options.method || <span class="hljs-string">''</span>).toUpperCase() + <span class="hljs-string">'\n'</span> +
                         (options.resource || <span class="hljs-string">''</span>) + <span class="hljs-string">'\n'</span> +
                         options.host.toLowerCase() + <span class="hljs-string">'\n'</span> +
                         options.port + <span class="hljs-string">'\n'</span> +
                         (options.hash || <span class="hljs-string">''</span>) + <span class="hljs-string">'\n'</span>;

        <span class="hljs-keyword">if</span> (options.ext) {
            normalized += options.ext.replace(<span class="hljs-string">'\\'</span>, <span class="hljs-string">'\\\\'</span>).replace(<span class="hljs-string">'\n'</span>, <span class="hljs-string">'\\n'</span>);
        }

        normalized += <span class="hljs-string">'\n'</span>;

        <span class="hljs-keyword">if</span> (options.app) {
            normalized += options.app + <span class="hljs-string">'\n'</span> +
                          (options.dlg || <span class="hljs-string">''</span>) + <span class="hljs-string">'\n'</span>;
        }

        <span class="hljs-keyword">return</span> normalized;
    },

    <span class="hljs-attr">calculatePayloadHash</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">payload, algorithm, contentType</span>) </span>{

        <span class="hljs-keyword">var</span> hash = CryptoJS.algo[algorithm.toUpperCase()].create();
        hash.update(<span class="hljs-string">'hawk.'</span> + hawk.crypto.headerVersion + <span class="hljs-string">'.payload\n'</span>);
        hash.update(hawk.utils.parseContentType(contentType) + <span class="hljs-string">'\n'</span>);
        hash.update(payload);
        hash.update(<span class="hljs-string">'\n'</span>);
        <span class="hljs-keyword">return</span> hash.finalize().toString(CryptoJS.enc.Base64);
    },

    <span class="hljs-attr">calculateTsMac</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">ts, credentials</span>) </span>{

        <span class="hljs-keyword">var</span> hash = CryptoJS[<span class="hljs-string">'Hmac'</span> + credentials.algorithm.toUpperCase()](<span class="hljs-string">'hawk.'</span> + hawk.crypto.headerVersion + <span class="hljs-string">'.ts\n'</span> + ts + <span class="hljs-string">'\n'</span>, credentials.key);
        <span class="hljs-keyword">return</span> hash.toString(CryptoJS.enc.Base64);
    }
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>localStorage compatible interface</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
hawk.internals.LocalStorage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">this</span>._cache = {};
    <span class="hljs-keyword">this</span>.length = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">this</span>.getItem = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._cache.hasOwnProperty(key) ? <span class="hljs-built_in">String</span>(<span class="hljs-keyword">this</span>._cache[key]) : <span class="hljs-literal">null</span>;
    };

    <span class="hljs-keyword">this</span>.setItem = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key, value</span>) </span>{

        <span class="hljs-keyword">this</span>._cache[key] = <span class="hljs-built_in">String</span>(value);
        <span class="hljs-keyword">this</span>.length = <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._cache).length;
    };

    <span class="hljs-keyword">this</span>.removeItem = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{

        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._cache[key];
        <span class="hljs-keyword">this</span>.length = <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._cache).length;
    };

    <span class="hljs-keyword">this</span>.clear = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">this</span>._cache = {};
        <span class="hljs-keyword">this</span>.length = <span class="hljs-number">0</span>;
    };

    <span class="hljs-keyword">this</span>.key = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">i</span>) </span>{

        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._cache)[i || <span class="hljs-number">0</span>];
    };
};


hawk.utils = {

    <span class="hljs-attr">storage</span>: <span class="hljs-keyword">new</span> hawk.internals.LocalStorage(),

    <span class="hljs-attr">setStorage</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">storage</span>) </span>{

        <span class="hljs-keyword">var</span> ntpOffset = hawk.utils.storage.getItem(<span class="hljs-string">'hawk_ntp_offset'</span>);
        hawk.utils.storage = storage;
        <span class="hljs-keyword">if</span> (ntpOffset) {
            hawk.utils.setNtpOffset(ntpOffset);
        }
    },

    <span class="hljs-attr">setNtpOffset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">offset</span>) </span>{

        <span class="hljs-keyword">try</span> {
            hawk.utils.storage.setItem(<span class="hljs-string">'hawk_ntp_offset'</span>, offset);
        }
        <span class="hljs-keyword">catch</span> (err) {
            <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'[hawk] could not write to storage.'</span>);
            <span class="hljs-built_in">console</span>.error(err);
        }
    },

    <span class="hljs-attr">getNtpOffset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">var</span> offset = hawk.utils.storage.getItem(<span class="hljs-string">'hawk_ntp_offset'</span>);
        <span class="hljs-keyword">if</span> (!offset) {
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }

        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(offset, <span class="hljs-number">10</span>);
    },

    <span class="hljs-attr">now</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">localtimeOffsetMsec</span>) </span>{

        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.floor(((<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getTime() + (localtimeOffsetMsec || <span class="hljs-number">0</span>)) / <span class="hljs-number">1000</span>) + hawk.utils.getNtpOffset();
    },

    <span class="hljs-attr">escapeHeaderAttribute</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">attribute</span>) </span>{

        <span class="hljs-keyword">return</span> attribute.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'\\\\'</span>).replace(<span class="hljs-regexp">/\"/g</span>, <span class="hljs-string">'\\"'</span>);
    },

    <span class="hljs-attr">parseContentType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">header</span>) </span>{

        <span class="hljs-keyword">if</span> (!header) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
        }

        <span class="hljs-keyword">return</span> header.split(<span class="hljs-string">';'</span>)[<span class="hljs-number">0</span>].replace(<span class="hljs-regexp">/^\s+|\s+$/g</span>, <span class="hljs-string">''</span>).toLowerCase();
    },

    <span class="hljs-attr">parseAuthorizationHeader</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">header, keys</span>) </span>{

        <span class="hljs-keyword">if</span> (!header) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">var</span> headerParts = header.match(<span class="hljs-regexp">/^(\w+)(?:\s+(.*))?$/</span>);       <span class="hljs-comment">// Header: scheme[ something]</span>
        <span class="hljs-keyword">if</span> (!headerParts) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">var</span> scheme = headerParts[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> (scheme.toLowerCase() !== <span class="hljs-string">'hawk'</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">var</span> attributesString = headerParts[<span class="hljs-number">2</span>];
        <span class="hljs-keyword">if</span> (!attributesString) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">var</span> attributes = {};
        <span class="hljs-keyword">var</span> verify = attributesString.replace(<span class="hljs-regexp">/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$<span class="hljs-number">0</span>, $<span class="hljs-number">1</span>, $<span class="hljs-number">2</span></span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>Check valid attribute names</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
            <span class="hljs-keyword">if</span> (keys.indexOf($<span class="hljs-number">1</span>) === <span class="hljs-number">-1</span>) {
                <span class="hljs-keyword">return</span>;
            }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>Allowed attribute value characters: !#$%&amp;'()*+,-./:;&lt;=&gt;?@[]^_`{|}~ and space, a-z, A-Z, 0-9</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
            <span class="hljs-keyword">if</span> ($<span class="hljs-number">2.</span>match(<span class="hljs-regexp">/^[ \w\!#\$%&amp;'\(\)\*\+,\-\.\/\:;&lt;\=&gt;\?@\[\]\^`\{\|\}~]+$/</span>) === <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span>;
            }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>Check for duplicates</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
            <span class="hljs-keyword">if</span> (attributes.hasOwnProperty($<span class="hljs-number">1</span>)) {
                <span class="hljs-keyword">return</span>;
            }

            attributes[$<span class="hljs-number">1</span>] = $<span class="hljs-number">2</span>;
            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
        });

        <span class="hljs-keyword">if</span> (verify !== <span class="hljs-string">''</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">return</span> attributes;
    },

    <span class="hljs-attr">randomString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">size</span>) </span>{

        <span class="hljs-keyword">var</span> randomSource = <span class="hljs-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span>;
        <span class="hljs-keyword">var</span> len = randomSource.length;

        <span class="hljs-keyword">var</span> result = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; size; ++i) {
            result[i] = randomSource[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * len)];
        }

        <span class="hljs-keyword">return</span> result.join(<span class="hljs-string">''</span>);
    },

    <span class="hljs-attr">uriRegex</span>: <span class="hljs-regexp">/^([^:]+)\:\/\/(?:[^@]*@)?([^\/:]+)(?:\:(\d+))?([^#]*)(?:#.*)?$/</span>,       <span class="hljs-comment">// scheme://credentials@host:port/resource#fragment</span>
    parseUri: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">input</span>) </span>{

        <span class="hljs-keyword">var</span> parts = input.match(hawk.utils.uriRegex);
        <span class="hljs-keyword">if</span> (!parts) {
            <span class="hljs-keyword">return</span> { <span class="hljs-attr">host</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">port</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">resource</span>: <span class="hljs-string">''</span> };
        }

        <span class="hljs-keyword">var</span> scheme = parts[<span class="hljs-number">1</span>].toLowerCase();
        <span class="hljs-keyword">var</span> uri = {
            <span class="hljs-attr">host</span>: parts[<span class="hljs-number">2</span>],
            <span class="hljs-attr">port</span>: parts[<span class="hljs-number">3</span>] || (scheme === <span class="hljs-string">'http'</span> ? <span class="hljs-string">'80'</span> : (scheme === <span class="hljs-string">'https'</span> ? <span class="hljs-string">'443'</span> : <span class="hljs-string">''</span>)),
            <span class="hljs-attr">resource</span>: parts[<span class="hljs-number">4</span>]
        };

        <span class="hljs-keyword">return</span> uri;
    },

    <span class="hljs-attr">base64urlEncode</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{

        <span class="hljs-keyword">var</span> wordArray = CryptoJS.enc.Utf8.parse(value);
        <span class="hljs-keyword">var</span> encoded = CryptoJS.enc.Base64.stringify(wordArray);
        <span class="hljs-keyword">return</span> encoded.replace(<span class="hljs-regexp">/\+/g</span>, <span class="hljs-string">'-'</span>).replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">'_'</span>).replace(<span class="hljs-regexp">/\=/g</span>, <span class="hljs-string">''</span>);
    }
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>$lab:coverage:off$</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-comment">/* eslint-disable */</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<p>Based on: Crypto-JS v3.1.2
Copyright (c) 2009-2013, Jeff Mott. All rights reserved.
http://code.google.com/p/crypto-js/
http://code.google.com/p/crypto-js/wiki/License</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> CryptoJS = CryptoJS || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">h, r</span>) </span>{ <span class="hljs-keyword">var</span> k = {}, l = k.lib = {}, n = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ }, f = l.Base = { <span class="hljs-attr">extend</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ n.prototype = <span class="hljs-keyword">this</span>; <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> n; a &amp;&amp; b.mixIn(a); b.hasOwnProperty(<span class="hljs-string">"init"</span>) || (b.init = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ b.$<span class="hljs-keyword">super</span>.init.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>) }); b.init.prototype = b; b.$<span class="hljs-keyword">super</span> = <span class="hljs-keyword">this</span>; <span class="hljs-keyword">return</span> b }, <span class="hljs-attr">create</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.extend(); a.init.apply(a, <span class="hljs-built_in">arguments</span>); <span class="hljs-keyword">return</span> a }, <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ }, <span class="hljs-attr">mixIn</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b <span class="hljs-keyword">in</span> a) a.hasOwnProperty(b) &amp;&amp; (<span class="hljs-keyword">this</span>[b] = a[b]); a.hasOwnProperty(<span class="hljs-string">"toString"</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.toString = a.toString) }, <span class="hljs-attr">clone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.init.prototype.extend(<span class="hljs-keyword">this</span>) } }, j = l.WordArray = f.extend({ <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{ a = <span class="hljs-keyword">this</span>.words = a || []; <span class="hljs-keyword">this</span>.sigBytes = b != r ? b : <span class="hljs-number">4</span> * a.length }, <span class="hljs-attr">toString</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span> (a || s).stringify(<span class="hljs-keyword">this</span>) }, <span class="hljs-attr">concat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">this</span>.words, d = a.words, c = <span class="hljs-keyword">this</span>.sigBytes; a = a.sigBytes; <span class="hljs-keyword">this</span>.clamp(); <span class="hljs-keyword">if</span> (c % <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> e = <span class="hljs-number">0</span>; e &lt; a; e++) b[c + e &gt;&gt;&gt; <span class="hljs-number">2</span>] |= (d[e &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (e % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * ((c + e) % <span class="hljs-number">4</span>); <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">65535</span> &lt; d.length) <span class="hljs-keyword">for</span> (e = <span class="hljs-number">0</span>; e &lt; a; e += <span class="hljs-number">4</span>) b[c + e &gt;&gt;&gt; <span class="hljs-number">2</span>] = d[e &gt;&gt;&gt; <span class="hljs-number">2</span>]; <span class="hljs-keyword">else</span> b.push.apply(b, d); <span class="hljs-keyword">this</span>.sigBytes += a; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> }, <span class="hljs-attr">clamp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>.words, b = <span class="hljs-keyword">this</span>.sigBytes; a[b &gt;&gt;&gt; <span class="hljs-number">2</span>] &amp;= <span class="hljs-number">4294967295</span> &lt;&lt; <span class="hljs-number">32</span> - <span class="hljs-number">8</span> * (b % <span class="hljs-number">4</span>); a.length = h.ceil(b / <span class="hljs-number">4</span>) }, <span class="hljs-attr">clone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> a = f.clone.call(<span class="hljs-keyword">this</span>); a.words = <span class="hljs-keyword">this</span>.words.slice(<span class="hljs-number">0</span>); <span class="hljs-keyword">return</span> a }, <span class="hljs-attr">random</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = [], d = <span class="hljs-number">0</span>; d &lt; a; d += <span class="hljs-number">4</span>) b.push(<span class="hljs-number">4294967296</span> * h.random() | <span class="hljs-number">0</span>); <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> j.init(b, a) } }), m = k.enc = {}, s = m.Hex = { <span class="hljs-attr">stringify</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> b = a.words; a = a.sigBytes; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d = [], c = <span class="hljs-number">0</span>; c &lt; a; c++) { <span class="hljs-keyword">var</span> e = b[c &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (c % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>; d.push((e &gt;&gt;&gt; <span class="hljs-number">4</span>).toString(<span class="hljs-number">16</span>)); d.push((e &amp; <span class="hljs-number">15</span>).toString(<span class="hljs-number">16</span>)) } <span class="hljs-keyword">return</span> d.join(<span class="hljs-string">""</span>) }, <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = a.length, d = [], c = <span class="hljs-number">0</span>; c &lt; b; c += <span class="hljs-number">2</span>) d[c &gt;&gt;&gt; <span class="hljs-number">3</span>] |= <span class="hljs-built_in">parseInt</span>(a.substr(c, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">4</span> * (c % <span class="hljs-number">8</span>); <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> j.init(d, b / <span class="hljs-number">2</span>) } }, p = m.Latin1 = { <span class="hljs-attr">stringify</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> b = a.words; a = a.sigBytes; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d = [], c = <span class="hljs-number">0</span>; c &lt; a; c++) d.push(<span class="hljs-built_in">String</span>.fromCharCode(b[c &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (c % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>)); <span class="hljs-keyword">return</span> d.join(<span class="hljs-string">""</span>) }, <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> b = a.length, d = [], c = <span class="hljs-number">0</span>; c &lt; b; c++) d[c &gt;&gt;&gt; <span class="hljs-number">2</span>] |= (a.charCodeAt(c) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (c % <span class="hljs-number">4</span>); <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> j.init(d, b) } }, t = m.Utf8 = { <span class="hljs-attr">stringify</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">try</span> { <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(<span class="hljs-built_in">escape</span>(p.stringify(a))) } <span class="hljs-keyword">catch</span> (b) { <span class="hljs-keyword">throw</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Malformed UTF-8 data"</span>); } }, <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span> p.parse(<span class="hljs-built_in">unescape</span>(<span class="hljs-built_in">encodeURIComponent</span>(a))) } }, q = l.BufferedBlockAlgorithm = f.extend({ <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">this</span>._data = <span class="hljs-keyword">new</span> j.init; <span class="hljs-keyword">this</span>._nDataBytes = <span class="hljs-number">0</span> }, <span class="hljs-attr">_append</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-string">"string"</span> == <span class="hljs-keyword">typeof</span> a &amp;&amp; (a = t.parse(a)); <span class="hljs-keyword">this</span>._data.concat(a); <span class="hljs-keyword">this</span>._nDataBytes += a.sigBytes }, <span class="hljs-attr">_process</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">this</span>._data, d = b.words, c = b.sigBytes, e = <span class="hljs-keyword">this</span>.blockSize, f = c / (<span class="hljs-number">4</span> * e), f = a ? h.ceil(f) : h.max((f | <span class="hljs-number">0</span>) - <span class="hljs-keyword">this</span>._minBufferSize, <span class="hljs-number">0</span>); a = f * e; c = h.min(<span class="hljs-number">4</span> * a, c); <span class="hljs-keyword">if</span> (a) { <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> g = <span class="hljs-number">0</span>; g &lt; a; g += e) <span class="hljs-keyword">this</span>._doProcessBlock(d, g); g = d.splice(<span class="hljs-number">0</span>, a); b.sigBytes -= c } <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> j.init(g, c) }, <span class="hljs-attr">clone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> a = f.clone.call(<span class="hljs-keyword">this</span>); a._data = <span class="hljs-keyword">this</span>._data.clone(); <span class="hljs-keyword">return</span> a }, <span class="hljs-attr">_minBufferSize</span>: <span class="hljs-number">0</span> }); l.Hasher = q.extend({ <span class="hljs-attr">cfg</span>: f.extend(), <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">this</span>.cfg = <span class="hljs-keyword">this</span>.cfg.extend(a); <span class="hljs-keyword">this</span>.reset() }, <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ q.reset.call(<span class="hljs-keyword">this</span>); <span class="hljs-keyword">this</span>._doReset() }, <span class="hljs-attr">update</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">this</span>._append(a); <span class="hljs-keyword">this</span>._process(); <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> }, <span class="hljs-attr">finalize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ a &amp;&amp; <span class="hljs-keyword">this</span>._append(a); <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._doFinalize() }, <span class="hljs-attr">blockSize</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">_createHelper</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">b, d</span>) </span>{ <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> a.init(d)).finalize(b) } }, <span class="hljs-attr">_createHmacHelper</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">b, d</span>) </span>{ <span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> u.HMAC.init(a, d)).finalize(b) } } }); <span class="hljs-keyword">var</span> u = k.algo = {}; <span class="hljs-keyword">return</span> k }(<span class="hljs-built_in">Math</span>);
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> k = CryptoJS, b = k.lib, m = b.WordArray, l = b.Hasher, d = [], b = k.algo.SHA1 = l.extend({ <span class="hljs-attr">_doReset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">this</span>._hash = <span class="hljs-keyword">new</span> m.init([<span class="hljs-number">1732584193</span>, <span class="hljs-number">4023233417</span>, <span class="hljs-number">2562383102</span>, <span class="hljs-number">271733878</span>, <span class="hljs-number">3285377520</span>]) }, <span class="hljs-attr">_doProcessBlock</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">n, p</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>._hash.words, e = a[<span class="hljs-number">0</span>], f = a[<span class="hljs-number">1</span>], h = a[<span class="hljs-number">2</span>], j = a[<span class="hljs-number">3</span>], b = a[<span class="hljs-number">4</span>], c = <span class="hljs-number">0</span>; <span class="hljs-number">80</span> &gt; c; c++) { <span class="hljs-keyword">if</span> (<span class="hljs-number">16</span> &gt; c) d[c] = n[p + c] | <span class="hljs-number">0</span>; <span class="hljs-keyword">else</span> { <span class="hljs-keyword">var</span> g = d[c - <span class="hljs-number">3</span>] ^ d[c - <span class="hljs-number">8</span>] ^ d[c - <span class="hljs-number">14</span>] ^ d[c - <span class="hljs-number">16</span>]; d[c] = g &lt;&lt; <span class="hljs-number">1</span> | g &gt;&gt;&gt; <span class="hljs-number">31</span> } g = (e &lt;&lt; <span class="hljs-number">5</span> | e &gt;&gt;&gt; <span class="hljs-number">27</span>) + b + d[c]; g = <span class="hljs-number">20</span> &gt; c ? g + ((f &amp; h | ~f &amp; j) + <span class="hljs-number">1518500249</span>) : <span class="hljs-number">40</span> &gt; c ? g + ((f ^ h ^ j) + <span class="hljs-number">1859775393</span>) : <span class="hljs-number">60</span> &gt; c ? g + ((f &amp; h | f &amp; j | h &amp; j) - <span class="hljs-number">1894007588</span>) : g + ((f ^ h ^ j) - <span class="hljs-number">899497514</span>); b = j; j = h; h = f &lt;&lt; <span class="hljs-number">30</span> | f &gt;&gt;&gt; <span class="hljs-number">2</span>; f = e; e = g } a[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] + e | <span class="hljs-number">0</span>; a[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] + f | <span class="hljs-number">0</span>; a[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] + h | <span class="hljs-number">0</span>; a[<span class="hljs-number">3</span>] = a[<span class="hljs-number">3</span>] + j | <span class="hljs-number">0</span>; a[<span class="hljs-number">4</span>] = a[<span class="hljs-number">4</span>] + b | <span class="hljs-number">0</span> }, <span class="hljs-attr">_doFinalize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">this</span>._data, d = b.words, a = <span class="hljs-number">8</span> * <span class="hljs-keyword">this</span>._nDataBytes, e = <span class="hljs-number">8</span> * b.sigBytes; d[e &gt;&gt;&gt; <span class="hljs-number">5</span>] |= <span class="hljs-number">128</span> &lt;&lt; <span class="hljs-number">24</span> - e % <span class="hljs-number">32</span>; d[(e + <span class="hljs-number">64</span> &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">14</span>] = <span class="hljs-built_in">Math</span>.floor(a / <span class="hljs-number">4294967296</span>); d[(e + <span class="hljs-number">64</span> &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">15</span>] = a; b.sigBytes = <span class="hljs-number">4</span> * d.length; <span class="hljs-keyword">this</span>._process(); <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._hash }, <span class="hljs-attr">clone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> b = l.clone.call(<span class="hljs-keyword">this</span>); b._hash = <span class="hljs-keyword">this</span>._hash.clone(); <span class="hljs-keyword">return</span> b } }); k.SHA1 = l._createHelper(b); k.HmacSHA1 = l._createHmacHelper(b) })();
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">k</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> g = CryptoJS, h = g.lib, v = h.WordArray, j = h.Hasher, h = g.algo, s = [], t = [], u = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">q</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-number">4294967296</span> * (q - (q | <span class="hljs-number">0</span>)) | <span class="hljs-number">0</span> }, l = <span class="hljs-number">2</span>, b = <span class="hljs-number">0</span>; <span class="hljs-number">64</span> &gt; b;) { <span class="hljs-keyword">var</span> d; a: { d = l; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> w = k.sqrt(d), r = <span class="hljs-number">2</span>; r &lt;= w; r++) <span class="hljs-keyword">if</span> (!(d % r)) { d = !<span class="hljs-number">1</span>; <span class="hljs-keyword">break</span> a } d = !<span class="hljs-number">0</span> } d &amp;&amp; (<span class="hljs-number">8</span> &gt; b &amp;&amp; (s[b] = u(k.pow(l, <span class="hljs-number">0.5</span>))), t[b] = u(k.pow(l, <span class="hljs-number">1</span> / <span class="hljs-number">3</span>)), b++); l++ } <span class="hljs-keyword">var</span> n = [], h = h.SHA256 = j.extend({ <span class="hljs-attr">_doReset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">this</span>._hash = <span class="hljs-keyword">new</span> v.init(s.slice(<span class="hljs-number">0</span>)) }, <span class="hljs-attr">_doProcessBlock</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">q, h</span>) </span>{ <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>._hash.words, c = a[<span class="hljs-number">0</span>], d = a[<span class="hljs-number">1</span>], b = a[<span class="hljs-number">2</span>], k = a[<span class="hljs-number">3</span>], f = a[<span class="hljs-number">4</span>], g = a[<span class="hljs-number">5</span>], j = a[<span class="hljs-number">6</span>], l = a[<span class="hljs-number">7</span>], e = <span class="hljs-number">0</span>; <span class="hljs-number">64</span> &gt; e; e++) { <span class="hljs-keyword">if</span> (<span class="hljs-number">16</span> &gt; e) n[e] = q[h + e] | <span class="hljs-number">0</span>; <span class="hljs-keyword">else</span> { <span class="hljs-keyword">var</span> m = n[e - <span class="hljs-number">15</span>], p = n[e - <span class="hljs-number">2</span>]; n[e] = ((m &lt;&lt; <span class="hljs-number">25</span> | m &gt;&gt;&gt; <span class="hljs-number">7</span>) ^ (m &lt;&lt; <span class="hljs-number">14</span> | m &gt;&gt;&gt; <span class="hljs-number">18</span>) ^ m &gt;&gt;&gt; <span class="hljs-number">3</span>) + n[e - <span class="hljs-number">7</span>] + ((p &lt;&lt; <span class="hljs-number">15</span> | p &gt;&gt;&gt; <span class="hljs-number">17</span>) ^ (p &lt;&lt; <span class="hljs-number">13</span> | p &gt;&gt;&gt; <span class="hljs-number">19</span>) ^ p &gt;&gt;&gt; <span class="hljs-number">10</span>) + n[e - <span class="hljs-number">16</span>] } m = l + ((f &lt;&lt; <span class="hljs-number">26</span> | f &gt;&gt;&gt; <span class="hljs-number">6</span>) ^ (f &lt;&lt; <span class="hljs-number">21</span> | f &gt;&gt;&gt; <span class="hljs-number">11</span>) ^ (f &lt;&lt; <span class="hljs-number">7</span> | f &gt;&gt;&gt; <span class="hljs-number">25</span>)) + (f &amp; g ^ ~f &amp; j) + t[e] + n[e]; p = ((c &lt;&lt; <span class="hljs-number">30</span> | c &gt;&gt;&gt; <span class="hljs-number">2</span>) ^ (c &lt;&lt; <span class="hljs-number">19</span> | c &gt;&gt;&gt; <span class="hljs-number">13</span>) ^ (c &lt;&lt; <span class="hljs-number">10</span> | c &gt;&gt;&gt; <span class="hljs-number">22</span>)) + (c &amp; d ^ c &amp; b ^ d &amp; b); l = j; j = g; g = f; f = k + m | <span class="hljs-number">0</span>; k = b; b = d; d = c; c = m + p | <span class="hljs-number">0</span> } a[<span class="hljs-number">0</span>] = a[<span class="hljs-number">0</span>] + c | <span class="hljs-number">0</span>; a[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] + d | <span class="hljs-number">0</span>; a[<span class="hljs-number">2</span>] = a[<span class="hljs-number">2</span>] + b | <span class="hljs-number">0</span>; a[<span class="hljs-number">3</span>] = a[<span class="hljs-number">3</span>] + k | <span class="hljs-number">0</span>; a[<span class="hljs-number">4</span>] = a[<span class="hljs-number">4</span>] + f | <span class="hljs-number">0</span>; a[<span class="hljs-number">5</span>] = a[<span class="hljs-number">5</span>] + g | <span class="hljs-number">0</span>; a[<span class="hljs-number">6</span>] = a[<span class="hljs-number">6</span>] + j | <span class="hljs-number">0</span>; a[<span class="hljs-number">7</span>] = a[<span class="hljs-number">7</span>] + l | <span class="hljs-number">0</span> }, <span class="hljs-attr">_doFinalize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>._data, b = d.words, a = <span class="hljs-number">8</span> * <span class="hljs-keyword">this</span>._nDataBytes, c = <span class="hljs-number">8</span> * d.sigBytes; b[c &gt;&gt;&gt; <span class="hljs-number">5</span>] |= <span class="hljs-number">128</span> &lt;&lt; <span class="hljs-number">24</span> - c % <span class="hljs-number">32</span>; b[(c + <span class="hljs-number">64</span> &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">14</span>] = k.floor(a / <span class="hljs-number">4294967296</span>); b[(c + <span class="hljs-number">64</span> &gt;&gt;&gt; <span class="hljs-number">9</span> &lt;&lt; <span class="hljs-number">4</span>) + <span class="hljs-number">15</span>] = a; d.sigBytes = <span class="hljs-number">4</span> * b.length; <span class="hljs-keyword">this</span>._process(); <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._hash }, <span class="hljs-attr">clone</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> b = j.clone.call(<span class="hljs-keyword">this</span>); b._hash = <span class="hljs-keyword">this</span>._hash.clone(); <span class="hljs-keyword">return</span> b } }); g.SHA256 = j._createHelper(h); g.HmacSHA256 = j._createHmacHelper(h) })(<span class="hljs-built_in">Math</span>);
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> c = CryptoJS, k = c.enc.Utf8; c.algo.HMAC = c.lib.Base.extend({ <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{ a = <span class="hljs-keyword">this</span>._hasher = <span class="hljs-keyword">new</span> a.init; <span class="hljs-string">"string"</span> == <span class="hljs-keyword">typeof</span> b &amp;&amp; (b = k.parse(b)); <span class="hljs-keyword">var</span> c = a.blockSize, e = <span class="hljs-number">4</span> * c; b.sigBytes &gt; e &amp;&amp; (b = a.finalize(b)); b.clamp(); <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> f = <span class="hljs-keyword">this</span>._oKey = b.clone(), g = <span class="hljs-keyword">this</span>._iKey = b.clone(), h = f.words, j = g.words, d = <span class="hljs-number">0</span>; d &lt; c; d++) h[d] ^= <span class="hljs-number">1549556828</span>, j[d] ^= <span class="hljs-number">909522486</span>; f.sigBytes = g.sigBytes = e; <span class="hljs-keyword">this</span>.reset() }, <span class="hljs-attr">reset</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">this</span>._hasher; a.reset(); a.update(<span class="hljs-keyword">this</span>._iKey) }, <span class="hljs-attr">update</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">this</span>._hasher.update(a); <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> }, <span class="hljs-attr">finalize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">this</span>._hasher; a = b.finalize(a); b.reset(); <span class="hljs-keyword">return</span> b.finalize(<span class="hljs-keyword">this</span>._oKey.clone().concat(a)) } }) })();
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> h = CryptoJS, j = h.lib.WordArray; h.enc.Base64 = { <span class="hljs-attr">stringify</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">b</span>) </span>{ <span class="hljs-keyword">var</span> e = b.words, f = b.sigBytes, c = <span class="hljs-keyword">this</span>._map; b.clamp(); b = []; <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>; a &lt; f; a += <span class="hljs-number">3</span>) <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> d = (e[a &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (a % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">16</span> | (e[a + <span class="hljs-number">1</span> &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * ((a + <span class="hljs-number">1</span>) % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>) &lt;&lt; <span class="hljs-number">8</span> | e[a + <span class="hljs-number">2</span> &gt;&gt;&gt; <span class="hljs-number">2</span>] &gt;&gt;&gt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * ((a + <span class="hljs-number">2</span>) % <span class="hljs-number">4</span>) &amp; <span class="hljs-number">255</span>, g = <span class="hljs-number">0</span>; <span class="hljs-number">4</span> &gt; g &amp;&amp; a + <span class="hljs-number">0.75</span> * g &lt; f; g++) b.push(c.charAt(d &gt;&gt;&gt; <span class="hljs-number">6</span> * (<span class="hljs-number">3</span> - g) &amp; <span class="hljs-number">63</span>)); <span class="hljs-keyword">if</span> (e = c.charAt(<span class="hljs-number">64</span>)) <span class="hljs-keyword">for</span> (; b.length % <span class="hljs-number">4</span>;) b.push(e); <span class="hljs-keyword">return</span> b.join(<span class="hljs-string">""</span>) }, <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">b</span>) </span>{ <span class="hljs-keyword">var</span> e = b.length, f = <span class="hljs-keyword">this</span>._map, c = f.charAt(<span class="hljs-number">64</span>); c &amp;&amp; (c = b.indexOf(c), <span class="hljs-number">-1</span> != c &amp;&amp; (e = c)); <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> c = [], a = <span class="hljs-number">0</span>, d = <span class="hljs-number">0</span>; d &lt; e; d++) <span class="hljs-keyword">if</span> (d % <span class="hljs-number">4</span>) { <span class="hljs-keyword">var</span> g = f.indexOf(b.charAt(d - <span class="hljs-number">1</span>)) &lt;&lt; <span class="hljs-number">2</span> * (d % <span class="hljs-number">4</span>), h = f.indexOf(b.charAt(d)) &gt;&gt;&gt; <span class="hljs-number">6</span> - <span class="hljs-number">2</span> * (d % <span class="hljs-number">4</span>); c[a &gt;&gt;&gt; <span class="hljs-number">2</span>] |= (g | h) &lt;&lt; <span class="hljs-number">24</span> - <span class="hljs-number">8</span> * (a % <span class="hljs-number">4</span>); a++ } <span class="hljs-keyword">return</span> j.create(c, a) }, <span class="hljs-attr">_map</span>: <span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span> } })();

hawk.crypto.internals = CryptoJS;


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>Export if used as a module</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> !== <span class="hljs-string">'undefined'</span> &amp;&amp; <span class="hljs-built_in">module</span>.exports) {
    <span class="hljs-built_in">module</span>.exports = hawk;
}

<span class="hljs-comment">/* eslint-enable */</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<p>$lab:coverage:on$</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
