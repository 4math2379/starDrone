<!DOCTYPE html>
<html>
<head>
  <title>compare_v1.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/node-uuid/test/compare_v1.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>compare_v1.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">'assert'</span>),
    nodeuuid = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../uuid'</span>),
    uuidjs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uuid-js'</span>),
    libuuid = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uuid'</span>).generate,
    util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>),
    exec = <span class="hljs-built_in">require</span>(<span class="hljs-string">'child_process'</span>).exec,
    os = <span class="hljs-built_in">require</span>(<span class="hljs-string">'os'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>On Mac Os X / macports there's only the ossp-uuid package that provides uuid
On Linux there's uuid-runtime which provides uuidgen</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> uuidCmd = os.type() === <span class="hljs-string">'Darwin'</span> ? <span class="hljs-string">'uuid -1'</span> : <span class="hljs-string">'uuidgen -t'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compare</span>(<span class="hljs-params">ids</span>) </span>{
  <span class="hljs-built_in">console</span>.log(ids);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; ids.length; i++) {
    <span class="hljs-keyword">var</span> id = ids[i].split(<span class="hljs-string">'-'</span>);
    id = [id[<span class="hljs-number">2</span>], id[<span class="hljs-number">1</span>], id[<span class="hljs-number">0</span>]].join(<span class="hljs-string">''</span>);
    ids[i] = id;
  }
  <span class="hljs-keyword">var</span> sorted = ([].concat(ids)).sort();

  <span class="hljs-keyword">if</span> (sorted.toString() !== ids.toString()) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Warning: sorted !== ids'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'everything in order!'</span>);
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Test time order of v1 uuids</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> ids = [];
<span class="hljs-keyword">while</span> (ids.length &lt; <span class="hljs-number">10e3</span>) ids.push(nodeuuid.v1());

<span class="hljs-keyword">var</span> max = <span class="hljs-number">10</span>;
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'node-uuid:'</span>);
ids = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; max; i++) ids.push(nodeuuid.v1());
compare(ids);

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">''</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'uuidjs:'</span>);
ids = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; max; i++) ids.push(uuidjs.create(<span class="hljs-number">1</span>).toString());
compare(ids);

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">''</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'libuuid:'</span>);
ids = [];
<span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> last = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  compare(ids);
}
<span class="hljs-keyword">var</span> cb = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, stdout, stderr</span>) </span>{
  ids.push(stdout.substring(<span class="hljs-number">0</span>, stdout.length<span class="hljs-number">-1</span>));
  count++;
  <span class="hljs-keyword">if</span> (count &lt; max) {
    <span class="hljs-keyword">return</span> next();
  }
  last();
};
<span class="hljs-keyword">var</span> next = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  exec(uuidCmd, cb);
};
next();

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
