<!DOCTYPE html>
<html>
<head>
  <title>source-map-generator.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/source-map/lib/source-map-generator.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>source-map-generator.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-comment">/* -*- Mode: js; js-indent-level: 2; -*- */</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Copyright 2011 Mozilla Foundation and contributors
Licensed under the New BSD license. See LICENSE or:
http://opensource.org/licenses/BSD-3-Clause</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">{
  <span class="hljs-keyword">var</span> base64VLQ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./base64-vlq'</span>);
  <span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./util'</span>);
  <span class="hljs-keyword">var</span> ArraySet = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./array-set'</span>).ArraySet;
  <span class="hljs-keyword">var</span> MappingList = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./mapping-list'</span>).MappingList;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>An instance of the SourceMapGenerator represents a source map which is
being built incrementally. You may pass an object with the following
properties:</p>
</div>
<div class="body">
<ul>
<li>file: The filename of the generated source.
<ul>
<li>sourceRoot: A root for all relative URLs in this source map.</li>
</ul>
</li>
</ul>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator</span>(<span class="hljs-params">aArgs</span>) </span>{
    <span class="hljs-keyword">if</span> (!aArgs) {
      aArgs = {};
    }
    <span class="hljs-keyword">this</span>._file = util.getArg(aArgs, <span class="hljs-string">'file'</span>, <span class="hljs-literal">null</span>);
    <span class="hljs-keyword">this</span>._sourceRoot = util.getArg(aArgs, <span class="hljs-string">'sourceRoot'</span>, <span class="hljs-literal">null</span>);
    <span class="hljs-keyword">this</span>._skipValidation = util.getArg(aArgs, <span class="hljs-string">'skipValidation'</span>, <span class="hljs-literal">false</span>);
    <span class="hljs-keyword">this</span>._sources = <span class="hljs-keyword">new</span> ArraySet();
    <span class="hljs-keyword">this</span>._names = <span class="hljs-keyword">new</span> ArraySet();
    <span class="hljs-keyword">this</span>._mappings = <span class="hljs-keyword">new</span> MappingList();
    <span class="hljs-keyword">this</span>._sourcesContents = <span class="hljs-literal">null</span>;
  }

  SourceMapGenerator.prototype._version = <span class="hljs-number">3</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates a new SourceMapGenerator based on a SourceMapConsumer</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">aSourceMapConsumer</span>
<span>The SourceMap.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.fromSourceMap =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_fromSourceMap</span>(<span class="hljs-params">aSourceMapConsumer</span>) </span>{
      <span class="hljs-keyword">var</span> sourceRoot = aSourceMapConsumer.sourceRoot;
      <span class="hljs-keyword">var</span> generator = <span class="hljs-keyword">new</span> SourceMapGenerator({
        <span class="hljs-attr">file</span>: aSourceMapConsumer.file,
        <span class="hljs-attr">sourceRoot</span>: sourceRoot
      });
      aSourceMapConsumer.eachMapping(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mapping</span>) </span>{
        <span class="hljs-keyword">var</span> newMapping = {
          <span class="hljs-attr">generated</span>: {
            <span class="hljs-attr">line</span>: mapping.generatedLine,
            <span class="hljs-attr">column</span>: mapping.generatedColumn
          }
        };

        <span class="hljs-keyword">if</span> (mapping.source != <span class="hljs-literal">null</span>) {
          newMapping.source = mapping.source;
          <span class="hljs-keyword">if</span> (sourceRoot != <span class="hljs-literal">null</span>) {
            newMapping.source = util.relative(sourceRoot, newMapping.source);
          }

          newMapping.original = {
            <span class="hljs-attr">line</span>: mapping.originalLine,
            <span class="hljs-attr">column</span>: mapping.originalColumn
          };

          <span class="hljs-keyword">if</span> (mapping.name != <span class="hljs-literal">null</span>) {
            newMapping.name = mapping.name;
          }
        }

        generator.addMapping(newMapping);
      });
      aSourceMapConsumer.sources.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sourceFile</span>) </span>{
        <span class="hljs-keyword">var</span> content = aSourceMapConsumer.sourceContentFor(sourceFile);
        <span class="hljs-keyword">if</span> (content != <span class="hljs-literal">null</span>) {
          generator.setSourceContent(sourceFile, content);
        }
      });
      <span class="hljs-keyword">return</span> generator;
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add a single mapping from original source line and column to the generated
source's line and column for this source map being created. The mapping
object should have the following properties:</p>
</div>
<div class="body">
<ul>
<li>generated: An object with the generated line and column positions.
<ul>
<li>original: An object with the original line and column positions.</li>
<li>source: The original source file (relative to the sourceRoot).</li>
<li>name: An optional original token name for this mapping.</li>
</ul>
</li>
</ul>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.prototype.addMapping =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_addMapping</span>(<span class="hljs-params">aArgs</span>) </span>{
      <span class="hljs-keyword">var</span> generated = util.getArg(aArgs, <span class="hljs-string">'generated'</span>);
      <span class="hljs-keyword">var</span> original = util.getArg(aArgs, <span class="hljs-string">'original'</span>, <span class="hljs-literal">null</span>);
      <span class="hljs-keyword">var</span> source = util.getArg(aArgs, <span class="hljs-string">'source'</span>, <span class="hljs-literal">null</span>);
      <span class="hljs-keyword">var</span> name = util.getArg(aArgs, <span class="hljs-string">'name'</span>, <span class="hljs-literal">null</span>);

      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._skipValidation) {
        <span class="hljs-keyword">this</span>._validateMapping(generated, original, source, name);
      }

      <span class="hljs-keyword">if</span> (source != <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-keyword">this</span>._sources.has(source)) {
        <span class="hljs-keyword">this</span>._sources.add(source);
      }

      <span class="hljs-keyword">if</span> (name != <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-keyword">this</span>._names.has(name)) {
        <span class="hljs-keyword">this</span>._names.add(name);
      }

      <span class="hljs-keyword">this</span>._mappings.add({
        <span class="hljs-attr">generatedLine</span>: generated.line,
        <span class="hljs-attr">generatedColumn</span>: generated.column,
        <span class="hljs-attr">originalLine</span>: original != <span class="hljs-literal">null</span> &amp;&amp; original.line,
        <span class="hljs-attr">originalColumn</span>: original != <span class="hljs-literal">null</span> &amp;&amp; original.column,
        <span class="hljs-attr">source</span>: source,
        <span class="hljs-attr">name</span>: name
      });
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<div class="dox">
<div class="summary">
<p>Set the source content for a source file.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.prototype.setSourceContent =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_setSourceContent</span>(<span class="hljs-params">aSourceFile, aSourceContent</span>) </span>{
      <span class="hljs-keyword">var</span> source = aSourceFile;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._sourceRoot != <span class="hljs-literal">null</span>) {
        source = util.relative(<span class="hljs-keyword">this</span>._sourceRoot, source);
      }

      <span class="hljs-keyword">if</span> (aSourceContent != <span class="hljs-literal">null</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Add the source content to the _sourcesContents map.
Create a new _sourcesContents map if the property is null.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._sourcesContents) {
          <span class="hljs-keyword">this</span>._sourcesContents = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
        }
        <span class="hljs-keyword">this</span>._sourcesContents[util.toSetString(source)] = aSourceContent;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._sourcesContents) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Remove the source file from the _sourcesContents map.
If the _sourcesContents map is empty, set the property to null.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._sourcesContents[util.toSetString(source)];
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>._sourcesContents).length === <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">this</span>._sourcesContents = <span class="hljs-literal">null</span>;
        }
      }
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<div class="dox">
<div class="summary">
<p>Applies the mappings of a sub-source-map for a specific source file to the
source map being generated. Each mapping to the supplied source file is
rewritten using the supplied source map. Note: The resolution for the
resulting mappings is the minimium of this map and the supplied map.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">aSourceMapConsumer</span>
<span>The source map to be applied.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">aSourceFile</span>
<span>Optional. The filename of the source file.        If omitted, SourceMapConsumer's file property will be used.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">aSourceMapPath</span>
<span>Optional. The dirname of the path to the source map        to be applied. If relative, it is relative to the SourceMapConsumer.
This parameter is needed when the two source maps aren't in the same
directory, and the source map to be applied contains relative source
paths. If so, those relative source paths need to be rewritten
relative to the SourceMapGenerator.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.prototype.applySourceMap =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_applySourceMap</span>(<span class="hljs-params">aSourceMapConsumer, aSourceFile, aSourceMapPath</span>) </span>{
      <span class="hljs-keyword">var</span> sourceFile = aSourceFile;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>If aSourceFile is omitted, we will use the file property of the SourceMap</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (aSourceFile == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (aSourceMapConsumer.file == <span class="hljs-literal">null</span>) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
            <span class="hljs-string">'SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, '</span> +
            <span class="hljs-string">'or the source map\'s "file" property. Both were omitted.'</span>
          );
        }
        sourceFile = aSourceMapConsumer.file;
      }
      <span class="hljs-keyword">var</span> sourceRoot = <span class="hljs-keyword">this</span>._sourceRoot;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Make &quot;sourceFile&quot; relative if an absolute Url is passed.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">if</span> (sourceRoot != <span class="hljs-literal">null</span>) {
        sourceFile = util.relative(sourceRoot, sourceFile);
      }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Applying the SourceMap can add and remove items from the sources and
the names array.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">var</span> newSources = <span class="hljs-keyword">new</span> ArraySet();
      <span class="hljs-keyword">var</span> newNames = <span class="hljs-keyword">new</span> ArraySet();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>Find mappings for the &quot;sourceFile&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">this</span>._mappings.unsortedForEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mapping</span>) </span>{
        <span class="hljs-keyword">if</span> (mapping.source === sourceFile &amp;&amp; mapping.originalLine != <span class="hljs-literal">null</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>Check if it can be mapped by the source map, then update the mapping.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          <span class="hljs-keyword">var</span> original = aSourceMapConsumer.originalPositionFor({
            <span class="hljs-attr">line</span>: mapping.originalLine,
            <span class="hljs-attr">column</span>: mapping.originalColumn
          });
          <span class="hljs-keyword">if</span> (original.source != <span class="hljs-literal">null</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Copy mapping</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            mapping.source = original.source;
            <span class="hljs-keyword">if</span> (aSourceMapPath != <span class="hljs-literal">null</span>) {
              mapping.source = util.join(aSourceMapPath, mapping.source)
            }
            <span class="hljs-keyword">if</span> (sourceRoot != <span class="hljs-literal">null</span>) {
              mapping.source = util.relative(sourceRoot, mapping.source);
            }
            mapping.originalLine = original.line;
            mapping.originalColumn = original.column;
            <span class="hljs-keyword">if</span> (original.name != <span class="hljs-literal">null</span>) {
              mapping.name = original.name;
            }
          }
        }

        <span class="hljs-keyword">var</span> source = mapping.source;
        <span class="hljs-keyword">if</span> (source != <span class="hljs-literal">null</span> &amp;&amp; !newSources.has(source)) {
          newSources.add(source);
        }

        <span class="hljs-keyword">var</span> name = mapping.name;
        <span class="hljs-keyword">if</span> (name != <span class="hljs-literal">null</span> &amp;&amp; !newNames.has(name)) {
          newNames.add(name);
        }

      }, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">this</span>._sources = newSources;
      <span class="hljs-keyword">this</span>._names = newNames;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>Copy sourcesContents of applied map.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      aSourceMapConsumer.sources.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sourceFile</span>) </span>{
        <span class="hljs-keyword">var</span> content = aSourceMapConsumer.sourceContentFor(sourceFile);
        <span class="hljs-keyword">if</span> (content != <span class="hljs-literal">null</span>) {
          <span class="hljs-keyword">if</span> (aSourceMapPath != <span class="hljs-literal">null</span>) {
            sourceFile = util.join(aSourceMapPath, sourceFile);
          }
          <span class="hljs-keyword">if</span> (sourceRoot != <span class="hljs-literal">null</span>) {
            sourceFile = util.relative(sourceRoot, sourceFile);
          }
          <span class="hljs-keyword">this</span>.setSourceContent(sourceFile, content);
        }
      }, <span class="hljs-keyword">this</span>);
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<div class="dox">
<div class="summary">
<p>A mapping can have one of the three levels of data:</p>
</div>
<div class="body">
<ol>
<li>Just the generated position.</li>
<li>The Generated position, original position, and original source.</li>
<li>Generated and original position, original source, as well as a name
token.</li>
</ol>
<p>To maintain consistency, we validate that any new mapping being added falls
in to one of these categories.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.prototype._validateMapping =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_validateMapping</span>(<span class="hljs-params">aGenerated, aOriginal, aSource,
                                                aName</span>) </span>{
      <span class="hljs-keyword">if</span> (aGenerated &amp;&amp; <span class="hljs-string">'line'</span> <span class="hljs-keyword">in</span> aGenerated &amp;&amp; <span class="hljs-string">'column'</span> <span class="hljs-keyword">in</span> aGenerated
          &amp;&amp; aGenerated.line &gt; <span class="hljs-number">0</span> &amp;&amp; aGenerated.column &gt;= <span class="hljs-number">0</span>
          &amp;&amp; !aOriginal &amp;&amp; !aSource &amp;&amp; !aName) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Case 1.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (aGenerated &amp;&amp; <span class="hljs-string">'line'</span> <span class="hljs-keyword">in</span> aGenerated &amp;&amp; <span class="hljs-string">'column'</span> <span class="hljs-keyword">in</span> aGenerated
               &amp;&amp; aOriginal &amp;&amp; <span class="hljs-string">'line'</span> <span class="hljs-keyword">in</span> aOriginal &amp;&amp; <span class="hljs-string">'column'</span> <span class="hljs-keyword">in</span> aOriginal
               &amp;&amp; aGenerated.line &gt; <span class="hljs-number">0</span> &amp;&amp; aGenerated.column &gt;= <span class="hljs-number">0</span>
               &amp;&amp; aOriginal.line &gt; <span class="hljs-number">0</span> &amp;&amp; aOriginal.column &gt;= <span class="hljs-number">0</span>
               &amp;&amp; aSource) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>Cases 2 and 3.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid mapping: '</span> + <span class="hljs-built_in">JSON</span>.stringify({
          <span class="hljs-attr">generated</span>: aGenerated,
          <span class="hljs-attr">source</span>: aSource,
          <span class="hljs-attr">original</span>: aOriginal,
          <span class="hljs-attr">name</span>: aName
        }));
      }
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<div class="dox">
<div class="summary">
<p>Serialize the accumulated mappings in to the stream of base 64 VLQs
specified by the source map format.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.prototype._serializeMappings =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_serializeMappings</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> previousGeneratedColumn = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> previousGeneratedLine = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">var</span> previousOriginalColumn = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> previousOriginalLine = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> previousName = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> previousSource = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> result = <span class="hljs-string">''</span>;
      <span class="hljs-keyword">var</span> next;
      <span class="hljs-keyword">var</span> mapping;
      <span class="hljs-keyword">var</span> nameIdx;
      <span class="hljs-keyword">var</span> sourceIdx;

      <span class="hljs-keyword">var</span> mappings = <span class="hljs-keyword">this</span>._mappings.toArray();
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = mappings.length; i &lt; len; i++) {
        mapping = mappings[i];
        next = <span class="hljs-string">''</span>

        <span class="hljs-keyword">if</span> (mapping.generatedLine !== previousGeneratedLine) {
          previousGeneratedColumn = <span class="hljs-number">0</span>;
          <span class="hljs-keyword">while</span> (mapping.generatedLine !== previousGeneratedLine) {
            next += <span class="hljs-string">';'</span>;
            previousGeneratedLine++;
          }
        }
        <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">if</span> (!util.compareByGeneratedPositionsInflated(mapping, mappings[i - <span class="hljs-number">1</span>])) {
              <span class="hljs-keyword">continue</span>;
            }
            next += <span class="hljs-string">','</span>;
          }
        }

        next += base64VLQ.encode(mapping.generatedColumn
                                   - previousGeneratedColumn);
        previousGeneratedColumn = mapping.generatedColumn;

        <span class="hljs-keyword">if</span> (mapping.source != <span class="hljs-literal">null</span>) {
          sourceIdx = <span class="hljs-keyword">this</span>._sources.indexOf(mapping.source);
          next += base64VLQ.encode(sourceIdx - previousSource);
          previousSource = sourceIdx;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>lines are stored 0-based in SourceMap spec version 3</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">          next += base64VLQ.encode(mapping.originalLine - <span class="hljs-number">1</span>
                                     - previousOriginalLine);
          previousOriginalLine = mapping.originalLine - <span class="hljs-number">1</span>;

          next += base64VLQ.encode(mapping.originalColumn
                                     - previousOriginalColumn);
          previousOriginalColumn = mapping.originalColumn;

          <span class="hljs-keyword">if</span> (mapping.name != <span class="hljs-literal">null</span>) {
            nameIdx = <span class="hljs-keyword">this</span>._names.indexOf(mapping.name);
            next += base64VLQ.encode(nameIdx - previousName);
            previousName = nameIdx;
          }
        }

        result += next;
      }

      <span class="hljs-keyword">return</span> result;
    };

  SourceMapGenerator.prototype._generateSourcesContent =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_generateSourcesContent</span>(<span class="hljs-params">aSources, aSourceRoot</span>) </span>{
      <span class="hljs-keyword">return</span> aSources.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source</span>) </span>{
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._sourcesContents) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        <span class="hljs-keyword">if</span> (aSourceRoot != <span class="hljs-literal">null</span>) {
          source = util.relative(aSourceRoot, source);
        }
        <span class="hljs-keyword">var</span> key = util.toSetString(source);
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(<span class="hljs-keyword">this</span>._sourcesContents, key)
          ? <span class="hljs-keyword">this</span>._sourcesContents[key]
          : <span class="hljs-literal">null</span>;
      }, <span class="hljs-keyword">this</span>);
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<div class="dox">
<div class="summary">
<p>Externalize the source map.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.prototype.toJSON =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_toJSON</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> map = {
        <span class="hljs-attr">version</span>: <span class="hljs-keyword">this</span>._version,
        <span class="hljs-attr">sources</span>: <span class="hljs-keyword">this</span>._sources.toArray(),
        <span class="hljs-attr">names</span>: <span class="hljs-keyword">this</span>._names.toArray(),
        <span class="hljs-attr">mappings</span>: <span class="hljs-keyword">this</span>._serializeMappings()
      };
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._file != <span class="hljs-literal">null</span>) {
        map.file = <span class="hljs-keyword">this</span>._file;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._sourceRoot != <span class="hljs-literal">null</span>) {
        map.sourceRoot = <span class="hljs-keyword">this</span>._sourceRoot;
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._sourcesContents) {
        map.sourcesContent = <span class="hljs-keyword">this</span>._generateSourcesContent(map.sources, map.sourceRoot);
      }

      <span class="hljs-keyword">return</span> map;
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<div class="dox">
<div class="summary">
<p>Render the source map being generated to a string.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  SourceMapGenerator.prototype.toString =
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SourceMapGenerator_toString</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-keyword">this</span>.toJSON());
    };

  exports.SourceMapGenerator = SourceMapGenerator;
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
