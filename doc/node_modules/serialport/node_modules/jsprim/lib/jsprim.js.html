<!DOCTYPE html>
<html>
<head>
  <title>jsprim.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/jsprim/lib/jsprim.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>jsprim.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>lib/jsprim.js: utilities for primitive JavaScript types</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> mod_assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">'assert'</span>);
<span class="hljs-keyword">var</span> mod_util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>);

<span class="hljs-keyword">var</span> mod_extsprintf = <span class="hljs-built_in">require</span>(<span class="hljs-string">'extsprintf'</span>);
<span class="hljs-keyword">var</span> mod_verror = <span class="hljs-built_in">require</span>(<span class="hljs-string">'verror'</span>);
<span class="hljs-keyword">var</span> mod_jsonschema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'json-schema'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Public interface</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">exports.deepCopy = deepCopy;
exports.deepEqual = deepEqual;
exports.isEmpty = isEmpty;
exports.forEachKey = forEachKey;
exports.pluck = pluck;
exports.flattenObject = flattenObject;
exports.flattenIter = flattenIter;
exports.validateJsonObject = validateJsonObjectJS;
exports.validateJsonObjectJS = validateJsonObjectJS;
exports.randElt = randElt;
exports.extraProperties = extraProperties;
exports.mergeObjects = mergeObjects;

exports.startsWith = startsWith;
exports.endsWith = endsWith;

exports.iso8601 = iso8601;
exports.rfc1123 = rfc1123;
exports.parseDateTime = parseDateTime;

exports.hrtimediff = hrtimeDiff;
exports.hrtimeDiff = hrtimeDiff;
exports.hrtimeAccum = hrtimeAccum;
exports.hrtimeAdd = hrtimeAdd;
exports.hrtimeNanosec = hrtimeNanosec;
exports.hrtimeMicrosec = hrtimeMicrosec;
exports.hrtimeMillisec = hrtimeMillisec;


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>Deep copy an acyclic <em>basic</em> Javascript object.  This only handles basic
scalars (strings, numbers, booleans) and arbitrarily deep arrays and objects
containing these.  This does <em>not</em> handle instances of other classes.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepCopy</span>(<span class="hljs-params">obj</span>)
</span>{
	<span class="hljs-keyword">var</span> ret, key;
	<span class="hljs-keyword">var</span> marker = <span class="hljs-string">'__deepCopy'</span>;

	<span class="hljs-keyword">if</span> (obj &amp;&amp; obj[marker])
		<span class="hljs-keyword">throw</span> (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'attempted deep copy of cyclic object'</span>));

	<span class="hljs-keyword">if</span> (obj &amp;&amp; obj.constructor == <span class="hljs-built_in">Object</span>) {
		ret = {};
		obj[marker] = <span class="hljs-literal">true</span>;

		<span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj) {
			<span class="hljs-keyword">if</span> (key == marker)
				<span class="hljs-keyword">continue</span>;

			ret[key] = deepCopy(obj[key]);
		}

		<span class="hljs-keyword">delete</span> (obj[marker]);
		<span class="hljs-keyword">return</span> (ret);
	}

	<span class="hljs-keyword">if</span> (obj &amp;&amp; obj.constructor == <span class="hljs-built_in">Array</span>) {
		ret = [];
		obj[marker] = <span class="hljs-literal">true</span>;

		<span class="hljs-keyword">for</span> (key = <span class="hljs-number">0</span>; key &lt; obj.length; key++)
			ret.push(deepCopy(obj[key]));

		<span class="hljs-keyword">delete</span> (obj[marker]);
		<span class="hljs-keyword">return</span> (ret);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>It must be a primitive type -- just return it.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">return</span> (obj);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepEqual</span>(<span class="hljs-params">obj1, obj2</span>)
</span>{
	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> (obj1) != <span class="hljs-keyword">typeof</span> (obj2))
		<span class="hljs-keyword">return</span> (<span class="hljs-literal">false</span>);

	<span class="hljs-keyword">if</span> (obj1 === <span class="hljs-literal">null</span> || obj2 === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> (obj1) != <span class="hljs-string">'object'</span>)
		<span class="hljs-keyword">return</span> (obj1 === obj2);

	<span class="hljs-keyword">if</span> (obj1.constructor != obj2.constructor)
		<span class="hljs-keyword">return</span> (<span class="hljs-literal">false</span>);

	<span class="hljs-keyword">var</span> k;
	<span class="hljs-keyword">for</span> (k <span class="hljs-keyword">in</span> obj1) {
		<span class="hljs-keyword">if</span> (!obj2.hasOwnProperty(k))
			<span class="hljs-keyword">return</span> (<span class="hljs-literal">false</span>);

		<span class="hljs-keyword">if</span> (!deepEqual(obj1[k], obj2[k]))
			<span class="hljs-keyword">return</span> (<span class="hljs-literal">false</span>);
	}

	<span class="hljs-keyword">for</span> (k <span class="hljs-keyword">in</span> obj2) {
		<span class="hljs-keyword">if</span> (!obj1.hasOwnProperty(k))
			<span class="hljs-keyword">return</span> (<span class="hljs-literal">false</span>);
	}

	<span class="hljs-keyword">return</span> (<span class="hljs-literal">true</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isEmpty</span>(<span class="hljs-params">obj</span>)
</span>{
	<span class="hljs-keyword">var</span> key;
	<span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj)
		<span class="hljs-keyword">return</span> (<span class="hljs-literal">false</span>);
	<span class="hljs-keyword">return</span> (<span class="hljs-literal">true</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">forEachKey</span>(<span class="hljs-params">obj, callback</span>)
</span>{
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> obj)
		callback(key, obj[key]);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pluck</span>(<span class="hljs-params">obj, key</span>)
</span>{
	mod_assert.equal(<span class="hljs-keyword">typeof</span> (key), <span class="hljs-string">'string'</span>);
	<span class="hljs-keyword">return</span> (pluckv(obj, key));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pluckv</span>(<span class="hljs-params">obj, key</span>)
</span>{
	<span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> (obj) !== <span class="hljs-string">'object'</span>)
		<span class="hljs-keyword">return</span> (<span class="hljs-literal">undefined</span>);

	<span class="hljs-keyword">if</span> (obj.hasOwnProperty(key))
		<span class="hljs-keyword">return</span> (obj[key]);

	<span class="hljs-keyword">var</span> i = key.indexOf(<span class="hljs-string">'.'</span>);
	<span class="hljs-keyword">if</span> (i == <span class="hljs-number">-1</span>)
		<span class="hljs-keyword">return</span> (<span class="hljs-literal">undefined</span>);

	<span class="hljs-keyword">var</span> key1 = key.substr(<span class="hljs-number">0</span>, i);
	<span class="hljs-keyword">if</span> (!obj.hasOwnProperty(key1))
		<span class="hljs-keyword">return</span> (<span class="hljs-literal">undefined</span>);

	<span class="hljs-keyword">return</span> (pluckv(obj[key1], key.substr(i + <span class="hljs-number">1</span>)));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<div class="dox">
<div class="summary">
<p>Invoke callback(row) for each entry in the array that would be returned by
flattenObject(data, depth).  This is just like flattenObject(data,
depth).forEach(callback), except that the intermediate array is never
created.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flattenIter</span>(<span class="hljs-params">data, depth, callback</span>)
</span>{
	doFlattenIter(data, depth, [], callback);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doFlattenIter</span>(<span class="hljs-params">data, depth, accum, callback</span>)
</span>{
	<span class="hljs-keyword">var</span> each;
	<span class="hljs-keyword">var</span> key;

	<span class="hljs-keyword">if</span> (depth === <span class="hljs-number">0</span>) {
		each = accum.slice(<span class="hljs-number">0</span>);
		each.push(data);
		callback(each);
		<span class="hljs-keyword">return</span>;
	}

	mod_assert.ok(data !== <span class="hljs-literal">null</span>);
	mod_assert.equal(<span class="hljs-keyword">typeof</span> (data), <span class="hljs-string">'object'</span>);
	mod_assert.equal(<span class="hljs-keyword">typeof</span> (depth), <span class="hljs-string">'number'</span>);
	mod_assert.ok(depth &gt;= <span class="hljs-number">0</span>);

	<span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> data) {
		each = accum.slice(<span class="hljs-number">0</span>);
		each.push(key);
		doFlattenIter(data[key], depth - <span class="hljs-number">1</span>, each, callback);
	}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flattenObject</span>(<span class="hljs-params">data, depth</span>)
</span>{
	<span class="hljs-keyword">if</span> (depth === <span class="hljs-number">0</span>)
		<span class="hljs-keyword">return</span> ([ data ]);

	mod_assert.ok(data !== <span class="hljs-literal">null</span>);
	mod_assert.equal(<span class="hljs-keyword">typeof</span> (data), <span class="hljs-string">'object'</span>);
	mod_assert.equal(<span class="hljs-keyword">typeof</span> (depth), <span class="hljs-string">'number'</span>);
	mod_assert.ok(depth &gt;= <span class="hljs-number">0</span>);

	<span class="hljs-keyword">var</span> rv = [];
	<span class="hljs-keyword">var</span> key;

	<span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> data) {
		flattenObject(data[key], depth - <span class="hljs-number">1</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">p</span>) </span>{
			rv.push([ key ].concat(p));
		});
	}

	<span class="hljs-keyword">return</span> (rv);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startsWith</span>(<span class="hljs-params">str, prefix</span>)
</span>{
	<span class="hljs-keyword">return</span> (str.substr(<span class="hljs-number">0</span>, prefix.length) == prefix);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">endsWith</span>(<span class="hljs-params">str, suffix</span>)
</span>{
	<span class="hljs-keyword">return</span> (str.substr(
	    str.length - suffix.length, suffix.length) == suffix);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">iso8601</span>(<span class="hljs-params">d</span>)
</span>{
	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> (d) == <span class="hljs-string">'number'</span>)
		d = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(d);
	mod_assert.ok(d.constructor === <span class="hljs-built_in">Date</span>);
	<span class="hljs-keyword">return</span> (mod_extsprintf.sprintf(<span class="hljs-string">'%4d-%02d-%02dT%02d:%02d:%02d.%03dZ'</span>,
	    d.getUTCFullYear(), d.getUTCMonth() + <span class="hljs-number">1</span>, d.getUTCDate(),
	    d.getUTCHours(), d.getUTCMinutes(), d.getUTCSeconds(),
	    d.getUTCMilliseconds()));
}

<span class="hljs-keyword">var</span> RFC1123_MONTHS = [
    <span class="hljs-string">'Jan'</span>, <span class="hljs-string">'Feb'</span>, <span class="hljs-string">'Mar'</span>, <span class="hljs-string">'Apr'</span>, <span class="hljs-string">'May'</span>, <span class="hljs-string">'Jun'</span>,
    <span class="hljs-string">'Jul'</span>, <span class="hljs-string">'Aug'</span>, <span class="hljs-string">'Sep'</span>, <span class="hljs-string">'Oct'</span>, <span class="hljs-string">'Nov'</span>, <span class="hljs-string">'Dec'</span>];
<span class="hljs-keyword">var</span> RFC1123_DAYS = [
    <span class="hljs-string">'Sun'</span>, <span class="hljs-string">'Mon'</span>, <span class="hljs-string">'Tue'</span>, <span class="hljs-string">'Wed'</span>, <span class="hljs-string">'Thu'</span>, <span class="hljs-string">'Fri'</span>, <span class="hljs-string">'Sat'</span>];

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rfc1123</span>(<span class="hljs-params">date</span>) </span>{
	<span class="hljs-keyword">return</span> (mod_extsprintf.sprintf(<span class="hljs-string">'%s, %02d %s %04d %02d:%02d:%02d GMT'</span>,
	    RFC1123_DAYS[date.getUTCDay()], date.getUTCDate(),
	    RFC1123_MONTHS[date.getUTCMonth()], date.getUTCFullYear(),
	    date.getUTCHours(), date.getUTCMinutes(),
	    date.getUTCSeconds()));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<div class="dox">
<div class="summary">
<p>Parses a date expressed as a string, as either a number of milliseconds since
the epoch or any string format that Date accepts, giving preference to the
former where these two sets overlap (e.g., small numbers).</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseDateTime</span>(<span class="hljs-params">str</span>)
</span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<div class="dox">
<div class="summary">
<p>This is irritatingly implicit, but significantly more concise than
alternatives.  The &quot;+str&quot; will convert a string containing only a
number directly to a Number, or NaN for other strings.  Thus, if the
conversion succeeds, we use it (this is the milliseconds-since-epoch
case).  Otherwise, we pass the string directly to the Date
constructor to parse.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> numeric = +str;
	<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isNaN</span>(numeric)) {
		<span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(numeric));
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-keyword">return</span> (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(str));
	}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateJsonObjectJS</span>(<span class="hljs-params">schema, input</span>)
</span>{
	<span class="hljs-keyword">var</span> report = mod_jsonschema.validate(input, schema);

	<span class="hljs-keyword">if</span> (report.errors.length === <span class="hljs-number">0</span>)
		<span class="hljs-keyword">return</span> (<span class="hljs-literal">null</span>);

	<span class="hljs-comment">/* Currently, we only do anything useful with the first error. */</span>
	<span class="hljs-keyword">var</span> error = report.errors[<span class="hljs-number">0</span>];

	<span class="hljs-comment">/* The failed property is given by a URI with an irrelevant prefix. */</span>
	<span class="hljs-keyword">var</span> propname = error[<span class="hljs-string">'property'</span>];
	<span class="hljs-keyword">var</span> reason = error[<span class="hljs-string">'message'</span>].toLowerCase();
	<span class="hljs-keyword">var</span> i, j;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<div class="dox">
<div class="summary">
<p>There's at least one case where the property error message is
confusing at best.  We work around this here.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span> ((i = reason.indexOf(<span class="hljs-string">'the property '</span>)) != <span class="hljs-number">-1</span> &amp;&amp;
	    (j = reason.indexOf(<span class="hljs-string">' is not defined in the schema and the '</span> +
	    <span class="hljs-string">'schema does not allow additional properties'</span>)) != <span class="hljs-number">-1</span>) {
		i += <span class="hljs-string">'the property '</span>.length;
		<span class="hljs-keyword">if</span> (propname === <span class="hljs-string">''</span>)
			propname = reason.substr(i, j - i);
		<span class="hljs-keyword">else</span>
			propname = propname + <span class="hljs-string">'.'</span> + reason.substr(i, j - i);

		reason = <span class="hljs-string">'unsupported property'</span>;
	}

	<span class="hljs-keyword">var</span> rv = <span class="hljs-keyword">new</span> mod_verror.VError(<span class="hljs-string">'property "%s": %s'</span>, propname, reason);
	rv.jsv_details = error;
	<span class="hljs-keyword">return</span> (rv);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">randElt</span>(<span class="hljs-params">arr</span>)
</span>{
	mod_assert.ok(<span class="hljs-built_in">Array</span>.isArray(arr) &amp;&amp; arr.length &gt; <span class="hljs-number">0</span>,
	    <span class="hljs-string">'randElt argument must be a non-empty array'</span>);

	<span class="hljs-keyword">return</span> (arr[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * arr.length)]);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertHrtime</span>(<span class="hljs-params">a</span>)
</span>{
	mod_assert.ok(a[<span class="hljs-number">0</span>] &gt;= <span class="hljs-number">0</span> &amp;&amp; a[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">0</span>,
	    <span class="hljs-string">'negative numbers not allowed in hrtimes'</span>);
	mod_assert.ok(a[<span class="hljs-number">1</span>] &lt; <span class="hljs-number">1e9</span>, <span class="hljs-string">'nanoseconds column overflow'</span>);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<div class="dox">
<div class="summary">
<p>Compute the time elapsed between hrtime readings A and B, where A is later
than B.  hrtime readings come from Node's process.hrtime().  There is no
defined way to represent negative deltas, so it's illegal to diff B from A
where the time denoted by B is later than the time denoted by A.  If this
becomes valuable, we can define a representation and extend the
implementation to support it.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hrtimeDiff</span>(<span class="hljs-params">a, b</span>)
</span>{
	assertHrtime(a);
	assertHrtime(b);
	mod_assert.ok(a[<span class="hljs-number">0</span>] &gt; b[<span class="hljs-number">0</span>] || (a[<span class="hljs-number">0</span>] == b[<span class="hljs-number">0</span>] &amp;&amp; a[<span class="hljs-number">1</span>] &gt;= b[<span class="hljs-number">1</span>]),
	    <span class="hljs-string">'negative differences not allowed'</span>);

	<span class="hljs-keyword">var</span> rv = [ a[<span class="hljs-number">0</span>] - b[<span class="hljs-number">0</span>], <span class="hljs-number">0</span> ];

	<span class="hljs-keyword">if</span> (a[<span class="hljs-number">1</span>] &gt;= b[<span class="hljs-number">1</span>]) {
		rv[<span class="hljs-number">1</span>] = a[<span class="hljs-number">1</span>] - b[<span class="hljs-number">1</span>];
	} <span class="hljs-keyword">else</span> {
		rv[<span class="hljs-number">0</span>]--;
		rv[<span class="hljs-number">1</span>] = <span class="hljs-number">1e9</span> - (b[<span class="hljs-number">1</span>] - a[<span class="hljs-number">1</span>]);
	}

	<span class="hljs-keyword">return</span> (rv);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<div class="dox">
<div class="summary">
<p>Convert a hrtime reading from the array format returned by Node's
process.hrtime() into a scalar number of nanoseconds.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hrtimeNanosec</span>(<span class="hljs-params">a</span>)
</span>{
	assertHrtime(a);

	<span class="hljs-keyword">return</span> (<span class="hljs-built_in">Math</span>.floor(a[<span class="hljs-number">0</span>] * <span class="hljs-number">1e9</span> + a[<span class="hljs-number">1</span>]));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<div class="dox">
<div class="summary">
<p>Convert a hrtime reading from the array format returned by Node's
process.hrtime() into a scalar number of microseconds.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hrtimeMicrosec</span>(<span class="hljs-params">a</span>)
</span>{
	assertHrtime(a);

	<span class="hljs-keyword">return</span> (<span class="hljs-built_in">Math</span>.floor(a[<span class="hljs-number">0</span>] * <span class="hljs-number">1e6</span> + a[<span class="hljs-number">1</span>] / <span class="hljs-number">1e3</span>));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<div class="dox">
<div class="summary">
<p>Convert a hrtime reading from the array format returned by Node's
process.hrtime() into a scalar number of milliseconds.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hrtimeMillisec</span>(<span class="hljs-params">a</span>)
</span>{
	assertHrtime(a);

	<span class="hljs-keyword">return</span> (<span class="hljs-built_in">Math</span>.floor(a[<span class="hljs-number">0</span>] * <span class="hljs-number">1e3</span> + a[<span class="hljs-number">1</span>] / <span class="hljs-number">1e6</span>));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add two hrtime readings A and B, overwriting A with the result of the
addition.  This function is useful for accumulating several hrtime intervals
into a counter.  Returns A.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hrtimeAccum</span>(<span class="hljs-params">a, b</span>)
</span>{
	assertHrtime(a);
	assertHrtime(b);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<div class="dox">
<div class="summary">
<p>Accumulate the nanosecond component.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	a[<span class="hljs-number">1</span>] += b[<span class="hljs-number">1</span>];
	<span class="hljs-keyword">if</span> (a[<span class="hljs-number">1</span>] &gt;= <span class="hljs-number">1e9</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<div class="dox">
<div class="summary">
<p>The nanosecond component overflowed, so carry to the seconds
field.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">		a[<span class="hljs-number">0</span>]++;
		a[<span class="hljs-number">1</span>] -= <span class="hljs-number">1e9</span>;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<div class="dox">
<div class="summary">
<p>Accumulate the seconds component.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	a[<span class="hljs-number">0</span>] += b[<span class="hljs-number">0</span>];

	<span class="hljs-keyword">return</span> (a);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add two hrtime readings A and B, returning the result as a new hrtime array.
Does not modify either input argument.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hrtimeAdd</span>(<span class="hljs-params">a, b</span>)
</span>{
	assertHrtime(a);

	<span class="hljs-keyword">var</span> rv = [ a[<span class="hljs-number">0</span>], a[<span class="hljs-number">1</span>] ];

	<span class="hljs-keyword">return</span> (hrtimeAccum(rv, b));
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<div class="dox">
<div class="summary">
<p>Check an object for unexpected properties.  Accepts the object to check, and
an array of allowed property names (strings).  Returns an array of key names
that were found on the object, but did not appear in the list of allowed
properties.  If no properties were found, the returned array will be of
zero length.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extraProperties</span>(<span class="hljs-params">obj, allowed</span>)
</span>{
	mod_assert.ok(<span class="hljs-keyword">typeof</span> (obj) === <span class="hljs-string">'object'</span> &amp;&amp; obj !== <span class="hljs-literal">null</span>,
	    <span class="hljs-string">'obj argument must be a non-null object'</span>);
	mod_assert.ok(<span class="hljs-built_in">Array</span>.isArray(allowed),
	    <span class="hljs-string">'allowed argument must be an array of strings'</span>);
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; allowed.length; i++) {
		mod_assert.ok(<span class="hljs-keyword">typeof</span> (allowed[i]) === <span class="hljs-string">'string'</span>,
		    <span class="hljs-string">'allowed argument must be an array of strings'</span>);
	}

	<span class="hljs-keyword">return</span> (<span class="hljs-built_in">Object</span>.keys(obj).filter(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
		<span class="hljs-keyword">return</span> (allowed.indexOf(key) === <span class="hljs-number">-1</span>);
	}));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<div class="dox">
<div class="summary">
<p>Given three sets of properties &quot;provided&quot; (may be undefined), &quot;overrides&quot;
(required), and &quot;defaults&quot; (may be undefined), construct an object containing
the union of these sets with &quot;overrides&quot; overriding &quot;provided&quot;, and
&quot;provided&quot; overriding &quot;defaults&quot;.  None of the input objects are modified.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeObjects</span>(<span class="hljs-params">provided, overrides, defaults</span>)
</span>{
	<span class="hljs-keyword">var</span> rv, k;

	rv = {};
	<span class="hljs-keyword">if</span> (defaults) {
		<span class="hljs-keyword">for</span> (k <span class="hljs-keyword">in</span> defaults)
			rv[k] = defaults[k];
	}

	<span class="hljs-keyword">if</span> (provided) {
		<span class="hljs-keyword">for</span> (k <span class="hljs-keyword">in</span> provided)
			rv[k] = provided[k];
	}

	<span class="hljs-keyword">if</span> (overrides) {
		<span class="hljs-keyword">for</span> (k <span class="hljs-keyword">in</span> overrides)
			rv[k] = overrides[k];
	}

	<span class="hljs-keyword">return</span> (rv);
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
