<!DOCTYPE html>
<html>
<head>
  <title>core.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/jodid25519/lib/core.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>core.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">"use strict"</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>Copyright (c) 2007, 2013, 2014 Michele Bini
Copyright (c) 2014 Mega Limited
under the MIT License.</p>
</div>
<div class="body">
<p>Authors: Guy K. Kloss, Michele Bini</p>
<p>You should have received a copy of the license along with this program.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>Core operations on curve 25519 required for the higher level modules.</p>
</div>
<div class="body">
<p>
This core code is extracted from Michele Bini's curve255.js implementation,
which is used as a base for Curve25519 ECDH and Ed25519 EdDSA operations.
</p>
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> ns = {};

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_setbit</span>(<span class="hljs-params">n, c, v</span>) </span>{
        <span class="hljs-keyword">var</span> i = c &gt;&gt; <span class="hljs-number">4</span>;
        <span class="hljs-keyword">var</span> a = n[i];
        a = a + (<span class="hljs-number">1</span> &lt;&lt; (c &amp; <span class="hljs-number">0xf</span>)) * v;
        n[i] = a;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getbit</span>(<span class="hljs-params">n, c</span>) </span>{
        <span class="hljs-keyword">return</span> (n[c &gt;&gt; <span class="hljs-number">4</span>] &gt;&gt; (c &amp; <span class="hljs-number">0xf</span>)) &amp; <span class="hljs-number">1</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_ZERO</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_ONE</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Basepoint.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_BASE</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> [<span class="hljs-number">9</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>];
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>return -1, 0, +1 when a is less than, equal, or greater than b</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_bigintcmp</span>(<span class="hljs-params">a, b</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>The following code is a bit tricky to avoid code branching</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> c, abs_r, mask;
        <span class="hljs-keyword">var</span> r = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (c = <span class="hljs-number">15</span>; c &gt;= <span class="hljs-number">0</span>; c--) {
            <span class="hljs-keyword">var</span> x = a[c];
            <span class="hljs-keyword">var</span> y = b[c];
            r = r + (x - y) * (<span class="hljs-number">1</span> - r * r);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>http://graphics.stanford.edu/~seander/bithacks.html#IntegerAbs
correct for [-294967295, 294967295]</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            mask = r &gt;&gt; <span class="hljs-number">31</span>;
            abs_r = (r + mask) ^ mask;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>http://stackoverflow.com/questions/596467/how-do-i-convert-a-number-to-an-integer-in-javascript
this rounds towards zero</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            r = ~~((r &lt;&lt; <span class="hljs-number">1</span>) / (abs_r + <span class="hljs-number">1</span>));
        }
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_bigintadd</span>(<span class="hljs-params">a, b</span>) </span>{
        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = a[<span class="hljs-number">0</span>] + b[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">1</span>] + b[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">2</span>] + b[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">3</span>] + b[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">4</span>] + b[<span class="hljs-number">4</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">5</span>] + b[<span class="hljs-number">5</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">6</span>] + b[<span class="hljs-number">6</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">7</span>] + b[<span class="hljs-number">7</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">8</span>] + b[<span class="hljs-number">8</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">9</span>] + b[<span class="hljs-number">9</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">10</span>] + b[<span class="hljs-number">10</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">11</span>] + b[<span class="hljs-number">11</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">12</span>] + b[<span class="hljs-number">12</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">13</span>] + b[<span class="hljs-number">13</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">14</span>] + b[<span class="hljs-number">14</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">15</span>] + b[<span class="hljs-number">15</span>];
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_bigintsub</span>(<span class="hljs-params">a, b</span>) </span>{
        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = <span class="hljs-number">0x80000</span> + a[<span class="hljs-number">0</span>] - b[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">1</span>] - b[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">2</span>] - b[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">3</span>] - b[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">4</span>] - b[<span class="hljs-number">4</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">5</span>] - b[<span class="hljs-number">5</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">6</span>] - b[<span class="hljs-number">6</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">7</span>] - b[<span class="hljs-number">7</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">8</span>] - b[<span class="hljs-number">8</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">9</span>] - b[<span class="hljs-number">9</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">10</span>] - b[<span class="hljs-number">10</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">11</span>] - b[<span class="hljs-number">11</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">12</span>] - b[<span class="hljs-number">12</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">13</span>] - b[<span class="hljs-number">13</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">14</span>] - b[<span class="hljs-number">14</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) - <span class="hljs-number">8</span> + a[<span class="hljs-number">15</span>] - b[<span class="hljs-number">15</span>];
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_sqr8h</span>(<span class="hljs-params">a7, a6, a5, a4, a3, a2, a1, a0</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>'division by 0x10000' can not be replaced by '&gt;&gt; 16' because
more than 32 bits of precision are needed similarly
'multiplication by 2' cannot be replaced by '&lt;&lt; 1'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = a0 * a0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a0 * a1) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a0 * a2 + a1 * a1) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a0 * a3 + <span class="hljs-number">2</span> * a1 * a2) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a0 * a4 + <span class="hljs-number">2</span> * a1 * a3 + a2
                    * a2) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a0 * a5 + <span class="hljs-number">2</span> * a1 * a4 + <span class="hljs-number">2</span>
                    * a2 * a3) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a0 * a6 + <span class="hljs-number">2</span> * a1 * a5 + <span class="hljs-number">2</span>
                    * a2 * a4 + a3 * a3) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a0 * a7 + <span class="hljs-number">2</span> * a1 * a6 + <span class="hljs-number">2</span>
                    * a2 * a5 + <span class="hljs-number">2</span> * a3 * a4) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a1 * a7 + <span class="hljs-number">2</span> * a2 * a6 + <span class="hljs-number">2</span>
                    * a3 * a5 + a4 * a4) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a2 * a7 + <span class="hljs-number">2</span> * a3 * a6 + <span class="hljs-number">2</span>
                    * a4 * a5) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a3 * a7 + <span class="hljs-number">2</span> * a4 * a6
                     + a5 * a5) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a4 * a7 + <span class="hljs-number">2</span> * a5 * a6) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a5 * a7 + a6 * a6) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + <span class="hljs-number">2</span> * a6 * a7) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a7 * a7) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = <span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>);
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_sqrmodp</span>(<span class="hljs-params">a</span>) </span>{
        <span class="hljs-keyword">var</span> x = _sqr8h(a[<span class="hljs-number">15</span>], a[<span class="hljs-number">14</span>], a[<span class="hljs-number">13</span>], a[<span class="hljs-number">12</span>], a[<span class="hljs-number">11</span>], a[<span class="hljs-number">10</span>], a[<span class="hljs-number">9</span>],
                       a[<span class="hljs-number">8</span>]);
        <span class="hljs-keyword">var</span> z = _sqr8h(a[<span class="hljs-number">7</span>], a[<span class="hljs-number">6</span>], a[<span class="hljs-number">5</span>], a[<span class="hljs-number">4</span>], a[<span class="hljs-number">3</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">var</span> y = _sqr8h(a[<span class="hljs-number">15</span>] + a[<span class="hljs-number">7</span>], a[<span class="hljs-number">14</span>] + a[<span class="hljs-number">6</span>], a[<span class="hljs-number">13</span>] + a[<span class="hljs-number">5</span>], a[<span class="hljs-number">12</span>]
                                                                 + a[<span class="hljs-number">4</span>],
                       a[<span class="hljs-number">11</span>] + a[<span class="hljs-number">3</span>], a[<span class="hljs-number">10</span>] + a[<span class="hljs-number">2</span>], a[<span class="hljs-number">9</span>] + a[<span class="hljs-number">1</span>], a[<span class="hljs-number">8</span>]
                                                                + a[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = <span class="hljs-number">0x800000</span> + z[<span class="hljs-number">0</span>] + (y[<span class="hljs-number">8</span>] - x[<span class="hljs-number">8</span>] - z[<span class="hljs-number">8</span>] + x[<span class="hljs-number">0</span>] - <span class="hljs-number">0x80</span>)
                    * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">1</span>]
                    + (y[<span class="hljs-number">9</span>] - x[<span class="hljs-number">9</span>] - z[<span class="hljs-number">9</span>] + x[<span class="hljs-number">1</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">2</span>]
                    + (y[<span class="hljs-number">10</span>] - x[<span class="hljs-number">10</span>] - z[<span class="hljs-number">10</span>] + x[<span class="hljs-number">2</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">3</span>]
                    + (y[<span class="hljs-number">11</span>] - x[<span class="hljs-number">11</span>] - z[<span class="hljs-number">11</span>] + x[<span class="hljs-number">3</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">4</span>]
                    + (y[<span class="hljs-number">12</span>] - x[<span class="hljs-number">12</span>] - z[<span class="hljs-number">12</span>] + x[<span class="hljs-number">4</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">5</span>]
                    + (y[<span class="hljs-number">13</span>] - x[<span class="hljs-number">13</span>] - z[<span class="hljs-number">13</span>] + x[<span class="hljs-number">5</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">6</span>]
                    + (y[<span class="hljs-number">14</span>] - x[<span class="hljs-number">14</span>] - z[<span class="hljs-number">14</span>] + x[<span class="hljs-number">6</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">7</span>]
                    + (y[<span class="hljs-number">15</span>] - x[<span class="hljs-number">15</span>] - z[<span class="hljs-number">15</span>] + x[<span class="hljs-number">7</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">8</span>] + y[<span class="hljs-number">0</span>] - x[<span class="hljs-number">0</span>] - z[<span class="hljs-number">0</span>]
                    + x[<span class="hljs-number">8</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">9</span>] + y[<span class="hljs-number">1</span>] - x[<span class="hljs-number">1</span>] - z[<span class="hljs-number">1</span>]
                    + x[<span class="hljs-number">9</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">10</span>] + y[<span class="hljs-number">2</span>] - x[<span class="hljs-number">2</span>] - z[<span class="hljs-number">2</span>]
                     + x[<span class="hljs-number">10</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">11</span>] + y[<span class="hljs-number">3</span>] - x[<span class="hljs-number">3</span>] - z[<span class="hljs-number">3</span>]
                     + x[<span class="hljs-number">11</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">12</span>] + y[<span class="hljs-number">4</span>] - x[<span class="hljs-number">4</span>] - z[<span class="hljs-number">4</span>]
                     + x[<span class="hljs-number">12</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">13</span>] + y[<span class="hljs-number">5</span>] - x[<span class="hljs-number">5</span>] - z[<span class="hljs-number">5</span>]
                     + x[<span class="hljs-number">13</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">14</span>] + y[<span class="hljs-number">6</span>] - x[<span class="hljs-number">6</span>] - z[<span class="hljs-number">6</span>]
                     + x[<span class="hljs-number">14</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">15</span>] + y[<span class="hljs-number">7</span>] - x[<span class="hljs-number">7</span>] - z[<span class="hljs-number">7</span>]
                + x[<span class="hljs-number">15</span>] * <span class="hljs-number">38</span>;
        _reduce(r);
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_mul8h</span>(<span class="hljs-params">a7, a6, a5, a4, a3, a2, a1, a0, b7, b6, b5, b4, b3,
                    b2, b1, b0</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>'division by 0x10000' can not be replaced by '&gt;&gt; 16' because
more than 32 bits of precision are needed</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = a0 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a0 * b1 + a1 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a0 * b2 + a1 * b1 + a2 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a0 * b3 + a1 * b2 + a2 * b1
                    + a3 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a0 * b4 + a1 * b3 + a2 * b2
                    + a3 * b1 + a4 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a0 * b5 + a1 * b4 + a2 * b3
                    + a3 * b2 + a4 * b1 + a5 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a0 * b6 + a1 * b5 + a2 * b4
                    + a3 * b3 + a4 * b2 + a5 * b1 + a6 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a0 * b7 + a1 * b6 + a2 * b5
                    + a3 * b4 + a4 * b3 + a5 * b2 + a6 * b1 + a7 * b0) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a1 * b7 + a2 * b6 + a3 * b5
                    + a4 * b4 + a5 * b3 + a6 * b2 + a7 * b1) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a2 * b7 + a3 * b6 + a4 * b5
                    + a5 * b4 + a6 * b3 + a7 * b2) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a3 * b7 + a4 * b6 + a5 * b5
                     + a6 * b4 + a7 * b3) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a4 * b7 + a5 * b6 + a6 * b5
                     + a7 * b4) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a5 * b7 + a6 * b6 + a7 * b5) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a6 * b7 + a7 * b6) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a7 * b7) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>));
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_mulmodp</span>(<span class="hljs-params">a, b</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Karatsuba multiplication scheme: x<em>y = (b^2+b)<em>x1</em>y1 -
b</em>(x1-x0)*(y1-y0) + (b+1)<em>x0</em>y0</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> x = _mul8h(a[<span class="hljs-number">15</span>], a[<span class="hljs-number">14</span>], a[<span class="hljs-number">13</span>], a[<span class="hljs-number">12</span>], a[<span class="hljs-number">11</span>], a[<span class="hljs-number">10</span>], a[<span class="hljs-number">9</span>],
                       a[<span class="hljs-number">8</span>], b[<span class="hljs-number">15</span>], b[<span class="hljs-number">14</span>], b[<span class="hljs-number">13</span>], b[<span class="hljs-number">12</span>], b[<span class="hljs-number">11</span>], b[<span class="hljs-number">10</span>],
                       b[<span class="hljs-number">9</span>], b[<span class="hljs-number">8</span>]);
        <span class="hljs-keyword">var</span> z = _mul8h(a[<span class="hljs-number">7</span>], a[<span class="hljs-number">6</span>], a[<span class="hljs-number">5</span>], a[<span class="hljs-number">4</span>], a[<span class="hljs-number">3</span>], a[<span class="hljs-number">2</span>], a[<span class="hljs-number">1</span>], a[<span class="hljs-number">0</span>],
                       b[<span class="hljs-number">7</span>], b[<span class="hljs-number">6</span>], b[<span class="hljs-number">5</span>], b[<span class="hljs-number">4</span>], b[<span class="hljs-number">3</span>], b[<span class="hljs-number">2</span>], b[<span class="hljs-number">1</span>], b[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">var</span> y = _mul8h(a[<span class="hljs-number">15</span>] + a[<span class="hljs-number">7</span>], a[<span class="hljs-number">14</span>] + a[<span class="hljs-number">6</span>], a[<span class="hljs-number">13</span>] + a[<span class="hljs-number">5</span>], a[<span class="hljs-number">12</span>]
                                                                 + a[<span class="hljs-number">4</span>],
                       a[<span class="hljs-number">11</span>] + a[<span class="hljs-number">3</span>], a[<span class="hljs-number">10</span>] + a[<span class="hljs-number">2</span>], a[<span class="hljs-number">9</span>] + a[<span class="hljs-number">1</span>], a[<span class="hljs-number">8</span>]
                                                                + a[<span class="hljs-number">0</span>],
                       b[<span class="hljs-number">15</span>] + b[<span class="hljs-number">7</span>], b[<span class="hljs-number">14</span>] + b[<span class="hljs-number">6</span>], b[<span class="hljs-number">13</span>] + b[<span class="hljs-number">5</span>], b[<span class="hljs-number">12</span>]
                                                                 + b[<span class="hljs-number">4</span>],
                       b[<span class="hljs-number">11</span>] + b[<span class="hljs-number">3</span>], b[<span class="hljs-number">10</span>] + b[<span class="hljs-number">2</span>], b[<span class="hljs-number">9</span>] + b[<span class="hljs-number">1</span>], b[<span class="hljs-number">8</span>]
                                                                + b[<span class="hljs-number">0</span>]);
        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = <span class="hljs-number">0x800000</span> + z[<span class="hljs-number">0</span>] + (y[<span class="hljs-number">8</span>] - x[<span class="hljs-number">8</span>] - z[<span class="hljs-number">8</span>] + x[<span class="hljs-number">0</span>] - <span class="hljs-number">0x80</span>)
                    * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">1</span>]
                    + (y[<span class="hljs-number">9</span>] - x[<span class="hljs-number">9</span>] - z[<span class="hljs-number">9</span>] + x[<span class="hljs-number">1</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">2</span>]
                    + (y[<span class="hljs-number">10</span>] - x[<span class="hljs-number">10</span>] - z[<span class="hljs-number">10</span>] + x[<span class="hljs-number">2</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">3</span>]
                    + (y[<span class="hljs-number">11</span>] - x[<span class="hljs-number">11</span>] - z[<span class="hljs-number">11</span>] + x[<span class="hljs-number">3</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">4</span>]
                    + (y[<span class="hljs-number">12</span>] - x[<span class="hljs-number">12</span>] - z[<span class="hljs-number">12</span>] + x[<span class="hljs-number">4</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">5</span>]
                    + (y[<span class="hljs-number">13</span>] - x[<span class="hljs-number">13</span>] - z[<span class="hljs-number">13</span>] + x[<span class="hljs-number">5</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">6</span>]
                    + (y[<span class="hljs-number">14</span>] - x[<span class="hljs-number">14</span>] - z[<span class="hljs-number">14</span>] + x[<span class="hljs-number">6</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">7</span>]
                    + (y[<span class="hljs-number">15</span>] - x[<span class="hljs-number">15</span>] - z[<span class="hljs-number">15</span>] + x[<span class="hljs-number">7</span>]) * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">8</span>] + y[<span class="hljs-number">0</span>] - x[<span class="hljs-number">0</span>] - z[<span class="hljs-number">0</span>]
                    + x[<span class="hljs-number">8</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">9</span>] + y[<span class="hljs-number">1</span>] - x[<span class="hljs-number">1</span>] - z[<span class="hljs-number">1</span>]
                    + x[<span class="hljs-number">9</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">10</span>] + y[<span class="hljs-number">2</span>] - x[<span class="hljs-number">2</span>] - z[<span class="hljs-number">2</span>]
                     + x[<span class="hljs-number">10</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">11</span>] + y[<span class="hljs-number">3</span>] - x[<span class="hljs-number">3</span>] - z[<span class="hljs-number">3</span>]
                     + x[<span class="hljs-number">11</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">12</span>] + y[<span class="hljs-number">4</span>] - x[<span class="hljs-number">4</span>] - z[<span class="hljs-number">4</span>]
                     + x[<span class="hljs-number">12</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">13</span>] + y[<span class="hljs-number">5</span>] - x[<span class="hljs-number">5</span>] - z[<span class="hljs-number">5</span>]
                     + x[<span class="hljs-number">13</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">14</span>] + y[<span class="hljs-number">6</span>] - x[<span class="hljs-number">6</span>] - z[<span class="hljs-number">6</span>]
                     + x[<span class="hljs-number">14</span>] * <span class="hljs-number">38</span>) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = <span class="hljs-number">0x7fff80</span> + (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + z[<span class="hljs-number">15</span>] + y[<span class="hljs-number">7</span>] - x[<span class="hljs-number">7</span>] - z[<span class="hljs-number">7</span>]
                + x[<span class="hljs-number">15</span>] * <span class="hljs-number">38</span>;
        _reduce(r);
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_reduce</span>(<span class="hljs-params">arr</span>) </span>{
        <span class="hljs-keyword">var</span> aCopy = arr.slice(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">var</span> choice = [arr, aCopy];
        <span class="hljs-keyword">var</span> v = arr[<span class="hljs-number">15</span>];
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>Use the dummy copy instead of just returning to be more constant time.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> a = choice[(v &lt; <span class="hljs-number">0x8000</span>) &amp; <span class="hljs-number">1</span>];
        a[<span class="hljs-number">15</span>] = v &amp; <span class="hljs-number">0x7fff</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<blockquote>
<p>32-bits of precision are required here so '/ 0x8000' can not be
replaced by the arithmetic equivalent '&gt;&gt;&gt; 15'</p>
</blockquote>

        </td>
        <td class="code highlight">
          <pre class="javascript">        v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x8000</span>)) * <span class="hljs-number">19</span>;
        a[<span class="hljs-number">0</span>] = (v += a[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">1</span>] = (v += a[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">2</span>] = (v += a[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">3</span>] = (v += a[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">4</span>] = (v += a[<span class="hljs-number">4</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">5</span>] = (v += a[<span class="hljs-number">5</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">6</span>] = (v += a[<span class="hljs-number">6</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">7</span>] = (v += a[<span class="hljs-number">7</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">8</span>] = (v += a[<span class="hljs-number">8</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">9</span>] = (v += a[<span class="hljs-number">9</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">10</span>] = (v += a[<span class="hljs-number">10</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">11</span>] = (v += a[<span class="hljs-number">11</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">12</span>] = (v += a[<span class="hljs-number">12</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">13</span>] = (v += a[<span class="hljs-number">13</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">14</span>] = (v += a[<span class="hljs-number">14</span>]) &amp; <span class="hljs-number">0xffff</span>;
        v = v &gt;&gt;&gt; <span class="hljs-number">16</span>;
        a[<span class="hljs-number">15</span>] += v;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_addmodp</span>(<span class="hljs-params">a, b</span>) </span>{
        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = ((<span class="hljs-number">0</span> | (a[<span class="hljs-number">15</span>] &gt;&gt;&gt; <span class="hljs-number">15</span>)) + (<span class="hljs-number">0</span> | (b[<span class="hljs-number">15</span>] &gt;&gt;&gt; <span class="hljs-number">15</span>))) * <span class="hljs-number">19</span>
                    + a[<span class="hljs-number">0</span>] + b[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">1</span>] + b[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">2</span>] + b[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">3</span>] + b[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">4</span>] + b[<span class="hljs-number">4</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">5</span>] + b[<span class="hljs-number">5</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">6</span>] + b[<span class="hljs-number">6</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">7</span>] + b[<span class="hljs-number">7</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">8</span>] + b[<span class="hljs-number">8</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">9</span>] + b[<span class="hljs-number">9</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">10</span>] + b[<span class="hljs-number">10</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">11</span>] + b[<span class="hljs-number">11</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">12</span>] + b[<span class="hljs-number">12</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">13</span>] + b[<span class="hljs-number">13</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + a[<span class="hljs-number">14</span>] + b[<span class="hljs-number">14</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + (a[<span class="hljs-number">15</span>] &amp; <span class="hljs-number">0x7fff</span>) + (b[<span class="hljs-number">15</span>] &amp; <span class="hljs-number">0x7fff</span>);
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_submodp</span>(<span class="hljs-params">a, b</span>) </span>{
        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = <span class="hljs-number">0x80000</span>
                    + ((<span class="hljs-number">0</span> | (a[<span class="hljs-number">15</span>] &gt;&gt;&gt; <span class="hljs-number">15</span>)) - (<span class="hljs-number">0</span> | (b[<span class="hljs-number">15</span>] &gt;&gt;&gt; <span class="hljs-number">15</span>)) - <span class="hljs-number">1</span>)
                    * <span class="hljs-number">19</span> + a[<span class="hljs-number">0</span>] - b[<span class="hljs-number">0</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">1</span>] - b[<span class="hljs-number">1</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">2</span>] - b[<span class="hljs-number">2</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">3</span>] - b[<span class="hljs-number">3</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">4</span>] - b[<span class="hljs-number">4</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">5</span>] - b[<span class="hljs-number">5</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">6</span>] - b[<span class="hljs-number">6</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">7</span>] - b[<span class="hljs-number">7</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">8</span>] - b[<span class="hljs-number">8</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">9</span>] - b[<span class="hljs-number">9</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">10</span>] - b[<span class="hljs-number">10</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">11</span>] - b[<span class="hljs-number">11</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">12</span>] - b[<span class="hljs-number">12</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">13</span>] - b[<span class="hljs-number">13</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7fff8</span> + a[<span class="hljs-number">14</span>] - b[<span class="hljs-number">14</span>]) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = (v &gt;&gt;&gt; <span class="hljs-number">16</span>) + <span class="hljs-number">0x7ff8</span> + (a[<span class="hljs-number">15</span>] &amp; <span class="hljs-number">0x7fff</span>)
                - (b[<span class="hljs-number">15</span>] &amp; <span class="hljs-number">0x7fff</span>);
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_invmodp</span>(<span class="hljs-params">a</span>) </span>{
        <span class="hljs-keyword">var</span> c = a;
        <span class="hljs-keyword">var</span> i = <span class="hljs-number">250</span>;
        <span class="hljs-keyword">while</span> (--i) {
            a = _sqrmodp(a);
            a = _mulmodp(a, c);
        }
        a = _sqrmodp(a);
        a = _sqrmodp(a);
        a = _mulmodp(a, c);
        a = _sqrmodp(a);
        a = _sqrmodp(a);
        a = _mulmodp(a, c);
        a = _sqrmodp(a);
        a = _mulmodp(a, c);
        <span class="hljs-keyword">return</span> a;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_mulasmall</span>(<span class="hljs-params">a</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>'division by 0x10000' can not be replaced by '&gt;&gt; 16' because
more than 32 bits of precision are needed</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> m = <span class="hljs-number">121665</span>;
        <span class="hljs-keyword">var</span> r = [];
        <span class="hljs-keyword">var</span> v;
        r[<span class="hljs-number">0</span>] = (v = a[<span class="hljs-number">0</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">1</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">1</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">2</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">2</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">3</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">3</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">4</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">4</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">5</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">5</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">6</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">6</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">7</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">7</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">8</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">8</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">9</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">9</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">10</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">10</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">11</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">11</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">12</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">12</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">13</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">13</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">14</span>] = (v = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">14</span>] * m) &amp; <span class="hljs-number">0xffff</span>;
        r[<span class="hljs-number">15</span>] = (<span class="hljs-number">0</span> | (v / <span class="hljs-number">0x10000</span>)) + a[<span class="hljs-number">15</span>] * m;
        _reduce(r);
        <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_dbl</span>(<span class="hljs-params">x, z</span>) </span>{
        <span class="hljs-keyword">var</span> x_2, z_2, m, n, o;
        m = _sqrmodp(_addmodp(x, z));
        n = _sqrmodp(_submodp(x, z));
        o = _submodp(m, n);
        x_2 = _mulmodp(n, m);
        z_2 = _mulmodp(_addmodp(_mulasmall(o), m), o);
        <span class="hljs-keyword">return</span> [x_2, z_2];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_sum</span>(<span class="hljs-params">x, z, x_p, z_p, x_1</span>) </span>{
        <span class="hljs-keyword">var</span> x_3, z_3, p, q;
        p = _mulmodp(_submodp(x, z), _addmodp(x_p, z_p));
        q = _mulmodp(_addmodp(x, z), _submodp(x_p, z_p));
        x_3 = _sqrmodp(_addmodp(p, q));
        z_3 = _mulmodp(_sqrmodp(_submodp(p, q)), x_1);
        <span class="hljs-keyword">return</span> [x_3, z_3];
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_generateKey</span>(<span class="hljs-params">curve25519</span>) </span>{
        <span class="hljs-keyword">var</span> buffer = crypto.randomBytes(<span class="hljs-number">32</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>For Curve25519 DH keys, we need to apply some bit mask on generated
keys:</p>
<ul>
<li>clear bit 0, 1, 2 of first byte</li>
<li>clear bit 7 of last byte</li>
<li>set bit 6 of last byte</li>
</ul>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (curve25519 === <span class="hljs-literal">true</span>) {
            buffer[<span class="hljs-number">0</span>] &amp;= <span class="hljs-number">0xf8</span>;
            buffer[<span class="hljs-number">31</span>] = (buffer[<span class="hljs-number">31</span>] &amp; <span class="hljs-number">0x7f</span>) | <span class="hljs-number">0x40</span>;
        }
        <span class="hljs-keyword">var</span> result = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; buffer.length; i++) {
            result.push(<span class="hljs-built_in">String</span>.fromCharCode(buffer[i]));
        }
        <span class="hljs-keyword">return</span> result.join(<span class="hljs-string">''</span>);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Expose some functions to the outside through this name space.
Note: This is not part of the public API.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    ns.getbit = _getbit;
    ns.setbit = _setbit;
    ns.addmodp = _addmodp;
    ns.invmodp = _invmodp;
    ns.mulmodp = _mulmodp;
    ns.reduce = _reduce;
    ns.dbl = _dbl;
    ns.sum = _sum;
    ns.ZERO = _ZERO;
    ns.ONE = _ONE;
    ns.BASE = _BASE;
    ns.bigintadd = _bigintadd;
    ns.bigintsub = _bigintsub;
    ns.bigintcmp = _bigintcmp;
    ns.mulmodp = _mulmodp;
    ns.sqrmodp = _sqrmodp;
    ns.generateKey = _generateKey;


<span class="hljs-built_in">module</span>.exports = ns;

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
