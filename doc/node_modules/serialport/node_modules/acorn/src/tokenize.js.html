<!DOCTYPE html>
<html>
<head>
  <title>tokenize.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/acorn/src/tokenize.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h2">
        <a href="#tokenizer">Tokenizer</a>
      </div>

      <div class="heading h3">
        <a href="#token-reading">Token reading</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>tokenize.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> {isIdentifierStart, isIdentifierChar} <span class="hljs-keyword">from</span> <span class="hljs-string">"./identifier"</span>
<span class="hljs-keyword">import</span> {types <span class="hljs-keyword">as</span> tt, keywords <span class="hljs-keyword">as</span> keywordTypes} <span class="hljs-keyword">from</span> <span class="hljs-string">"./tokentype"</span>
<span class="hljs-keyword">import</span> {Parser} <span class="hljs-keyword">from</span> <span class="hljs-string">"./state"</span>
<span class="hljs-keyword">import</span> {SourceLocation} <span class="hljs-keyword">from</span> <span class="hljs-string">"./location"</span>
<span class="hljs-keyword">import</span> {lineBreak, lineBreakG, isNewLine, nonASCIIwhitespace} <span class="hljs-keyword">from</span> <span class="hljs-string">"./whitespace"</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Object type used to represent tokens. Note that normally, tokens
simply exist as properties on the parser object. This is only
used for the onToken callback and the external tokenizer.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Token</span> </span>{
  <span class="hljs-keyword">constructor</span>(p) {
    <span class="hljs-keyword">this</span>.type = p.type
    <span class="hljs-keyword">this</span>.value = p.value
    <span class="hljs-keyword">this</span>.start = p.start
    <span class="hljs-keyword">this</span>.end = p.end
    <span class="hljs-keyword">if</span> (p.options.locations)
      <span class="hljs-keyword">this</span>.loc = <span class="hljs-keyword">new</span> SourceLocation(p, p.startLoc, p.endLoc)
    <span class="hljs-keyword">if</span> (p.options.ranges)
      <span class="hljs-keyword">this</span>.range = [p.start, p.end]
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="tokenizer">
  <h2>
    <a href="#tokenizer" name="tokenizer" class="pilcrow"></a>
Tokenizer
  </h2>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">const</span> pp = Parser.prototype

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Are we running under Rhino?</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">const</span> isRhino = <span class="hljs-keyword">typeof</span> Packages !== <span class="hljs-string">"undefined"</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Move to the next token</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.next = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.onToken)
    <span class="hljs-keyword">this</span>.options.onToken(<span class="hljs-keyword">new</span> Token(<span class="hljs-keyword">this</span>))

  <span class="hljs-keyword">this</span>.lastTokEnd = <span class="hljs-keyword">this</span>.end
  <span class="hljs-keyword">this</span>.lastTokStart = <span class="hljs-keyword">this</span>.start
  <span class="hljs-keyword">this</span>.lastTokEndLoc = <span class="hljs-keyword">this</span>.endLoc
  <span class="hljs-keyword">this</span>.lastTokStartLoc = <span class="hljs-keyword">this</span>.startLoc
  <span class="hljs-keyword">this</span>.nextToken()
}

pp.getToken = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.next()
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Token(<span class="hljs-keyword">this</span>)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>If we're in an ES6 environment, make parsers iterable</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">Symbol</span> !== <span class="hljs-string">"undefined"</span>)
  pp[<span class="hljs-built_in">Symbol</span>.iterator] = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">let</span> self = <span class="hljs-keyword">this</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">let</span> token = self.getToken()
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">done</span>: token.type === tt.eof,
        <span class="hljs-attr">value</span>: token
      }
    }}
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Toggle strict mode. Re-reads the next number or string to please
pedantic tests (<code>&quot;use strict&quot;; 010;</code> should fail).</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.setStrict = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">strict</span>) </span>{
  <span class="hljs-keyword">this</span>.strict = strict
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type !== tt.num &amp;&amp; <span class="hljs-keyword">this</span>.type !== tt.string) <span class="hljs-keyword">return</span>
  <span class="hljs-keyword">this</span>.pos = <span class="hljs-keyword">this</span>.start
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) {
    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.pos &lt; <span class="hljs-keyword">this</span>.lineStart) {
      <span class="hljs-keyword">this</span>.lineStart = <span class="hljs-keyword">this</span>.input.lastIndexOf(<span class="hljs-string">"\n"</span>, <span class="hljs-keyword">this</span>.lineStart - <span class="hljs-number">2</span>) + <span class="hljs-number">1</span>
      --<span class="hljs-keyword">this</span>.curLine
    }
  }
  <span class="hljs-keyword">this</span>.nextToken()
}

pp.curContext = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.context[<span class="hljs-keyword">this</span>.context.length - <span class="hljs-number">1</span>]
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Read a single token, updating the parser object's token-related
properties.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.nextToken = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> curContext = <span class="hljs-keyword">this</span>.curContext()
  <span class="hljs-keyword">if</span> (!curContext || !curContext.preserveSpace) <span class="hljs-keyword">this</span>.skipSpace()

  <span class="hljs-keyword">this</span>.start = <span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) <span class="hljs-keyword">this</span>.startLoc = <span class="hljs-keyword">this</span>.curPosition()
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos &gt;= <span class="hljs-keyword">this</span>.input.length) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.eof)

  <span class="hljs-keyword">if</span> (curContext.override) <span class="hljs-keyword">return</span> curContext.override(<span class="hljs-keyword">this</span>)
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span>.readToken(<span class="hljs-keyword">this</span>.fullCharCodeAtPos())
}

pp.readToken = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Identifier or keyword. '\uXXXX' sequences are allowed in
identifiers, so '' also dispatches to that.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (isIdentifierStart(code, <span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span>) || code === <span class="hljs-number">92</span> <span class="hljs-comment">/* '\' */</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readWord()

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getTokenFromCode(code)
}

pp.fullCharCodeAtPos = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> code = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos)
  <span class="hljs-keyword">if</span> (code &lt;= <span class="hljs-number">0xd7ff</span> || code &gt;= <span class="hljs-number">0xe000</span>) <span class="hljs-keyword">return</span> code
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">return</span> (code &lt;&lt; <span class="hljs-number">10</span>) + next - <span class="hljs-number">0x35fdc00</span>
}

pp.skipBlockComment = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> startLoc = <span class="hljs-keyword">this</span>.options.onComment &amp;&amp; <span class="hljs-keyword">this</span>.options.locations &amp;&amp; <span class="hljs-keyword">this</span>.curPosition()
  <span class="hljs-keyword">let</span> start = <span class="hljs-keyword">this</span>.pos, end = <span class="hljs-keyword">this</span>.input.indexOf(<span class="hljs-string">"*/"</span>, <span class="hljs-keyword">this</span>.pos += <span class="hljs-number">2</span>)
  <span class="hljs-keyword">if</span> (end === <span class="hljs-number">-1</span>) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.pos - <span class="hljs-number">2</span>, <span class="hljs-string">"Unterminated comment"</span>)
  <span class="hljs-keyword">this</span>.pos = end + <span class="hljs-number">2</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) {
    lineBreakG.lastIndex = start
    <span class="hljs-keyword">let</span> match
    <span class="hljs-keyword">while</span> ((match = lineBreakG.exec(<span class="hljs-keyword">this</span>.input)) &amp;&amp; match.index &lt; <span class="hljs-keyword">this</span>.pos) {
      ++<span class="hljs-keyword">this</span>.curLine
      <span class="hljs-keyword">this</span>.lineStart = match.index + match[<span class="hljs-number">0</span>].length
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.onComment)
    <span class="hljs-keyword">this</span>.options.onComment(<span class="hljs-literal">true</span>, <span class="hljs-keyword">this</span>.input.slice(start + <span class="hljs-number">2</span>, end), start, <span class="hljs-keyword">this</span>.pos,
                           startLoc, <span class="hljs-keyword">this</span>.options.locations &amp;&amp; <span class="hljs-keyword">this</span>.curPosition())
}

pp.skipLineComment = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">startSkip</span>) </span>{
  <span class="hljs-keyword">let</span> start = <span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">let</span> startLoc = <span class="hljs-keyword">this</span>.options.onComment &amp;&amp; <span class="hljs-keyword">this</span>.options.locations &amp;&amp; <span class="hljs-keyword">this</span>.curPosition()
  <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos+=startSkip)
  <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.pos &lt; <span class="hljs-keyword">this</span>.input.length &amp;&amp; ch !== <span class="hljs-number">10</span> &amp;&amp; ch !== <span class="hljs-number">13</span> &amp;&amp; ch !== <span class="hljs-number">8232</span> &amp;&amp; ch !== <span class="hljs-number">8233</span>) {
    ++<span class="hljs-keyword">this</span>.pos
    ch = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos)
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.onComment)
    <span class="hljs-keyword">this</span>.options.onComment(<span class="hljs-literal">false</span>, <span class="hljs-keyword">this</span>.input.slice(start + startSkip, <span class="hljs-keyword">this</span>.pos), start, <span class="hljs-keyword">this</span>.pos,
                           startLoc, <span class="hljs-keyword">this</span>.options.locations &amp;&amp; <span class="hljs-keyword">this</span>.curPosition())
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Called at the start of the parse and after every token. Skips
whitespace and comments, and.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.skipSpace = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.pos &lt; <span class="hljs-keyword">this</span>.input.length) {
    <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos)
    <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">32</span>) { <span class="hljs-comment">// ' '</span>
      ++<span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">13</span>) {
      ++<span class="hljs-keyword">this</span>.pos
      <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos)
      <span class="hljs-keyword">if</span> (next === <span class="hljs-number">10</span>) {
        ++<span class="hljs-keyword">this</span>.pos
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) {
        ++<span class="hljs-keyword">this</span>.curLine
        <span class="hljs-keyword">this</span>.lineStart = <span class="hljs-keyword">this</span>.pos
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">10</span> || ch === <span class="hljs-number">8232</span> || ch === <span class="hljs-number">8233</span>) {
      ++<span class="hljs-keyword">this</span>.pos
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) {
        ++<span class="hljs-keyword">this</span>.curLine
        <span class="hljs-keyword">this</span>.lineStart = <span class="hljs-keyword">this</span>.pos
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch &gt; <span class="hljs-number">8</span> &amp;&amp; ch &lt; <span class="hljs-number">14</span>) {
      ++<span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">47</span>) { <span class="hljs-comment">// '/'</span>
      <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
      <span class="hljs-keyword">if</span> (next === <span class="hljs-number">42</span>) { <span class="hljs-comment">// '*'</span>
        <span class="hljs-keyword">this</span>.skipBlockComment()
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (next === <span class="hljs-number">47</span>) { <span class="hljs-comment">// '/'</span>
        <span class="hljs-keyword">this</span>.skipLineComment(<span class="hljs-number">2</span>)
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">break</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">160</span>) { <span class="hljs-comment">// '\xa0'</span>
      ++<span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch &gt;= <span class="hljs-number">5760</span> &amp;&amp; nonASCIIwhitespace.test(<span class="hljs-built_in">String</span>.fromCharCode(ch))) {
      ++<span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">break</span>
    }
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Called at the end of every token. Sets <code>end</code>, <code>val</code>, and
maintains <code>context</code> and <code>exprAllowed</code>, and skips the space after
the token, so that the next one's <code>start</code> will point at the
right position.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.finishToken = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, val</span>) </span>{
  <span class="hljs-keyword">this</span>.end = <span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) <span class="hljs-keyword">this</span>.endLoc = <span class="hljs-keyword">this</span>.curPosition()
  <span class="hljs-keyword">let</span> prevType = <span class="hljs-keyword">this</span>.type
  <span class="hljs-keyword">this</span>.type = type
  <span class="hljs-keyword">this</span>.value = val

  <span class="hljs-keyword">this</span>.updateContext(prevType)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="token-reading">
  <h3>
    <a href="#token-reading" name="token-reading" class="pilcrow"></a>
Token reading
  </h3>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>This is the function that is called to fetch the next token. It
is somewhat obscure, because it works in character codes rather
than characters, and because operator parsing has been inlined
into it.</p>
<p>All in the name of speed.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">pp.readToken_dot = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">if</span> (next &gt;= <span class="hljs-number">48</span> &amp;&amp; next &lt;= <span class="hljs-number">57</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readNumber(<span class="hljs-literal">true</span>)
  <span class="hljs-keyword">let</span> next2 = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">2</span>)
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span> &amp;&amp; next === <span class="hljs-number">46</span> &amp;&amp; next2 === <span class="hljs-number">46</span>) { <span class="hljs-comment">// 46 = dot '.'</span>
    <span class="hljs-keyword">this</span>.pos += <span class="hljs-number">3</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.ellipsis)
  } <span class="hljs-keyword">else</span> {
    ++<span class="hljs-keyword">this</span>.pos
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.dot)
  }
}

pp.readToken_slash = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">// '/'</span>
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.exprAllowed) {++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readRegexp();}
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">61</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.assign, <span class="hljs-number">2</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.slash, <span class="hljs-number">1</span>)
}

pp.readToken_mult_modulo = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{ <span class="hljs-comment">// '%*'</span>
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">61</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.assign, <span class="hljs-number">2</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(code === <span class="hljs-number">42</span> ? tt.star : tt.modulo, <span class="hljs-number">1</span>)
}

pp.readToken_pipe_amp = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{ <span class="hljs-comment">// '|&amp;'</span>
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">if</span> (next === code) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(code === <span class="hljs-number">124</span> ? tt.logicalOR : tt.logicalAND, <span class="hljs-number">2</span>)
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">61</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.assign, <span class="hljs-number">2</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(code === <span class="hljs-number">124</span> ? tt.bitwiseOR : tt.bitwiseAND, <span class="hljs-number">1</span>)
}

pp.readToken_caret = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-comment">// '^'</span>
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">61</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.assign, <span class="hljs-number">2</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.bitwiseXOR, <span class="hljs-number">1</span>)
}

pp.readToken_plus_min = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{ <span class="hljs-comment">// '+-'</span>
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">if</span> (next === code) {
    <span class="hljs-keyword">if</span> (next == <span class="hljs-number">45</span> &amp;&amp; <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">2</span>) == <span class="hljs-number">62</span> &amp;&amp;
        lineBreak.test(<span class="hljs-keyword">this</span>.input.slice(<span class="hljs-keyword">this</span>.lastTokEnd, <span class="hljs-keyword">this</span>.pos))) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>A <code>--&gt;</code> line comment</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">this</span>.skipLineComment(<span class="hljs-number">3</span>)
      <span class="hljs-keyword">this</span>.skipSpace()
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nextToken()
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.incDec, <span class="hljs-number">2</span>)
  }
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">61</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.assign, <span class="hljs-number">2</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.plusMin, <span class="hljs-number">1</span>)
}

pp.readToken_lt_gt = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{ <span class="hljs-comment">// '&lt;&gt;'</span>
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">let</span> size = <span class="hljs-number">1</span>
  <span class="hljs-keyword">if</span> (next === code) {
    size = code === <span class="hljs-number">62</span> &amp;&amp; <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">2</span>) === <span class="hljs-number">62</span> ? <span class="hljs-number">3</span> : <span class="hljs-number">2</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + size) === <span class="hljs-number">61</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.assign, size + <span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.bitShift, size)
  }
  <span class="hljs-keyword">if</span> (next == <span class="hljs-number">33</span> &amp;&amp; code == <span class="hljs-number">60</span> &amp;&amp; <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">2</span>) == <span class="hljs-number">45</span> &amp;&amp;
      <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">3</span>) == <span class="hljs-number">45</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.inModule) <span class="hljs-keyword">this</span>.unexpected()
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p><code>&lt;!--</code>, an XML-style comment that should be interpreted as a line comment</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">this</span>.skipLineComment(<span class="hljs-number">4</span>)
    <span class="hljs-keyword">this</span>.skipSpace()
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.nextToken()
  }
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">61</span>)
    size = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">2</span>) === <span class="hljs-number">61</span> ? <span class="hljs-number">3</span> : <span class="hljs-number">2</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.relational, size)
}

pp.readToken_eq_excl = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{ <span class="hljs-comment">// '=!'</span>
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">61</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.equality, <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">2</span>) === <span class="hljs-number">61</span> ? <span class="hljs-number">3</span> : <span class="hljs-number">2</span>)
  <span class="hljs-keyword">if</span> (code === <span class="hljs-number">61</span> &amp;&amp; next === <span class="hljs-number">62</span> &amp;&amp; <span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span>) { <span class="hljs-comment">// '=&gt;'</span>
    <span class="hljs-keyword">this</span>.pos += <span class="hljs-number">2</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.arrow)
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(code === <span class="hljs-number">61</span> ? tt.eq : tt.prefix, <span class="hljs-number">1</span>)
}

pp.getTokenFromCode = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">code</span>) </span>{
  <span class="hljs-keyword">switch</span> (code) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>The interpretation of a dot depends on whether it is followed
by a digit or another two dots.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">case</span> <span class="hljs-number">46</span>: <span class="hljs-comment">// '.'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_dot()

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Punctuation tokens.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">case</span> <span class="hljs-number">40</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.parenL)
  <span class="hljs-keyword">case</span> <span class="hljs-number">41</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.parenR)
  <span class="hljs-keyword">case</span> <span class="hljs-number">59</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.semi)
  <span class="hljs-keyword">case</span> <span class="hljs-number">44</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.comma)
  <span class="hljs-keyword">case</span> <span class="hljs-number">91</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.bracketL)
  <span class="hljs-keyword">case</span> <span class="hljs-number">93</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.bracketR)
  <span class="hljs-keyword">case</span> <span class="hljs-number">123</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.braceL)
  <span class="hljs-keyword">case</span> <span class="hljs-number">125</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.braceR)
  <span class="hljs-keyword">case</span> <span class="hljs-number">58</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.colon)
  <span class="hljs-keyword">case</span> <span class="hljs-number">63</span>: ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.question)

  <span class="hljs-keyword">case</span> <span class="hljs-number">96</span>: <span class="hljs-comment">// '`'</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ecmaVersion &lt; <span class="hljs-number">6</span>) <span class="hljs-keyword">break</span>
    ++<span class="hljs-keyword">this</span>.pos
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.backQuote)

  <span class="hljs-keyword">case</span> <span class="hljs-number">48</span>: <span class="hljs-comment">// '0'</span>
    <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>)
    <span class="hljs-keyword">if</span> (next === <span class="hljs-number">120</span> || next === <span class="hljs-number">88</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readRadixNumber(<span class="hljs-number">16</span>); <span class="hljs-comment">// '0x', '0X' - hex number</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span>) {
      <span class="hljs-keyword">if</span> (next === <span class="hljs-number">111</span> || next === <span class="hljs-number">79</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readRadixNumber(<span class="hljs-number">8</span>); <span class="hljs-comment">// '0o', '0O' - octal number</span>
      <span class="hljs-keyword">if</span> (next === <span class="hljs-number">98</span> || next === <span class="hljs-number">66</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readRadixNumber(<span class="hljs-number">2</span>); <span class="hljs-comment">// '0b', '0B' - binary number</span>
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Anything else beginning with a digit is an integer, octal
number, or float.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">case</span> <span class="hljs-number">49</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">50</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">51</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">52</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">53</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">54</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">55</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">56</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">57</span>: <span class="hljs-comment">// 1-9</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readNumber(<span class="hljs-literal">false</span>)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>Quotes produce strings.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">case</span> <span class="hljs-number">34</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">39</span>: <span class="hljs-comment">// '"', "'"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readString(code)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>Operators are parsed inline in tiny state machines. '=' (61) is
often referred to. <code>finishOp</code> simply skips the amount of
characters it is given as second argument, and returns a token
of the type given by its first argument.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
  <span class="hljs-keyword">case</span> <span class="hljs-number">47</span>: <span class="hljs-comment">// '/'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_slash()

  <span class="hljs-keyword">case</span> <span class="hljs-number">37</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">42</span>: <span class="hljs-comment">// '%*'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_mult_modulo(code)

  <span class="hljs-keyword">case</span> <span class="hljs-number">124</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">38</span>: <span class="hljs-comment">// '|&amp;'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_pipe_amp(code)

  <span class="hljs-keyword">case</span> <span class="hljs-number">94</span>: <span class="hljs-comment">// '^'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_caret()

  <span class="hljs-keyword">case</span> <span class="hljs-number">43</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">45</span>: <span class="hljs-comment">// '+-'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_plus_min(code)

  <span class="hljs-keyword">case</span> <span class="hljs-number">60</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">62</span>: <span class="hljs-comment">// '&lt;&gt;'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_lt_gt(code)

  <span class="hljs-keyword">case</span> <span class="hljs-number">61</span>: <span class="hljs-keyword">case</span> <span class="hljs-number">33</span>: <span class="hljs-comment">// '=!'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.readToken_eq_excl(code)

  <span class="hljs-keyword">case</span> <span class="hljs-number">126</span>: <span class="hljs-comment">// '~'</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishOp(tt.prefix, <span class="hljs-number">1</span>)
  }

  <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.pos, <span class="hljs-string">"Unexpected character '"</span> + codePointToString(code) + <span class="hljs-string">"'"</span>)
}

pp.finishOp = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">type, size</span>) </span>{
  <span class="hljs-keyword">let</span> str = <span class="hljs-keyword">this</span>.input.slice(<span class="hljs-keyword">this</span>.pos, <span class="hljs-keyword">this</span>.pos + size)
  <span class="hljs-keyword">this</span>.pos += size
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(type, str)
}

<span class="hljs-keyword">var</span> regexpUnicodeSupport = <span class="hljs-literal">false</span>
<span class="hljs-keyword">try</span> { <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"\uffff"</span>, <span class="hljs-string">"u"</span>); regexpUnicodeSupport = <span class="hljs-literal">true</span> }
<span class="hljs-keyword">catch</span>(e) {}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>Parse a regular expression. Some context-awareness is necessary,
since a '/' inside a '[]' set does not end the expression.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readRegexp = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> escaped, inClass, start = <span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">for</span> (;;) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos &gt;= <span class="hljs-keyword">this</span>.input.length) <span class="hljs-keyword">this</span>.raise(start, <span class="hljs-string">"Unterminated regular expression"</span>)
    <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.input.charAt(<span class="hljs-keyword">this</span>.pos)
    <span class="hljs-keyword">if</span> (lineBreak.test(ch)) <span class="hljs-keyword">this</span>.raise(start, <span class="hljs-string">"Unterminated regular expression"</span>)
    <span class="hljs-keyword">if</span> (!escaped) {
      <span class="hljs-keyword">if</span> (ch === <span class="hljs-string">"["</span>) inClass = <span class="hljs-literal">true</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-string">"]"</span> &amp;&amp; inClass) inClass = <span class="hljs-literal">false</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-string">"/"</span> &amp;&amp; !inClass) <span class="hljs-keyword">break</span>
      escaped = ch === <span class="hljs-string">"\\"</span>
    } <span class="hljs-keyword">else</span> escaped = <span class="hljs-literal">false</span>
    ++<span class="hljs-keyword">this</span>.pos
  }
  <span class="hljs-keyword">let</span> content = <span class="hljs-keyword">this</span>.input.slice(start, <span class="hljs-keyword">this</span>.pos)
  ++<span class="hljs-keyword">this</span>.pos
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>Need to use <code>readWord1</code> because '\uXXXX' sequences are allowed
here (don't ask).</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">let</span> mods = <span class="hljs-keyword">this</span>.readWord1()
  <span class="hljs-keyword">let</span> tmp = content
  <span class="hljs-keyword">if</span> (mods) {
    <span class="hljs-keyword">let</span> validFlags = <span class="hljs-regexp">/^[gmsiy]*$/</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span>) validFlags = <span class="hljs-regexp">/^[gmsiyu]*$/</span>
    <span class="hljs-keyword">if</span> (!validFlags.test(mods)) <span class="hljs-keyword">this</span>.raise(start, <span class="hljs-string">"Invalid regular expression flag"</span>)
    <span class="hljs-keyword">if</span> (mods.indexOf(<span class="hljs-string">'u'</span>) &gt;= <span class="hljs-number">0</span> &amp;&amp; !regexpUnicodeSupport) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>Replace each astral symbol and every Unicode escape sequence that
possibly represents an astral symbol or a paired surrogate with a
single ASCII symbol to avoid throwing on regular expressions that
are only valid in combination with the <code>/u</code> flag.
Note: replacing with the ASCII symbol <code>x</code> might cause false
negatives in unlikely scenarios. For example, <code>[\u{61}-b]</code> is a
perfectly valid pattern that is equivalent to <code>[a-b]</code>, but it would
be replaced by <code>[x-b]</code> which throws an error.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      tmp = tmp.replace(<span class="hljs-regexp">/\\u([a-fA-F0-9]{4})|\\u\{([0-9a-fA-F]+)\}|[\uD800-\uDBFF][\uDC00-\uDFFF]/g</span>, <span class="hljs-string">"x"</span>)
    }
  }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>Detect invalid regular expressions.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">let</span> value = <span class="hljs-literal">null</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>Rhino's regular expression parser is flaky and throws uncatchable exceptions,
so don't do detection if we are running under Rhino</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (!isRhino) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(tmp)
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">SyntaxError</span>) <span class="hljs-keyword">this</span>.raise(start, <span class="hljs-string">"Error parsing regular expression: "</span> + e.message)
      <span class="hljs-keyword">this</span>.raise(e)
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>Get a regular expression object for this pattern-flag pair, or <code>null</code> in
case the current environment doesn't support the flags it uses.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">try</span> {
      value = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(content, mods)
    } <span class="hljs-keyword">catch</span> (err) {}
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.regexp, {<span class="hljs-attr">pattern</span>: content, <span class="hljs-attr">flags</span>: mods, <span class="hljs-attr">value</span>: value})
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>Read an integer in the given radix. Return null if zero digits
were read, the integer value otherwise. When <code>len</code> is given, this
will return <code>null</code> unless the integer has exactly <code>len</code> digits.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readInt = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">radix, len</span>) </span>{
  <span class="hljs-keyword">let</span> start = <span class="hljs-keyword">this</span>.pos, total = <span class="hljs-number">0</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, e = len == <span class="hljs-literal">null</span> ? <span class="hljs-literal">Infinity</span> : len; i &lt; e; ++i) {
    <span class="hljs-keyword">let</span> code = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos), val
    <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">97</span>) val = code - <span class="hljs-number">97</span> + <span class="hljs-number">10</span>; <span class="hljs-comment">// a</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">65</span>) val = code - <span class="hljs-number">65</span> + <span class="hljs-number">10</span>; <span class="hljs-comment">// A</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (code &gt;= <span class="hljs-number">48</span> &amp;&amp; code &lt;= <span class="hljs-number">57</span>) val = code - <span class="hljs-number">48</span>; <span class="hljs-comment">// 0-9</span>
    <span class="hljs-keyword">else</span> val = <span class="hljs-literal">Infinity</span>
    <span class="hljs-keyword">if</span> (val &gt;= radix) <span class="hljs-keyword">break</span>
    ++<span class="hljs-keyword">this</span>.pos
    total = total * radix + val
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos === start || len != <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-keyword">this</span>.pos - start !== len) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>

  <span class="hljs-keyword">return</span> total
}

pp.readRadixNumber = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">radix</span>) </span>{
  <span class="hljs-keyword">this</span>.pos += <span class="hljs-number">2</span>; <span class="hljs-comment">// 0x</span>
  <span class="hljs-keyword">let</span> val = <span class="hljs-keyword">this</span>.readInt(radix)
  <span class="hljs-keyword">if</span> (val == <span class="hljs-literal">null</span>) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.start + <span class="hljs-number">2</span>, <span class="hljs-string">"Expected number in radix "</span> + radix)
  <span class="hljs-keyword">if</span> (isIdentifierStart(<span class="hljs-keyword">this</span>.fullCharCodeAtPos())) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.pos, <span class="hljs-string">"Identifier directly after number"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.num, val)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>Read an integer, octal integer, or floating-point number.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readNumber = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">startsWithDot</span>) </span>{
  <span class="hljs-keyword">let</span> start = <span class="hljs-keyword">this</span>.pos, isFloat = <span class="hljs-literal">false</span>, octal = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos) === <span class="hljs-number">48</span>
  <span class="hljs-keyword">if</span> (!startsWithDot &amp;&amp; <span class="hljs-keyword">this</span>.readInt(<span class="hljs-number">10</span>) === <span class="hljs-literal">null</span>) <span class="hljs-keyword">this</span>.raise(start, <span class="hljs-string">"Invalid number"</span>)
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos) === <span class="hljs-number">46</span>) {
    ++<span class="hljs-keyword">this</span>.pos
    <span class="hljs-keyword">this</span>.readInt(<span class="hljs-number">10</span>)
    isFloat = <span class="hljs-literal">true</span>
  }
  <span class="hljs-keyword">let</span> next = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos)
  <span class="hljs-keyword">if</span> (next === <span class="hljs-number">69</span> || next === <span class="hljs-number">101</span>) { <span class="hljs-comment">// 'eE'</span>
    next = <span class="hljs-keyword">this</span>.input.charCodeAt(++<span class="hljs-keyword">this</span>.pos)
    <span class="hljs-keyword">if</span> (next === <span class="hljs-number">43</span> || next === <span class="hljs-number">45</span>) ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-comment">// '+-'</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.readInt(<span class="hljs-number">10</span>) === <span class="hljs-literal">null</span>) <span class="hljs-keyword">this</span>.raise(start, <span class="hljs-string">"Invalid number"</span>)
    isFloat = <span class="hljs-literal">true</span>
  }
  <span class="hljs-keyword">if</span> (isIdentifierStart(<span class="hljs-keyword">this</span>.fullCharCodeAtPos())) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.pos, <span class="hljs-string">"Identifier directly after number"</span>)

  <span class="hljs-keyword">let</span> str = <span class="hljs-keyword">this</span>.input.slice(start, <span class="hljs-keyword">this</span>.pos), val
  <span class="hljs-keyword">if</span> (isFloat) val = <span class="hljs-built_in">parseFloat</span>(str)
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!octal || str.length === <span class="hljs-number">1</span>) val = <span class="hljs-built_in">parseInt</span>(str, <span class="hljs-number">10</span>)
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/[89]/</span>.test(str) || <span class="hljs-keyword">this</span>.strict) <span class="hljs-keyword">this</span>.raise(start, <span class="hljs-string">"Invalid number"</span>)
  <span class="hljs-keyword">else</span> val = <span class="hljs-built_in">parseInt</span>(str, <span class="hljs-number">8</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.num, val)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p>Read a string value, interpreting backslash-escapes.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readCodePoint = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos), code

  <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">123</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ecmaVersion &lt; <span class="hljs-number">6</span>) <span class="hljs-keyword">this</span>.unexpected()
    ++<span class="hljs-keyword">this</span>.pos
    code = <span class="hljs-keyword">this</span>.readHexChar(<span class="hljs-keyword">this</span>.input.indexOf(<span class="hljs-string">'}'</span>, <span class="hljs-keyword">this</span>.pos) - <span class="hljs-keyword">this</span>.pos)
    ++<span class="hljs-keyword">this</span>.pos
    <span class="hljs-keyword">if</span> (code &gt; <span class="hljs-number">0x10FFFF</span>) <span class="hljs-keyword">this</span>.unexpected()
  } <span class="hljs-keyword">else</span> {
    code = <span class="hljs-keyword">this</span>.readHexChar(<span class="hljs-number">4</span>)
  }
  <span class="hljs-keyword">return</span> code
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">codePointToString</span>(<span class="hljs-params">code</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>UTF-16 Decoding</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (code &lt;= <span class="hljs-number">0xFFFF</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(code)
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(((code - <span class="hljs-number">0x10000</span>) &gt;&gt; <span class="hljs-number">10</span>) + <span class="hljs-number">0xD800</span>,
                             ((code - <span class="hljs-number">0x10000</span>) &amp; <span class="hljs-number">1023</span>) + <span class="hljs-number">0xDC00</span>)
}

pp.readString = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">quote</span>) </span>{
  <span class="hljs-keyword">let</span> out = <span class="hljs-string">""</span>, chunkStart = ++<span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">for</span> (;;) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos &gt;= <span class="hljs-keyword">this</span>.input.length) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.start, <span class="hljs-string">"Unterminated string constant"</span>)
    <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos)
    <span class="hljs-keyword">if</span> (ch === quote) <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">92</span>) { <span class="hljs-comment">// '\'</span>
      out += <span class="hljs-keyword">this</span>.input.slice(chunkStart, <span class="hljs-keyword">this</span>.pos)
      out += <span class="hljs-keyword">this</span>.readEscapedChar()
      chunkStart = <span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (isNewLine(ch)) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.start, <span class="hljs-string">"Unterminated string constant"</span>)
      ++<span class="hljs-keyword">this</span>.pos
    }
  }
  out += <span class="hljs-keyword">this</span>.input.slice(chunkStart, <span class="hljs-keyword">this</span>.pos++)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.string, out)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>Reads template string tokens.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readTmplToken = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> out = <span class="hljs-string">""</span>, chunkStart = <span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">for</span> (;;) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos &gt;= <span class="hljs-keyword">this</span>.input.length) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.start, <span class="hljs-string">"Unterminated template"</span>)
    <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos)
    <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">96</span> || ch === <span class="hljs-number">36</span> &amp;&amp; <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos + <span class="hljs-number">1</span>) === <span class="hljs-number">123</span>) { <span class="hljs-comment">// '`', '${'</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos === <span class="hljs-keyword">this</span>.start &amp;&amp; <span class="hljs-keyword">this</span>.type === tt.template) {
        <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">36</span>) {
          <span class="hljs-keyword">this</span>.pos += <span class="hljs-number">2</span>
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.dollarBraceL)
        } <span class="hljs-keyword">else</span> {
          ++<span class="hljs-keyword">this</span>.pos
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.backQuote)
        }
      }
      out += <span class="hljs-keyword">this</span>.input.slice(chunkStart, <span class="hljs-keyword">this</span>.pos)
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(tt.template, out)
    }
    <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">92</span>) { <span class="hljs-comment">// '\'</span>
      out += <span class="hljs-keyword">this</span>.input.slice(chunkStart, <span class="hljs-keyword">this</span>.pos)
      out += <span class="hljs-keyword">this</span>.readEscapedChar()
      chunkStart = <span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isNewLine(ch)) {
      out += <span class="hljs-keyword">this</span>.input.slice(chunkStart, <span class="hljs-keyword">this</span>.pos)
      ++<span class="hljs-keyword">this</span>.pos
      <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">13</span> &amp;&amp; <span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos) === <span class="hljs-number">10</span>) {
        ++<span class="hljs-keyword">this</span>.pos
        out += <span class="hljs-string">"\n"</span>
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-built_in">String</span>.fromCharCode(ch)
      }
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) {
        ++<span class="hljs-keyword">this</span>.curLine
        <span class="hljs-keyword">this</span>.lineStart = <span class="hljs-keyword">this</span>.pos
      }
      chunkStart = <span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> {
      ++<span class="hljs-keyword">this</span>.pos
    }
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>Used to read escaped characters</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readEscapedChar = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.input.charCodeAt(++<span class="hljs-keyword">this</span>.pos)
  <span class="hljs-keyword">let</span> octal = <span class="hljs-regexp">/^[0-7]+/</span>.exec(<span class="hljs-keyword">this</span>.input.slice(<span class="hljs-keyword">this</span>.pos, <span class="hljs-keyword">this</span>.pos + <span class="hljs-number">3</span>))
  <span class="hljs-keyword">if</span> (octal) octal = octal[<span class="hljs-number">0</span>]
  <span class="hljs-keyword">while</span> (octal &amp;&amp; <span class="hljs-built_in">parseInt</span>(octal, <span class="hljs-number">8</span>) &gt; <span class="hljs-number">255</span>) octal = octal.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>)
  <span class="hljs-keyword">if</span> (octal === <span class="hljs-string">"0"</span>) octal = <span class="hljs-literal">null</span>
  ++<span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">if</span> (octal) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.strict) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.pos - <span class="hljs-number">2</span>, <span class="hljs-string">"Octal literal in strict mode"</span>)
    <span class="hljs-keyword">this</span>.pos += octal.length - <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(<span class="hljs-built_in">parseInt</span>(octal, <span class="hljs-number">8</span>))
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">switch</span> (ch) {
    <span class="hljs-keyword">case</span> <span class="hljs-number">110</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"\n"</span>; <span class="hljs-comment">// 'n' -&gt; '\n'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">114</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"\r"</span>; <span class="hljs-comment">// 'r' -&gt; '\r'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">120</span>: <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(<span class="hljs-keyword">this</span>.readHexChar(<span class="hljs-number">2</span>)); <span class="hljs-comment">// 'x'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">117</span>: <span class="hljs-keyword">return</span> codePointToString(<span class="hljs-keyword">this</span>.readCodePoint()); <span class="hljs-comment">// 'u'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">116</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"\t"</span>; <span class="hljs-comment">// 't' -&gt; '\t'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">98</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"\b"</span>; <span class="hljs-comment">// 'b' -&gt; '\b'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">118</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"\u000b"</span>; <span class="hljs-comment">// 'v' -&gt; '\u000b'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">102</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"\f"</span>; <span class="hljs-comment">// 'f' -&gt; '\f'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">48</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">"\0"</span>; <span class="hljs-comment">// 0 -&gt; '\0'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">13</span>: <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.input.charCodeAt(<span class="hljs-keyword">this</span>.pos) === <span class="hljs-number">10</span>) ++<span class="hljs-keyword">this</span>.pos; <span class="hljs-comment">// '\r\n'</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">10</span>: <span class="hljs-comment">// ' \n'</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations) { <span class="hljs-keyword">this</span>.lineStart = <span class="hljs-keyword">this</span>.pos; ++<span class="hljs-keyword">this</span>.curLine }
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>
    <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode(ch)
    }
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>Used to read character escape sequences ('\x', '\u', '\U').</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readHexChar = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">len</span>) </span>{
  <span class="hljs-keyword">let</span> n = <span class="hljs-keyword">this</span>.readInt(<span class="hljs-number">16</span>, len)
  <span class="hljs-keyword">if</span> (n === <span class="hljs-literal">null</span>) <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.start, <span class="hljs-string">"Bad character escape sequence"</span>)
  <span class="hljs-keyword">return</span> n
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>Used to signal to callers of <code>readWord1</code> whether the word
contained any escape sequences. This is needed because words with
escape sequences must not be interpreted as keywords.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> containsEsc

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<p>Read an identifier, and return it as a string. Sets <code>containsEsc</code>
to whether the word contained a '\u' escape.</p>
<p>Incrementally adds only escaped chars, adding other chunks as-is
as a micro-optimization.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readWord1 = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  containsEsc = <span class="hljs-literal">false</span>
  <span class="hljs-keyword">let</span> word = <span class="hljs-string">""</span>, first = <span class="hljs-literal">true</span>, chunkStart = <span class="hljs-keyword">this</span>.pos
  <span class="hljs-keyword">let</span> astral = <span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span>
  <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.pos &lt; <span class="hljs-keyword">this</span>.input.length) {
    <span class="hljs-keyword">let</span> ch = <span class="hljs-keyword">this</span>.fullCharCodeAtPos()
    <span class="hljs-keyword">if</span> (isIdentifierChar(ch, astral)) {
      <span class="hljs-keyword">this</span>.pos += ch &lt;= <span class="hljs-number">0xffff</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ch === <span class="hljs-number">92</span>) { <span class="hljs-comment">// "\"</span>
      containsEsc = <span class="hljs-literal">true</span>
      word += <span class="hljs-keyword">this</span>.input.slice(chunkStart, <span class="hljs-keyword">this</span>.pos)
      <span class="hljs-keyword">let</span> escStart = <span class="hljs-keyword">this</span>.pos
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.input.charCodeAt(++<span class="hljs-keyword">this</span>.pos) != <span class="hljs-number">117</span>) <span class="hljs-comment">// "u"</span>
        <span class="hljs-keyword">this</span>.raise(<span class="hljs-keyword">this</span>.pos, <span class="hljs-string">"Expecting Unicode escape sequence \\uXXXX"</span>)
      ++<span class="hljs-keyword">this</span>.pos
      <span class="hljs-keyword">let</span> esc = <span class="hljs-keyword">this</span>.readCodePoint()
      <span class="hljs-keyword">if</span> (!(first ? isIdentifierStart : isIdentifierChar)(esc, astral))
        <span class="hljs-keyword">this</span>.raise(escStart, <span class="hljs-string">"Invalid Unicode escape"</span>)
      word += codePointToString(esc)
      chunkStart = <span class="hljs-keyword">this</span>.pos
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">break</span>
    }
    first = <span class="hljs-literal">false</span>
  }
  <span class="hljs-keyword">return</span> word + <span class="hljs-keyword">this</span>.input.slice(chunkStart, <span class="hljs-keyword">this</span>.pos)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>Read an identifier or keyword token. Will check for reserved
words when necessary.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.readWord = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> word = <span class="hljs-keyword">this</span>.readWord1()
  <span class="hljs-keyword">let</span> type = tt.name
  <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span> || !containsEsc) &amp;&amp; <span class="hljs-keyword">this</span>.isKeyword(word))
    type = keywordTypes[word]
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishToken(type, word)
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
