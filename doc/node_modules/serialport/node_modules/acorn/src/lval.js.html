<!DOCTYPE html>
<html>
<head>
  <title>lval.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/acorn/src/lval.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>lval.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> {types <span class="hljs-keyword">as</span> tt} <span class="hljs-keyword">from</span> <span class="hljs-string">"./tokentype"</span>
<span class="hljs-keyword">import</span> {Parser} <span class="hljs-keyword">from</span> <span class="hljs-string">"./state"</span>
<span class="hljs-keyword">import</span> {reservedWords} <span class="hljs-keyword">from</span> <span class="hljs-string">"./identifier"</span>
<span class="hljs-keyword">import</span> {has} <span class="hljs-keyword">from</span> <span class="hljs-string">"./util"</span>

<span class="hljs-keyword">const</span> pp = Parser.prototype

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Convert existing expression atom to assignable pattern
if possible.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.toAssignable = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">node, isBinding</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ecmaVersion &gt;= <span class="hljs-number">6</span> &amp;&amp; node) {
    <span class="hljs-keyword">switch</span> (node.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"Identifier"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ObjectPattern"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ArrayPattern"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"AssignmentPattern"</span>:
      <span class="hljs-keyword">break</span>

    <span class="hljs-keyword">case</span> <span class="hljs-string">"ObjectExpression"</span>:
      node.type = <span class="hljs-string">"ObjectPattern"</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; node.properties.length; i++) {
        <span class="hljs-keyword">let</span> prop = node.properties[i]
        <span class="hljs-keyword">if</span> (prop.kind !== <span class="hljs-string">"init"</span>) <span class="hljs-keyword">this</span>.raise(prop.key.start, <span class="hljs-string">"Object pattern can't contain getter or setter"</span>)
        <span class="hljs-keyword">this</span>.toAssignable(prop.value, isBinding)
      }
      <span class="hljs-keyword">break</span>

    <span class="hljs-keyword">case</span> <span class="hljs-string">"ArrayExpression"</span>:
      node.type = <span class="hljs-string">"ArrayPattern"</span>
      <span class="hljs-keyword">this</span>.toAssignableList(node.elements, isBinding)
      <span class="hljs-keyword">break</span>

    <span class="hljs-keyword">case</span> <span class="hljs-string">"AssignmentExpression"</span>:
      <span class="hljs-keyword">if</span> (node.operator === <span class="hljs-string">"="</span>) {
        node.type = <span class="hljs-string">"AssignmentPattern"</span>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.raise(node.left.end, <span class="hljs-string">"Only '=' operator can be used for specifying default value."</span>)
      }
      <span class="hljs-keyword">break</span>

    <span class="hljs-keyword">case</span> <span class="hljs-string">"ParenthesizedExpression"</span>:
      node.expression = <span class="hljs-keyword">this</span>.toAssignable(node.expression, isBinding)
      <span class="hljs-keyword">break</span>

    <span class="hljs-keyword">case</span> <span class="hljs-string">"MemberExpression"</span>:
      <span class="hljs-keyword">if</span> (!isBinding) <span class="hljs-keyword">break</span>

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">this</span>.raise(node.start, <span class="hljs-string">"Assigning to rvalue"</span>)
    }
  }
  <span class="hljs-keyword">return</span> node
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Convert list of expression atoms to binding list.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.toAssignableList = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exprList, isBinding</span>) </span>{
  <span class="hljs-keyword">let</span> end = exprList.length
  <span class="hljs-keyword">if</span> (end) {
    <span class="hljs-keyword">let</span> last = exprList[end - <span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> (last &amp;&amp; last.type == <span class="hljs-string">"RestElement"</span>) {
      --end
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (last &amp;&amp; last.type == <span class="hljs-string">"SpreadElement"</span>) {
      last.type = <span class="hljs-string">"RestElement"</span>
      <span class="hljs-keyword">let</span> arg = last.argument
      <span class="hljs-keyword">this</span>.toAssignable(arg, isBinding)
      <span class="hljs-keyword">if</span> (arg.type !== <span class="hljs-string">"Identifier"</span> &amp;&amp; arg.type !== <span class="hljs-string">"MemberExpression"</span> &amp;&amp; arg.type !== <span class="hljs-string">"ArrayPattern"</span>)
        <span class="hljs-keyword">this</span>.unexpected(arg.start)
      --end
    }
  }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; end; i++) {
    <span class="hljs-keyword">let</span> elt = exprList[i]
    <span class="hljs-keyword">if</span> (elt) <span class="hljs-keyword">this</span>.toAssignable(elt, isBinding)
  }
  <span class="hljs-keyword">return</span> exprList
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Parses spread element.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.parseSpread = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">refShorthandDefaultPos</span>) </span>{
  <span class="hljs-keyword">let</span> node = <span class="hljs-keyword">this</span>.startNode()
  <span class="hljs-keyword">this</span>.next()
  node.argument = <span class="hljs-keyword">this</span>.parseMaybeAssign(refShorthandDefaultPos)
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishNode(node, <span class="hljs-string">"SpreadElement"</span>)
}

pp.parseRest = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> node = <span class="hljs-keyword">this</span>.startNode()
  <span class="hljs-keyword">this</span>.next()
  node.argument = <span class="hljs-keyword">this</span>.type === tt.name || <span class="hljs-keyword">this</span>.type === tt.bracketL ? <span class="hljs-keyword">this</span>.parseBindingAtom() : <span class="hljs-keyword">this</span>.unexpected()
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishNode(node, <span class="hljs-string">"RestElement"</span>)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Parses lvalue (assignable) atom.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.parseBindingAtom = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ecmaVersion &lt; <span class="hljs-number">6</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.parseIdent()
  <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>.type) {
  <span class="hljs-keyword">case</span> tt.name:
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.parseIdent()

  <span class="hljs-keyword">case</span> tt.bracketL:
    <span class="hljs-keyword">let</span> node = <span class="hljs-keyword">this</span>.startNode()
    <span class="hljs-keyword">this</span>.next()
    node.elements = <span class="hljs-keyword">this</span>.parseBindingList(tt.bracketR, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishNode(node, <span class="hljs-string">"ArrayPattern"</span>)

  <span class="hljs-keyword">case</span> tt.braceL:
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.parseObj(<span class="hljs-literal">true</span>)

  <span class="hljs-keyword">default</span>:
    <span class="hljs-keyword">this</span>.unexpected()
  }
}

pp.parseBindingList = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">close, allowEmpty, allowTrailingComma</span>) </span>{
  <span class="hljs-keyword">let</span> elts = [], first = <span class="hljs-literal">true</span>
  <span class="hljs-keyword">while</span> (!<span class="hljs-keyword">this</span>.eat(close)) {
    <span class="hljs-keyword">if</span> (first) first = <span class="hljs-literal">false</span>
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span>.expect(tt.comma)
    <span class="hljs-keyword">if</span> (allowEmpty &amp;&amp; <span class="hljs-keyword">this</span>.type === tt.comma) {
      elts.push(<span class="hljs-literal">null</span>)
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (allowTrailingComma &amp;&amp; <span class="hljs-keyword">this</span>.afterTrailingComma(close)) {
      <span class="hljs-keyword">break</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.type === tt.ellipsis) {
      <span class="hljs-keyword">let</span> rest = <span class="hljs-keyword">this</span>.parseRest()
      <span class="hljs-keyword">this</span>.parseBindingListItem(rest)
      elts.push(rest)
      <span class="hljs-keyword">this</span>.expect(close)
      <span class="hljs-keyword">break</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">let</span> elem = <span class="hljs-keyword">this</span>.parseMaybeDefault(<span class="hljs-keyword">this</span>.start, <span class="hljs-keyword">this</span>.startLoc)
      <span class="hljs-keyword">this</span>.parseBindingListItem(elem)
      elts.push(elem)
    }
  }
  <span class="hljs-keyword">return</span> elts
}

pp.parseBindingListItem = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">param</span>) </span>{
  <span class="hljs-keyword">return</span> param
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Parses assignment pattern around given atom if possible.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.parseMaybeDefault = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">startPos, startLoc, left</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(startPos)){
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.locations &amp;&amp; noCalls === <span class="hljs-literal">undefined</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>shift arguments to left by one</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      left = startLoc
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>flatten startPos</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      startLoc = startPos[<span class="hljs-number">1</span>]
      startPos = startPos[<span class="hljs-number">0</span>]
    }
  }
  left = left || <span class="hljs-keyword">this</span>.parseBindingAtom()
  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.eat(tt.eq)) <span class="hljs-keyword">return</span> left
  <span class="hljs-keyword">let</span> node = <span class="hljs-keyword">this</span>.startNodeAt(startPos, startLoc)
  node.operator = <span class="hljs-string">"="</span>
  node.left = left
  node.right = <span class="hljs-keyword">this</span>.parseMaybeAssign()
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.finishNode(node, <span class="hljs-string">"AssignmentPattern"</span>)
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Verify that a node is an lval — something that can be assigned
to.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
pp.checkLVal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">expr, isBinding, checkClashes</span>) </span>{
  <span class="hljs-keyword">switch</span> (expr.type) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">"Identifier"</span>:
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.strict &amp;&amp; (reservedWords.strictBind(expr.name) || reservedWords.strict(expr.name)))
      <span class="hljs-keyword">this</span>.raise(expr.start, (isBinding ? <span class="hljs-string">"Binding "</span> : <span class="hljs-string">"Assigning to "</span>) + expr.name + <span class="hljs-string">" in strict mode"</span>)
    <span class="hljs-keyword">if</span> (checkClashes) {
      <span class="hljs-keyword">if</span> (has(checkClashes, expr.name))
        <span class="hljs-keyword">this</span>.raise(expr.start, <span class="hljs-string">"Argument name clash in strict mode"</span>)
      checkClashes[expr.name] = <span class="hljs-literal">true</span>
    }
    <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">case</span> <span class="hljs-string">"MemberExpression"</span>:
    <span class="hljs-keyword">if</span> (isBinding) <span class="hljs-keyword">this</span>.raise(expr.start, (isBinding ? <span class="hljs-string">"Binding"</span> : <span class="hljs-string">"Assigning to"</span>) + <span class="hljs-string">" member expression"</span>)
    <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">case</span> <span class="hljs-string">"ObjectPattern"</span>:
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; expr.properties.length; i++)
      <span class="hljs-keyword">this</span>.checkLVal(expr.properties[i].value, isBinding, checkClashes)
    <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">case</span> <span class="hljs-string">"ArrayPattern"</span>:
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; expr.elements.length; i++) {
      <span class="hljs-keyword">let</span> elem = expr.elements[i]
      <span class="hljs-keyword">if</span> (elem) <span class="hljs-keyword">this</span>.checkLVal(elem, isBinding, checkClashes)
    }
    <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">case</span> <span class="hljs-string">"AssignmentPattern"</span>:
    <span class="hljs-keyword">this</span>.checkLVal(expr.left, isBinding, checkClashes)
    <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">case</span> <span class="hljs-string">"RestElement"</span>:
    <span class="hljs-keyword">this</span>.checkLVal(expr.argument, isBinding, checkClashes)
    <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">case</span> <span class="hljs-string">"ParenthesizedExpression"</span>:
    <span class="hljs-keyword">this</span>.checkLVal(expr.expression, isBinding, checkClashes)
    <span class="hljs-keyword">break</span>

  <span class="hljs-keyword">default</span>:
    <span class="hljs-keyword">this</span>.raise(expr.start, (isBinding ? <span class="hljs-string">"Binding"</span> : <span class="hljs-string">"Assigning to"</span>) + <span class="hljs-string">" rvalue"</span>)
  }
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
