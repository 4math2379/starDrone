<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/hoek/test/index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<p>Load modules</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> Fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">var</span> Path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> Code = <span class="hljs-built_in">require</span>(<span class="hljs-string">'code'</span>);
<span class="hljs-keyword">var</span> Hoek = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../lib'</span>);
<span class="hljs-keyword">var</span> Lab = <span class="hljs-built_in">require</span>(<span class="hljs-string">'lab'</span>);


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Declare internals</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> internals = {};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Test shortcuts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> lab = exports.lab = Lab.script();
<span class="hljs-keyword">var</span> describe = lab.experiment;
<span class="hljs-keyword">var</span> it = lab.test;
<span class="hljs-keyword">var</span> expect = Code.expect;


<span class="hljs-keyword">var</span> nestedObj = {
    <span class="hljs-attr">v</span>: [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>],
    <span class="hljs-attr">w</span>: <span class="hljs-regexp">/^something$/igm</span>,
    <span class="hljs-attr">x</span>: {
        <span class="hljs-attr">a</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
        <span class="hljs-attr">b</span>: <span class="hljs-number">123456</span>,
        <span class="hljs-attr">c</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),
        <span class="hljs-attr">d</span>: <span class="hljs-regexp">/hi/igm</span>,
        <span class="hljs-attr">e</span>: <span class="hljs-regexp">/hello/</span>
    },
    <span class="hljs-attr">y</span>: <span class="hljs-string">'y'</span>,
    <span class="hljs-attr">z</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">1378775452757</span>)
};

<span class="hljs-keyword">var</span> dupsArray = [nestedObj, { <span class="hljs-attr">z</span>: <span class="hljs-string">'z'</span> }, nestedObj];
<span class="hljs-keyword">var</span> reducedDupsArray = [nestedObj, { <span class="hljs-attr">z</span>: <span class="hljs-string">'z'</span> }];

describe(<span class="hljs-string">'clone()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'clones a nested object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = nestedObj;
        <span class="hljs-keyword">var</span> b = Hoek.clone(a);

        expect(a).to.deep.equal(b);
        expect(a.z.getTime()).to.equal(b.z.getTime());
        done();
    });

    it(<span class="hljs-string">'clones a null object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> b = Hoek.clone(<span class="hljs-literal">null</span>);

        expect(b).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'should not convert undefined properties to null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = { <span class="hljs-attr">something</span>: <span class="hljs-literal">undefined</span> };
        <span class="hljs-keyword">var</span> b = Hoek.clone(obj);

        expect(<span class="hljs-keyword">typeof</span> b.something).to.equal(<span class="hljs-string">'undefined'</span>);
        done();
    });

    it(<span class="hljs-string">'should not throw on circular reference'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {};
        a.x = a;

        <span class="hljs-keyword">var</span> test = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> b = Hoek.clone(a);
        };

        expect(test).to.not.throw();
        done();
    });

    it(<span class="hljs-string">'clones circular reference'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> x = {
            <span class="hljs-string">'z'</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()
        };
        x.y = x;

        <span class="hljs-keyword">var</span> b = Hoek.clone(x);
        expect(<span class="hljs-built_in">Object</span>.keys(b.y)).to.deep.equal(<span class="hljs-built_in">Object</span>.keys(x));
        expect(b.z).to.not.equal(x.z);
        expect(b.y).to.not.equal(x.y);
        expect(b.y.z).to.not.equal(x.y.z);
        expect(b.y).to.equal(b);
        expect(b.y.y.y.y).to.equal(b);
        done();
    });

    it(<span class="hljs-string">'clones an object with a null prototype'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">var</span> b = Hoek.clone(obj);

        expect(b).to.deep.equal(obj);
        done();
    });

    it(<span class="hljs-string">'clones deeply nested object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {
            <span class="hljs-attr">x</span>: {
                <span class="hljs-attr">y</span>: {
                    <span class="hljs-attr">a</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
                    <span class="hljs-attr">b</span>: <span class="hljs-number">123456</span>,
                    <span class="hljs-attr">c</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),
                    <span class="hljs-attr">d</span>: <span class="hljs-regexp">/hi/igm</span>,
                    <span class="hljs-attr">e</span>: <span class="hljs-regexp">/hello/</span>
                }
            }
        };

        <span class="hljs-keyword">var</span> b = Hoek.clone(a);

        expect(a).to.deep.equal(b);
        expect(a.x.y.c.getTime()).to.equal(b.x.y.c.getTime());
        done();
    });

    it(<span class="hljs-string">'clones arrays'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

        <span class="hljs-keyword">var</span> b = Hoek.clone(a);

        expect(a).to.deep.equal(b);
        done();
    });

    it(<span class="hljs-string">'performs actual copy for shallow keys (no pass by reference)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> x = Hoek.clone(nestedObj);
        <span class="hljs-keyword">var</span> y = Hoek.clone(nestedObj);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Date</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        expect(x.z).to.not.equal(nestedObj.z);
        expect(x.z).to.not.equal(y.z);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Regex</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        expect(x.w).to.not.equal(nestedObj.w);
        expect(x.w).to.not.equal(y.w);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        expect(x.v).to.not.equal(nestedObj.v);
        expect(x.v).to.not.equal(y.v);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Immutable(s)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        x.y = <span class="hljs-number">5</span>;
        expect(x.y).to.not.equal(nestedObj.y);
        expect(x.y).to.not.equal(y.y);

        done();
    });

    it(<span class="hljs-string">'performs actual copy for deep keys (no pass by reference)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> x = Hoek.clone(nestedObj);
        <span class="hljs-keyword">var</span> y = Hoek.clone(nestedObj);

        expect(x.x.c).to.not.equal(nestedObj.x.c);
        expect(x.x.c).to.not.equal(y.x.c);

        expect(x.x.c.getTime()).to.equal(nestedObj.x.c.getTime());
        expect(x.x.c.getTime()).to.equal(y.x.c.getTime());
        done();
    });

    it(<span class="hljs-string">'copies functions with properties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {
            <span class="hljs-attr">x</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            },
            <span class="hljs-attr">y</span>: {}
        };
        a.x.z = <span class="hljs-string">'string in function'</span>;
        a.x.v = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;
        };
        a.y.u = a.x;

        <span class="hljs-keyword">var</span> b = Hoek.clone(a);
        expect(b.x()).to.equal(<span class="hljs-number">1</span>);
        expect(b.x.v()).to.equal(<span class="hljs-number">2</span>);
        expect(b.y.u).to.equal(b.x);
        expect(b.x.z).to.equal(<span class="hljs-string">'string in function'</span>);
        done();
    });

    it(<span class="hljs-string">'should copy a buffer'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> tls = {
            <span class="hljs-attr">key</span>: <span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]),
            <span class="hljs-attr">cert</span>: <span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">10</span>])
        };

        <span class="hljs-keyword">var</span> copiedTls = Hoek.clone(tls);
        expect(Buffer.isBuffer(copiedTls.key)).to.equal(<span class="hljs-literal">true</span>);
        expect(<span class="hljs-built_in">JSON</span>.stringify(copiedTls.key)).to.equal(<span class="hljs-built_in">JSON</span>.stringify(tls.key));
        expect(Buffer.isBuffer(copiedTls.cert)).to.equal(<span class="hljs-literal">true</span>);
        expect(<span class="hljs-built_in">JSON</span>.stringify(copiedTls.cert)).to.equal(<span class="hljs-built_in">JSON</span>.stringify(tls.cert));
        done();
    });

    it(<span class="hljs-string">'clones an object with a prototype'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> Obj = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">this</span>.a = <span class="hljs-number">5</span>;
        };

        Obj.prototype.b = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> <span class="hljs-string">'c'</span>;
        };

        <span class="hljs-keyword">var</span> a = <span class="hljs-keyword">new</span> Obj();
        <span class="hljs-keyword">var</span> b = Hoek.clone(a);

        expect(b.a).to.equal(<span class="hljs-number">5</span>);
        expect(b.b()).to.equal(<span class="hljs-string">'c'</span>);
        expect(a).to.deep.equal(b);
        done();
    });

    it(<span class="hljs-string">'reuses cloned Date object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()
        };

        obj.b = obj.a;

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);
        expect(copy.a).to.equal(copy.b);
        done();
    });

    it(<span class="hljs-string">'shallow copies an object with a prototype and isImmutable flag'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> Obj = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">this</span>.value = <span class="hljs-number">5</span>;
        };

        Obj.prototype.b = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> <span class="hljs-string">'c'</span>;
        };

        Obj.prototype.isImmutable = <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Obj()
        };

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);

        expect(obj.a.value).to.equal(<span class="hljs-number">5</span>);
        expect(copy.a.value).to.equal(<span class="hljs-number">5</span>);
        expect(copy.a.b()).to.equal(<span class="hljs-string">'c'</span>);
        expect(obj.a).to.equal(copy.a);
        done();
    });

    it(<span class="hljs-string">'clones an object with property getter without executing it'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {};
        <span class="hljs-keyword">var</span> value = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">var</span> execCount = <span class="hljs-number">0</span>;

        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">'test'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                ++execCount;
                <span class="hljs-keyword">return</span> value;
            }
        });

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);
        expect(execCount).to.equal(<span class="hljs-number">0</span>);
        expect(copy.test).to.equal(<span class="hljs-number">1</span>);
        expect(execCount).to.equal(<span class="hljs-number">1</span>);
        done();
    });

    it(<span class="hljs-string">'clones an object with property getter and setter'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">_test</span>: <span class="hljs-number">0</span>
        };

        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">'test'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._test;
            },
            <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{

                <span class="hljs-keyword">this</span>._test = value - <span class="hljs-number">1</span>;
            }
        });

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);
        expect(copy.test).to.equal(<span class="hljs-number">0</span>);
        copy.test = <span class="hljs-number">5</span>;
        expect(copy.test).to.equal(<span class="hljs-number">4</span>);
        done();
    });

    it(<span class="hljs-string">'clones an object with only property setter'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">_test</span>: <span class="hljs-number">0</span>
        };

        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">'test'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{

                <span class="hljs-keyword">this</span>._test = value - <span class="hljs-number">1</span>;
            }
        });

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);
        expect(copy._test).to.equal(<span class="hljs-number">0</span>);
        copy.test = <span class="hljs-number">5</span>;
        expect(copy._test).to.equal(<span class="hljs-number">4</span>);
        done();
    });

    it(<span class="hljs-string">'clones an object with non-enumerable properties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">_test</span>: <span class="hljs-number">0</span>
        };

        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">'test'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">set</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{

                <span class="hljs-keyword">this</span>._test = value - <span class="hljs-number">1</span>;
            }
        });

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);
        expect(copy._test).to.equal(<span class="hljs-number">0</span>);
        copy.test = <span class="hljs-number">5</span>;
        expect(copy._test).to.equal(<span class="hljs-number">4</span>);
        done();
    });

    it(<span class="hljs-string">'clones an object where getOwnPropertyDescriptor returns undefined'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> oldGetOwnPropertyDescriptor = <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor;
        <span class="hljs-keyword">var</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-string">'b'</span> };
        <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;
        };

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);
        <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor = oldGetOwnPropertyDescriptor;
        expect(copy).to.deep.equal(obj);
        done();
    });
});

describe(<span class="hljs-string">'merge()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'deep copies source items'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> target = {
            <span class="hljs-attr">b</span>: <span class="hljs-number">3</span>,
            <span class="hljs-attr">d</span>: []
        };

        <span class="hljs-keyword">var</span> source = {
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">d</span>: <span class="hljs-number">1</span>
            },
            <span class="hljs-attr">d</span>: [{ <span class="hljs-attr">e</span>: <span class="hljs-number">1</span> }]
        };

        Hoek.merge(target, source);
        expect(target.c).to.not.equal(source.c);
        expect(target.c).to.deep.equal(source.c);
        expect(target.d).to.not.equal(source.d);
        expect(target.d[<span class="hljs-number">0</span>]).to.not.equal(source.d[<span class="hljs-number">0</span>]);
        expect(target.d).to.deep.equal(source.d);
        done();
    });

    it(<span class="hljs-string">'merges array over an object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {
            <span class="hljs-attr">x</span>: [<span class="hljs-string">'n'</span>, <span class="hljs-string">'m'</span>]
        };

        <span class="hljs-keyword">var</span> b = {
            <span class="hljs-attr">x</span>: {
                <span class="hljs-attr">n</span>: <span class="hljs-string">'1'</span>,
                <span class="hljs-attr">m</span>: <span class="hljs-string">'2'</span>
            }
        };

        Hoek.merge(b, a);
        expect(a.x[<span class="hljs-number">0</span>]).to.equal(<span class="hljs-string">'n'</span>);
        expect(a.x.n).to.not.exist();
        done();
    });

    it(<span class="hljs-string">'merges object over an array'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {
            <span class="hljs-attr">x</span>: [<span class="hljs-string">'n'</span>, <span class="hljs-string">'m'</span>]
        };

        <span class="hljs-keyword">var</span> b = {
            <span class="hljs-attr">x</span>: {
                <span class="hljs-attr">n</span>: <span class="hljs-string">'1'</span>,
                <span class="hljs-attr">m</span>: <span class="hljs-string">'2'</span>
            }
        };

        Hoek.merge(a, b);
        expect(a.x.n).to.equal(<span class="hljs-string">'1'</span>);
        expect(a.x[<span class="hljs-number">0</span>]).to.not.exist();
        done();
    });

    it(<span class="hljs-string">'does not throw if source is null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {};
        <span class="hljs-keyword">var</span> b = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> c = <span class="hljs-literal">null</span>;

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            c = Hoek.merge(a, b);
        }).to.not.throw();

        expect(c).to.equal(a);
        done();
    });

    it(<span class="hljs-string">'does not throw if source is undefined'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {};
        <span class="hljs-keyword">var</span> b;
        <span class="hljs-keyword">var</span> c = <span class="hljs-literal">null</span>;

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            c = Hoek.merge(a, b);
        }).to.not.throw();

        expect(c).to.equal(a);
        done();
    });

    it(<span class="hljs-string">'throws if source is not an object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> a = {};
            <span class="hljs-keyword">var</span> b = <span class="hljs-number">0</span>;

            Hoek.merge(a, b);
        }).to.throw(<span class="hljs-string">'Invalid source value: must be null, undefined, or an object'</span>);
        done();
    });

    it(<span class="hljs-string">'throws if target is not an object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">var</span> b = {};

            Hoek.merge(a, b);
        }).to.throw(<span class="hljs-string">'Invalid target value: must be an object'</span>);
        done();
    });

    it(<span class="hljs-string">'throws if target is not an array and source is'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> a = {};
            <span class="hljs-keyword">var</span> b = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>];

            Hoek.merge(a, b);
        }).to.throw(<span class="hljs-string">'Cannot merge array onto an object'</span>);
        done();
    });

    it(<span class="hljs-string">'returns the same object when merging arrays'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = [];
        <span class="hljs-keyword">var</span> b = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>];

        expect(Hoek.merge(a, b)).to.equal(a);
        done();
    });

    it(<span class="hljs-string">'combines an empty object with a non-empty object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {};
        <span class="hljs-keyword">var</span> b = nestedObj;

        <span class="hljs-keyword">var</span> c = Hoek.merge(a, b);
        expect(a).to.deep.equal(b);
        expect(c).to.deep.equal(b);
        done();
    });

    it(<span class="hljs-string">'overrides values in target'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = { <span class="hljs-attr">x</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">v</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">t</span>: <span class="hljs-string">'test'</span>, <span class="hljs-attr">m</span>: <span class="hljs-string">'abc'</span> };
        <span class="hljs-keyword">var</span> b = { <span class="hljs-attr">x</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">v</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">t</span>: { <span class="hljs-attr">u</span>: <span class="hljs-number">6</span> }, <span class="hljs-attr">m</span>: <span class="hljs-string">'123'</span> };

        <span class="hljs-keyword">var</span> c = Hoek.merge(a, b);
        expect(c.x).to.equal(<span class="hljs-literal">null</span>);
        expect(c.y).to.equal(<span class="hljs-number">2</span>);
        expect(c.z).to.equal(<span class="hljs-number">4</span>);
        expect(c.v).to.equal(<span class="hljs-number">0</span>);
        expect(c.m).to.equal(<span class="hljs-string">'123'</span>);
        expect(c.t).to.deep.equal({ <span class="hljs-attr">u</span>: <span class="hljs-number">6</span> });
        done();
    });

    it(<span class="hljs-string">'overrides values in target (flip)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = { <span class="hljs-attr">x</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">v</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">t</span>: <span class="hljs-string">'test'</span>, <span class="hljs-attr">m</span>: <span class="hljs-string">'abc'</span> };
        <span class="hljs-keyword">var</span> b = { <span class="hljs-attr">x</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">v</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">t</span>: { <span class="hljs-attr">u</span>: <span class="hljs-number">6</span> }, <span class="hljs-attr">m</span>: <span class="hljs-string">'123'</span> };

        <span class="hljs-keyword">var</span> d = Hoek.merge(b, a);
        expect(d.x).to.equal(<span class="hljs-number">1</span>);
        expect(d.y).to.equal(<span class="hljs-number">2</span>);
        expect(d.z).to.equal(<span class="hljs-number">3</span>);
        expect(d.v).to.equal(<span class="hljs-number">5</span>);
        expect(d.m).to.equal(<span class="hljs-string">'abc'</span>);
        expect(d.t).to.deep.equal(<span class="hljs-string">'test'</span>);
        done();
    });

    it(<span class="hljs-string">'retains Date properties'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = { <span class="hljs-attr">x</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">1378776452757</span>) };

        <span class="hljs-keyword">var</span> b = Hoek.merge({}, a);
        expect(a.x.getTime()).to.equal(b.x.getTime());
        done();
    });

    it(<span class="hljs-string">'retains Date properties when merging keys'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = { <span class="hljs-attr">x</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">1378776452757</span>) };

        <span class="hljs-keyword">var</span> b = Hoek.merge({ <span class="hljs-attr">x</span>: {} }, a);
        expect(a.x.getTime()).to.equal(b.x.getTime());
        done();
    });

    it(<span class="hljs-string">'overrides Buffer'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = { <span class="hljs-attr">x</span>: <span class="hljs-keyword">new</span> Buffer(<span class="hljs-string">'abc'</span>) };

        <span class="hljs-keyword">var</span> b = Hoek.merge({ <span class="hljs-attr">x</span>: {} }, a);
        expect(a.x.toString()).to.equal(<span class="hljs-string">'abc'</span>);
        done();
    });
});

describe(<span class="hljs-string">'applyToDefaults()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">var</span> defaults = {
        <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>,
        <span class="hljs-attr">c</span>: {
            <span class="hljs-attr">d</span>: <span class="hljs-number">3</span>,
            <span class="hljs-attr">e</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>]
        },
        <span class="hljs-attr">f</span>: <span class="hljs-number">6</span>,
        <span class="hljs-attr">g</span>: <span class="hljs-string">'test'</span>
    };

    it(<span class="hljs-string">'throws when target is null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.applyToDefaults(<span class="hljs-literal">null</span>, {});
        }).to.throw(<span class="hljs-string">'Invalid defaults value: must be an object'</span>);
        done();
    });

    it(<span class="hljs-string">'returns null if options is false'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.applyToDefaults(defaults, <span class="hljs-literal">false</span>);
        expect(result).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'returns null if options is null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.applyToDefaults(defaults, <span class="hljs-literal">null</span>);
        expect(result).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'returns null if options is undefined'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.applyToDefaults(defaults, <span class="hljs-literal">undefined</span>);
        expect(result).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'returns a copy of defaults if options is true'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.applyToDefaults(defaults, <span class="hljs-literal">true</span>);
        expect(result).to.deep.equal(defaults);
        done();
    });

    it(<span class="hljs-string">'applies object to defaults'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">a</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">e</span>: [<span class="hljs-number">4</span>]
            },
            <span class="hljs-attr">f</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">g</span>: {
                <span class="hljs-attr">h</span>: <span class="hljs-number">5</span>
            }
        };

        <span class="hljs-keyword">var</span> result = Hoek.applyToDefaults(defaults, obj);
        expect(result.c.e).to.deep.equal([<span class="hljs-number">4</span>]);
        expect(result.a).to.equal(<span class="hljs-number">1</span>);
        expect(result.b).to.equal(<span class="hljs-number">2</span>);
        expect(result.f).to.equal(<span class="hljs-number">0</span>);
        expect(result.g).to.deep.equal({ <span class="hljs-attr">h</span>: <span class="hljs-number">5</span> });
        done();
    });

    it(<span class="hljs-string">'applies object to defaults with null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">a</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">e</span>: [<span class="hljs-number">4</span>]
            },
            <span class="hljs-attr">f</span>: <span class="hljs-number">0</span>,
            <span class="hljs-attr">g</span>: {
                <span class="hljs-attr">h</span>: <span class="hljs-number">5</span>
            }
        };

        <span class="hljs-keyword">var</span> result = Hoek.applyToDefaults(defaults, obj, <span class="hljs-literal">true</span>);
        expect(result.c.e).to.deep.equal([<span class="hljs-number">4</span>]);
        expect(result.a).to.equal(<span class="hljs-literal">null</span>);
        expect(result.b).to.equal(<span class="hljs-number">2</span>);
        expect(result.f).to.equal(<span class="hljs-number">0</span>);
        expect(result.g).to.deep.equal({ <span class="hljs-attr">h</span>: <span class="hljs-number">5</span> });
        done();
    });
});

describe(<span class="hljs-string">'cloneWithShallow()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'deep clones except for listed keys'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> source = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">d</span>: <span class="hljs-number">6</span>
            }
        };

        <span class="hljs-keyword">var</span> copy = Hoek.cloneWithShallow(source, [<span class="hljs-string">'c'</span>]);
        expect(copy).to.deep.equal(source);
        expect(copy).to.not.equal(source);
        expect(copy.a).to.not.equal(source.a);
        expect(copy.b).to.equal(source.b);
        done();
    });

    it(<span class="hljs-string">'returns immutable value'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.cloneWithShallow(<span class="hljs-number">5</span>)).to.equal(<span class="hljs-number">5</span>);
        done();
    });

    it(<span class="hljs-string">'returns null value'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.cloneWithShallow(<span class="hljs-literal">null</span>)).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'returns undefined value'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.cloneWithShallow(<span class="hljs-literal">undefined</span>)).to.equal(<span class="hljs-literal">undefined</span>);
        done();
    });

    it(<span class="hljs-string">'deep clones except for listed keys (including missing keys)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> source = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">d</span>: <span class="hljs-number">6</span>
            }
        };

        <span class="hljs-keyword">var</span> copy = Hoek.cloneWithShallow(source, [<span class="hljs-string">'c'</span>, <span class="hljs-string">'v'</span>]);
        expect(copy).to.deep.equal(source);
        expect(copy).to.not.equal(source);
        expect(copy.a).to.not.equal(source.a);
        expect(copy.b).to.equal(source.b);
        done();
    });
});

describe(<span class="hljs-string">'applyToDefaultsWithShallow()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'shallow copies the listed keys from options without merging'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>,
                <span class="hljs-attr">e</span>: <span class="hljs-number">3</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">d</span>: <span class="hljs-number">7</span>,
                <span class="hljs-attr">g</span>: <span class="hljs-number">1</span>
            }
        };

        <span class="hljs-keyword">var</span> options = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">4</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">d</span>: <span class="hljs-number">6</span>,
                <span class="hljs-attr">f</span>: <span class="hljs-number">7</span>
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, options, [<span class="hljs-string">'a'</span>]);
        expect(merged).to.deep.equal({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> }, <span class="hljs-attr">c</span>: { <span class="hljs-attr">d</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">g</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">f</span>: <span class="hljs-number">7</span> } });
        expect(merged.a).to.equal(options.a);
        expect(merged.a).to.not.equal(defaults.a);
        expect(merged.c).to.not.equal(options.c);
        expect(merged.c).to.not.equal(defaults.c);
        done();
    });

    it(<span class="hljs-string">'shallow copies the nested keys (override)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">d</span>: <span class="hljs-number">7</span>,
                <span class="hljs-attr">g</span>: <span class="hljs-number">1</span>
            }
        };

        <span class="hljs-keyword">var</span> options = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">4</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">d</span>: <span class="hljs-number">6</span>,
                <span class="hljs-attr">g</span>: {
                    <span class="hljs-attr">h</span>: <span class="hljs-number">8</span>
                }
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, options, [<span class="hljs-string">'c.g'</span>]);
        expect(merged).to.deep.equal({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> }, <span class="hljs-attr">c</span>: { <span class="hljs-attr">d</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">g</span>: { <span class="hljs-attr">h</span>: <span class="hljs-number">8</span> } } });
        expect(merged.c.g).to.equal(options.c.g);
        done();
    });

    it(<span class="hljs-string">'shallow copies the nested keys (missing)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>
            }
        };

        <span class="hljs-keyword">var</span> options = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">4</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">g</span>: {
                    <span class="hljs-attr">h</span>: <span class="hljs-number">8</span>
                }
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, options, [<span class="hljs-string">'c.g'</span>]);
        expect(merged).to.deep.equal({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> }, <span class="hljs-attr">c</span>: { <span class="hljs-attr">g</span>: { <span class="hljs-attr">h</span>: <span class="hljs-number">8</span> } } });
        expect(merged.c.g).to.equal(options.c.g);
        done();
    });

    it(<span class="hljs-string">'shallow copies the nested keys (override)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">g</span>: {
                    <span class="hljs-attr">d</span>: <span class="hljs-number">7</span>
                }
            }
        };

        <span class="hljs-keyword">var</span> options = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">4</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">g</span>: {
                    <span class="hljs-attr">h</span>: <span class="hljs-number">8</span>
                }
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, options, [<span class="hljs-string">'c.g'</span>]);
        expect(merged).to.deep.equal({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> }, <span class="hljs-attr">c</span>: { <span class="hljs-attr">g</span>: { <span class="hljs-attr">h</span>: <span class="hljs-number">8</span> } } });
        expect(merged.c.g).to.equal(options.c.g);
        done();
    });

    it(<span class="hljs-string">'shallow copies the nested keys (deeper)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>
            }
        };

        <span class="hljs-keyword">var</span> options = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">4</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">g</span>: {
                    <span class="hljs-attr">r</span>: {
                        <span class="hljs-attr">h</span>: <span class="hljs-number">8</span>
                    }
                }
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, options, [<span class="hljs-string">'c.g.r'</span>]);
        expect(merged).to.deep.equal({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> }, <span class="hljs-attr">c</span>: { <span class="hljs-attr">g</span>: { <span class="hljs-attr">r</span>: { <span class="hljs-attr">h</span>: <span class="hljs-number">8</span> } } } });
        expect(merged.c.g.r).to.equal(options.c.g.r);
        done();
    });

    it(<span class="hljs-string">'shallow copies the nested keys (not present)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">5</span>
            }
        };

        <span class="hljs-keyword">var</span> options = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">4</span>
            },
            <span class="hljs-attr">c</span>: {
                <span class="hljs-attr">g</span>: {
                    <span class="hljs-attr">r</span>: {
                        <span class="hljs-attr">h</span>: <span class="hljs-number">8</span>
                    }
                }
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, options, [<span class="hljs-string">'x.y'</span>]);
        expect(merged).to.deep.equal({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: <span class="hljs-number">4</span> }, <span class="hljs-attr">c</span>: { <span class="hljs-attr">g</span>: { <span class="hljs-attr">r</span>: { <span class="hljs-attr">h</span>: <span class="hljs-number">8</span> } } } });
        done();
    });

    it(<span class="hljs-string">'shallow copies the listed keys in the defaults'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">1</span>
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, {}, [<span class="hljs-string">'a'</span>]);
        expect(merged.a).to.equal(defaults.a);
        done();
    });

    it(<span class="hljs-string">'shallow copies the listed keys in the defaults (true)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">1</span>
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, <span class="hljs-literal">true</span>, [<span class="hljs-string">'a'</span>]);
        expect(merged.a).to.equal(defaults.a);
        done();
    });

    it(<span class="hljs-string">'returns null on false'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> defaults = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: <span class="hljs-number">1</span>
            }
        };

        <span class="hljs-keyword">var</span> merged = Hoek.applyToDefaultsWithShallow(defaults, <span class="hljs-literal">false</span>, [<span class="hljs-string">'a'</span>]);
        expect(merged).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'throws on missing defaults'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.applyToDefaultsWithShallow(<span class="hljs-literal">null</span>, {}, [<span class="hljs-string">'a'</span>]);
        }).to.throw(<span class="hljs-string">'Invalid defaults value: must be an object'</span>);
        done();
    });

    it(<span class="hljs-string">'throws on invalid defaults'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.applyToDefaultsWithShallow(<span class="hljs-string">'abc'</span>, {}, [<span class="hljs-string">'a'</span>]);
        }).to.throw(<span class="hljs-string">'Invalid defaults value: must be an object'</span>);
        done();
    });

    it(<span class="hljs-string">'throws on invalid options'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.applyToDefaultsWithShallow({}, <span class="hljs-string">'abc'</span>, [<span class="hljs-string">'a'</span>]);
        }).to.throw(<span class="hljs-string">'Invalid options value: must be true, falsy or an object'</span>);
        done();
    });

    it(<span class="hljs-string">'throws on missing keys'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.applyToDefaultsWithShallow({}, <span class="hljs-literal">true</span>);
        }).to.throw(<span class="hljs-string">'Invalid keys'</span>);
        done();
    });

    it(<span class="hljs-string">'throws on invalid keys'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.applyToDefaultsWithShallow({}, <span class="hljs-literal">true</span>, <span class="hljs-string">'a'</span>);
        }).to.throw(<span class="hljs-string">'Invalid keys'</span>);
        done();
    });
});

describe(<span class="hljs-string">'deepEqual()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'compares simple values'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual(<span class="hljs-string">'x'</span>, <span class="hljs-string">'x'</span>)).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-string">'x'</span>, <span class="hljs-string">'y'</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-string">'x1'</span>, <span class="hljs-string">'x'</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-number">-0</span>, +<span class="hljs-number">0</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-number">-0</span>, <span class="hljs-number">-0</span>)).to.be.true();
        expect(Hoek.deepEqual(+<span class="hljs-number">0</span>, +<span class="hljs-number">0</span>)).to.be.true();
        expect(Hoek.deepEqual(+<span class="hljs-number">0</span>, <span class="hljs-number">-0</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-number">-1</span>, <span class="hljs-number">1</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-literal">NaN</span>, <span class="hljs-number">0</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-literal">NaN</span>, <span class="hljs-literal">NaN</span>)).to.be.true();
        done();
    });

    it(<span class="hljs-string">'compares different types'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual([], <span class="hljs-number">5</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-number">5</span>, [])).to.be.false();
        expect(Hoek.deepEqual({}, <span class="hljs-literal">null</span>)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-literal">null</span>, {})).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-string">'abc'</span>, {})).to.be.false();
        expect(Hoek.deepEqual({}, <span class="hljs-string">'abc'</span>)).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares empty structures'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual([], [])).to.be.true();
        expect(Hoek.deepEqual({}, {})).to.be.true();
        expect(Hoek.deepEqual([], {})).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares empty arguments object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> compare = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            expect(Hoek.deepEqual([], <span class="hljs-built_in">arguments</span>)).to.be.false();
        };

        compare();
        done();
    });

    it(<span class="hljs-string">'compares empty arguments objects'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> compare = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> arg1 = <span class="hljs-built_in">arguments</span>;

            <span class="hljs-keyword">var</span> inner = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                expect(Hoek.deepEqual(arg1, <span class="hljs-built_in">arguments</span>)).to.be.false(); <span class="hljs-comment">// callee is not the same</span>
            };

            inner();
        };

        compare();
        done();
    });

    it(<span class="hljs-string">'compares dates'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2015</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>), <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2015</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>))).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">100</span>), <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">101</span>))).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), {})).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares regular expressions'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual(<span class="hljs-regexp">/\s/</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'\\\s'</span>))).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-regexp">/\s/g</span>, /\s/g)).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-regexp">/a/</span>, {})).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-regexp">/\s/g</span>, /\s/i)).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-regexp">/a/g</span>, /b/g)).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares arrays'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual([[<span class="hljs-number">1</span>]], [[<span class="hljs-number">1</span>]])).to.be.true();
        expect(Hoek.deepEqual([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])).to.be.true();
        expect(Hoek.deepEqual([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>])).to.be.false();
        expect(Hoek.deepEqual([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])).to.be.false();
        expect(Hoek.deepEqual([<span class="hljs-number">1</span>], [<span class="hljs-number">1</span>])).to.be.true();
        done();
    });

    it(<span class="hljs-string">'compares buffers'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]), <span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]))).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]), <span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>]))).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]), <span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]))).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]), {})).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Buffer([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]), [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares objects'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.deepEqual({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> })).to.be.true();
        expect(Hoek.deepEqual({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> }, { <span class="hljs-attr">foo</span>: <span class="hljs-string">'baz'</span> })).to.be.false();
        expect(Hoek.deepEqual({ <span class="hljs-attr">foo</span>: { <span class="hljs-attr">bar</span>: <span class="hljs-string">'foo'</span> } }, { <span class="hljs-attr">foo</span>: { <span class="hljs-attr">bar</span>: <span class="hljs-string">'baz'</span> } })).to.be.false();
        done();
    });

    it(<span class="hljs-string">'handles circular dependency'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = {};
        a.x = a;

        <span class="hljs-keyword">var</span> b = Hoek.clone(a);
        expect(Hoek.deepEqual(a, b)).to.be.true();
        done();
    });

    it(<span class="hljs-string">'compares an object with property getter without executing it'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {};
        <span class="hljs-keyword">var</span> value = <span class="hljs-number">1</span>;
        <span class="hljs-keyword">var</span> execCount = <span class="hljs-number">0</span>;

        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">'test'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                ++execCount;
                <span class="hljs-keyword">return</span> value;
            }
        });

        <span class="hljs-keyword">var</span> copy = Hoek.clone(obj);
        expect(Hoek.deepEqual(obj, copy)).to.be.true();
        expect(execCount).to.equal(<span class="hljs-number">0</span>);
        expect(copy.test).to.equal(<span class="hljs-number">1</span>);
        expect(execCount).to.equal(<span class="hljs-number">1</span>);
        done();
    });

    it(<span class="hljs-string">'compares objects with property getters'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {};
        <span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">'test'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            }
        });

        <span class="hljs-keyword">var</span> ref = {};
        <span class="hljs-built_in">Object</span>.defineProperty(ref, <span class="hljs-string">'test'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;
            }
        });

        expect(Hoek.deepEqual(obj, ref)).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares object prototypes'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> Obj = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">this</span>.a = <span class="hljs-number">5</span>;
        };

        Obj.prototype.b = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.a;
        };

        <span class="hljs-keyword">var</span> Ref = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">this</span>.a = <span class="hljs-number">5</span>;
        };

        Ref.prototype.b = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.a;
        };

        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Obj(), <span class="hljs-keyword">new</span> Ref())).to.be.false();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Obj(), <span class="hljs-keyword">new</span> Obj())).to.be.true();
        expect(Hoek.deepEqual(<span class="hljs-keyword">new</span> Ref(), <span class="hljs-keyword">new</span> Ref())).to.be.true();
        done();
    });

    it(<span class="hljs-string">'compares plain objects'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">var</span> b = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);

        a.b = <span class="hljs-string">'c'</span>;
        b.b = <span class="hljs-string">'c'</span>;

        expect(Hoek.deepEqual(a, b)).to.be.true();
        expect(Hoek.deepEqual(a, { <span class="hljs-attr">b</span>: <span class="hljs-string">'c'</span> })).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares an object with an empty object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };

        expect(Hoek.deepEqual({}, a)).to.be.false();
        expect(Hoek.deepEqual(a, {})).to.be.false();
        done();
    });

    it(<span class="hljs-string">'compares an object ignoring the prototype'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">var</span> b = {};

        expect(Hoek.deepEqual(a, b, { <span class="hljs-attr">prototype</span>: <span class="hljs-literal">false</span> })).to.be.true();
        done();
    });

    it(<span class="hljs-string">'compares an object ignoring the prototype recursively'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = [<span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>)];
        <span class="hljs-keyword">var</span> b = [{}];

        expect(Hoek.deepEqual(a, b, { <span class="hljs-attr">prototype</span>: <span class="hljs-literal">false</span> })).to.be.true();
        done();
    });
});

describe(<span class="hljs-string">'unique()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'ensures uniqueness within array of objects based on subkey'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.unique(dupsArray, <span class="hljs-string">'x'</span>);
        expect(a).to.deep.equal(reducedDupsArray);
        done();
    });

    it(<span class="hljs-string">'removes duplicated without key'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.unique([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>])).to.deep.equal([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);
        done();
    });
});

describe(<span class="hljs-string">'mapToObject()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'returns null on null array'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.mapToObject(<span class="hljs-literal">null</span>);
        expect(a).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'converts basic array to existential object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> keys = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];
        <span class="hljs-keyword">var</span> a = Hoek.mapToObject(keys);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i <span class="hljs-keyword">in</span> keys) {
            expect(a[keys[i]]).to.equal(<span class="hljs-literal">true</span>);
        }
        done();
    });

    it(<span class="hljs-string">'converts array of objects to existential object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> keys = [{ <span class="hljs-attr">x</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">x</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">x</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">y</span>: <span class="hljs-number">4</span> }];
        <span class="hljs-keyword">var</span> subkey = <span class="hljs-string">'x'</span>;
        <span class="hljs-keyword">var</span> a = Hoek.mapToObject(keys, subkey);
        expect(a).to.deep.equal({ <span class="hljs-number">1</span>: <span class="hljs-literal">true</span>, <span class="hljs-number">2</span>: <span class="hljs-literal">true</span>, <span class="hljs-number">3</span>: <span class="hljs-literal">true</span> });
        done();
    });
});

describe(<span class="hljs-string">'intersect()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'returns the common objects of two arrays'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> array1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>];
        <span class="hljs-keyword">var</span> array2 = [<span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>];
        <span class="hljs-keyword">var</span> common = Hoek.intersect(array1, array2);
        expect(common.length).to.equal(<span class="hljs-number">2</span>);
        done();
    });

    it(<span class="hljs-string">'returns just the first common object of two arrays'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> array1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>];
        <span class="hljs-keyword">var</span> array2 = [<span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>];
        <span class="hljs-keyword">var</span> common = Hoek.intersect(array1, array2, <span class="hljs-literal">true</span>);
        expect(common).to.equal(<span class="hljs-number">5</span>);
        done();
    });

    it(<span class="hljs-string">'returns null when no common and returning just the first common object of two arrays'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> array1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>];
        <span class="hljs-keyword">var</span> array2 = [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>];
        <span class="hljs-keyword">var</span> common = Hoek.intersect(array1, array2, <span class="hljs-literal">true</span>);
        expect(common).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'returns an empty array if either input is null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.intersect([<span class="hljs-number">1</span>], <span class="hljs-literal">null</span>).length).to.equal(<span class="hljs-number">0</span>);
        expect(Hoek.intersect(<span class="hljs-literal">null</span>, [<span class="hljs-number">1</span>]).length).to.equal(<span class="hljs-number">0</span>);
        done();
    });

    it(<span class="hljs-string">'returns the common objects of object and array'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> array1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>];
        <span class="hljs-keyword">var</span> array2 = [<span class="hljs-number">5</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>];
        <span class="hljs-keyword">var</span> common = Hoek.intersect(Hoek.mapToObject(array1), array2);
        expect(common.length).to.equal(<span class="hljs-number">2</span>);
        done();
    });
});

describe(<span class="hljs-string">'contain()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'tests strings'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, <span class="hljs-string">'ab'</span>)).to.be.true();
        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, <span class="hljs-string">'abc'</span>, { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain(<span class="hljs-string">'aaa'</span>, <span class="hljs-string">'a'</span>, { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, <span class="hljs-string">'b'</span>, { <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'c'</span>])).to.be.true();
        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'d'</span>], { <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.true();

        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, <span class="hljs-string">'ac'</span>)).to.be.false();
        expect(Hoek.contain(<span class="hljs-string">'abcd'</span>, <span class="hljs-string">'abc'</span>, { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain(<span class="hljs-string">'aab'</span>, <span class="hljs-string">'a'</span>, { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain(<span class="hljs-string">'abb'</span>, <span class="hljs-string">'b'</span>, { <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'d'</span>])).to.be.false();
        expect(Hoek.contain(<span class="hljs-string">'abc'</span>, [<span class="hljs-string">'ab'</span>, <span class="hljs-string">'bc'</span>])).to.be.false();                      <span class="hljs-comment">// Overlapping values not supported</span>
        done();
    });

    it(<span class="hljs-string">'tests arrays'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], <span class="hljs-number">1</span>)).to.be.true();
        expect(Hoek.contain([{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }], { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])).to.be.true();
        expect(Hoek.contain([{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }], [{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }], { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], { <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>], { <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain([[<span class="hljs-number">1</span>], [<span class="hljs-number">2</span>]], [[<span class="hljs-number">1</span>]], { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();

        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], <span class="hljs-number">4</span>)).to.be.false();
        expect(Hoek.contain([{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }], { <span class="hljs-attr">a</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain([{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }], { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> })).to.be.false();
        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>])).to.be.false();
        expect(Hoek.contain([[<span class="hljs-number">3</span>], [<span class="hljs-number">2</span>]], [[<span class="hljs-number">1</span>]])).to.be.false();
        expect(Hoek.contain([[<span class="hljs-number">1</span>], [<span class="hljs-number">2</span>]], [[<span class="hljs-number">1</span>]])).to.be.false();
        expect(Hoek.contain([{ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> }], [{ <span class="hljs-attr">a</span>: <span class="hljs-number">2</span> }], { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], { <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain([<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>], { <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.false();
        done();
    });

    it(<span class="hljs-string">'tests objects'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, <span class="hljs-string">'a'</span>)).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'c'</span>])).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>], { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">4</span> }, { <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: [<span class="hljs-number">1</span>], <span class="hljs-attr">b</span>: [<span class="hljs-number">2</span>], <span class="hljs-attr">c</span>: [<span class="hljs-number">3</span>] }, { <span class="hljs-attr">a</span>: [<span class="hljs-number">1</span>], <span class="hljs-attr">c</span>: [<span class="hljs-number">3</span>] }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">e</span>: <span class="hljs-number">4</span> }] }, { <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span> }] }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">e</span>: <span class="hljs-number">4</span> }] }, { <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span> }] }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">e</span>: <span class="hljs-number">4</span> }] }, { <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span> }] }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">part</span>: <span class="hljs-literal">false</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">e</span>: <span class="hljs-number">4</span> }] }, { <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span> }] }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">e</span>: <span class="hljs-number">4</span> }] }, { <span class="hljs-attr">a</span>: [{ <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">d</span>: <span class="hljs-number">3</span> }] }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">only</span>: <span class="hljs-literal">false</span> })).to.be.true();

        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, <span class="hljs-string">'d'</span>)).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'d'</span>])).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">4</span> }, [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>], { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">2</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.false();             <span class="hljs-comment">// part does not ignore bad value</span>
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">3</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">4</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> }, { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> }, { <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: [<span class="hljs-number">1</span>], <span class="hljs-attr">b</span>: [<span class="hljs-number">2</span>], <span class="hljs-attr">c</span>: [<span class="hljs-number">3</span>] }, { <span class="hljs-attr">a</span>: [<span class="hljs-number">1</span>], <span class="hljs-attr">c</span>: [<span class="hljs-number">3</span>] })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">2</span> } } }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span> } } })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">2</span> } } }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span> } } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">2</span> } } }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span> } } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">2</span> } } }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span> } } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">only</span>: <span class="hljs-literal">false</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">2</span> } } }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span> } } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">2</span> } } }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">1</span> } } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">part</span>: <span class="hljs-literal">false</span> })).to.be.false();

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Getter check</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> Foo = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">bar</span>) </span>{

            <span class="hljs-keyword">this</span>.bar = bar;
        };

        <span class="hljs-built_in">Object</span>.defineProperty(Foo.prototype, <span class="hljs-string">'baz'</span>, {
            <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">get</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.bar;
            }
        });

        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">baz</span>: <span class="hljs-string">'b'</span> } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> })).to.be.true();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">baz</span>: <span class="hljs-string">'b'</span> } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">only</span>: <span class="hljs-literal">true</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">baz</span>: <span class="hljs-string">'b'</span> } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">part</span>: <span class="hljs-literal">false</span> })).to.be.false();
        expect(Hoek.contain({ <span class="hljs-attr">a</span>: <span class="hljs-keyword">new</span> Foo(<span class="hljs-string">'b'</span>) }, { <span class="hljs-attr">a</span>: { <span class="hljs-attr">baz</span>: <span class="hljs-string">'b'</span> } }, { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">part</span>: <span class="hljs-literal">true</span> })).to.be.true();

        done();
    });
});

describe(<span class="hljs-string">'flatten()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'returns a flat array'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.flatten([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">7</span>], <span class="hljs-number">8</span>], [<span class="hljs-number">9</span>], [<span class="hljs-number">10</span>, [<span class="hljs-number">11</span>, <span class="hljs-number">12</span>]], <span class="hljs-number">13</span>]);
        expect(result.length).to.equal(<span class="hljs-number">13</span>);
        expect(result).to.deep.equal([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>]);
        done();
    });
});

describe(<span class="hljs-string">'reach()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">var</span> obj = {
        <span class="hljs-attr">a</span>: {
            <span class="hljs-attr">b</span>: {
                <span class="hljs-attr">c</span>: {
                    <span class="hljs-attr">d</span>: <span class="hljs-number">1</span>,
                    <span class="hljs-attr">e</span>: <span class="hljs-number">2</span>
                },
                <span class="hljs-attr">f</span>: <span class="hljs-string">'hello'</span>
            },
            <span class="hljs-attr">g</span>: {
                <span class="hljs-attr">h</span>: <span class="hljs-number">3</span>
            }
        },
        <span class="hljs-attr">i</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ },
        <span class="hljs-attr">j</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">k</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>]
    };

    obj.i.x = <span class="hljs-number">5</span>;

    it(<span class="hljs-string">'returns object itself'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-literal">null</span>)).to.equal(obj);
        expect(Hoek.reach(obj, <span class="hljs-literal">false</span>)).to.equal(obj);
        expect(Hoek.reach(obj)).to.equal(obj);
        done();
    });

    it(<span class="hljs-string">'returns first value of array'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'k.0'</span>)).to.equal(<span class="hljs-number">4</span>);
        done();
    });

    it(<span class="hljs-string">'returns last value of array using negative index'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'k.-2'</span>)).to.equal(<span class="hljs-number">9</span>);
        done();
    });

    it(<span class="hljs-string">'returns a valid member'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'a.b.c.d'</span>)).to.equal(<span class="hljs-number">1</span>);
        done();
    });

    it(<span class="hljs-string">'returns a valid member with separator override'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'a/b/c/d'</span>, <span class="hljs-string">'/'</span>)).to.equal(<span class="hljs-number">1</span>);
        done();
    });

    it(<span class="hljs-string">'returns undefined on null object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(<span class="hljs-literal">null</span>, <span class="hljs-string">'a.b.c.d'</span>)).to.equal(<span class="hljs-literal">undefined</span>);
        done();
    });

    it(<span class="hljs-string">'returns undefined on missing object member'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'a.b.c.d.x'</span>)).to.equal(<span class="hljs-literal">undefined</span>);
        done();
    });

    it(<span class="hljs-string">'returns undefined on missing function member'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'i.y'</span>, { <span class="hljs-attr">functions</span>: <span class="hljs-literal">true</span> })).to.equal(<span class="hljs-literal">undefined</span>);
        done();
    });

    it(<span class="hljs-string">'throws on missing member in strict mode'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.reach(obj, <span class="hljs-string">'a.b.c.o.x'</span>, { <span class="hljs-attr">strict</span>: <span class="hljs-literal">true</span> });
        }).to.throw(<span class="hljs-string">'Missing segment o in reach path  a.b.c.o.x'</span>);

        done();
    });

    it(<span class="hljs-string">'returns undefined on invalid member'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'a.b.c.d-.x'</span>)).to.equal(<span class="hljs-literal">undefined</span>);
        done();
    });

    it(<span class="hljs-string">'returns function member'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-keyword">typeof</span> Hoek.reach(obj, <span class="hljs-string">'i'</span>)).to.equal(<span class="hljs-string">'function'</span>);
        done();
    });

    it(<span class="hljs-string">'returns function property'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'i.x'</span>)).to.equal(<span class="hljs-number">5</span>);
        done();
    });

    it(<span class="hljs-string">'returns null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'j'</span>)).to.equal(<span class="hljs-literal">null</span>);
        done();
    });

    it(<span class="hljs-string">'throws on function property when functions not allowed'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.reach(obj, <span class="hljs-string">'i.x'</span>, { <span class="hljs-attr">functions</span>: <span class="hljs-literal">false</span> });
        }).to.throw(<span class="hljs-string">'Invalid segment x in reach path  i.x'</span>);

        done();
    });

    it(<span class="hljs-string">'will return a default value if property is not found'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'a.b.q'</span>, { <span class="hljs-attr">default</span>: <span class="hljs-string">'defaultValue'</span> })).to.equal(<span class="hljs-string">'defaultValue'</span>);
        done();
    });

    it(<span class="hljs-string">'will return a default value if path is not found'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'q'</span>, { <span class="hljs-attr">default</span>: <span class="hljs-string">'defaultValue'</span> })).to.equal(<span class="hljs-string">'defaultValue'</span>);
        done();
    });

    it(<span class="hljs-string">'allows a falsey value to be used as the default value'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.reach(obj, <span class="hljs-string">'q'</span>, { <span class="hljs-attr">default</span>: <span class="hljs-string">''</span> })).to.equal(<span class="hljs-string">''</span>);
        done();
    });
});

describe(<span class="hljs-string">'reachTemplate()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'applies object to template'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: {
                    <span class="hljs-attr">c</span>: {
                        <span class="hljs-attr">d</span>: <span class="hljs-number">1</span>
                    }
                }
            },
            <span class="hljs-attr">j</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">k</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>]
        };

        <span class="hljs-keyword">var</span> template = <span class="hljs-string">'{k.0}:{k.-2}:{a.b.c.d}:{x.y}:{j}'</span>;

        expect(Hoek.reachTemplate(obj, template)).to.equal(<span class="hljs-string">'4:9:1::'</span>);
        done();
    });

    it(<span class="hljs-string">'applies object to template (options)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">a</span>: {
                <span class="hljs-attr">b</span>: {
                    <span class="hljs-attr">c</span>: {
                        <span class="hljs-attr">d</span>: <span class="hljs-number">1</span>
                    }
                }
            },
            <span class="hljs-attr">j</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">k</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>]
        };

        <span class="hljs-keyword">var</span> template = <span class="hljs-string">'{k/0}:{k/-2}:{a/b/c/d}:{x/y}:{j}'</span>;

        expect(Hoek.reachTemplate(obj, template, <span class="hljs-string">'/'</span>)).to.equal(<span class="hljs-string">'4:9:1::'</span>);
        done();
    });
});

describe(<span class="hljs-string">'callStack()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'returns the full call stack'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> stack = Hoek.callStack();
        expect(stack[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]).to.contain(<span class="hljs-string">'index.js'</span>);
        expect(stack[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>]).to.equal(<span class="hljs-number">26</span>);
        done();
    });
});

describe(<span class="hljs-string">'displayStack ()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'returns the full call stack for display'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> stack = Hoek.displayStack();
        expect(stack[<span class="hljs-number">0</span>]).to.contain(Path.normalize(<span class="hljs-string">'/test/index.js'</span>) + <span class="hljs-string">':'</span>);
        done();
    });

    it(<span class="hljs-string">'includes constructor functions correctly'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> Something = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">next</span>) </span>{

            next();
        };

        <span class="hljs-keyword">var</span> something = <span class="hljs-keyword">new</span> Something(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> stack = Hoek.displayStack();
            expect(stack[<span class="hljs-number">1</span>]).to.contain(<span class="hljs-string">'new Something'</span>);
            done();
        });
    });
});

describe(<span class="hljs-string">'abort()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'exits process when not in test mode'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> env = process.env.NODE_ENV;
        <span class="hljs-keyword">var</span> write = process.stdout.write;
        <span class="hljs-keyword">var</span> exit = process.exit;

        process.env.NODE_ENV = <span class="hljs-string">'nottatest'</span>;
        process.stdout.write = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ };
        process.exit = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">state</span>) </span>{

            process.exit = exit;
            process.env.NODE_ENV = env;
            process.stdout.write = write;

            expect(state).to.equal(<span class="hljs-number">1</span>);
            done();
        };

        Hoek.abort(<span class="hljs-string">'Boom'</span>);
    });

    it(<span class="hljs-string">'throws when not in test mode and abortThrow is true'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> env = process.env.NODE_ENV;
        process.env.NODE_ENV = <span class="hljs-string">'nottatest'</span>;
        Hoek.abortThrow = <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.abort(<span class="hljs-string">'my error message'</span>);
        };

        expect(fn).to.throw(<span class="hljs-string">'my error message'</span>);
        Hoek.abortThrow = <span class="hljs-literal">false</span>;
        process.env.NODE_ENV = env;

        done();
    });

    it(<span class="hljs-string">'respects hideStack argument'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> env = process.env.NODE_ENV;
        <span class="hljs-keyword">var</span> write = process.stdout.write;
        <span class="hljs-keyword">var</span> exit = process.exit;
        <span class="hljs-keyword">var</span> output = <span class="hljs-string">''</span>;

        process.exit = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ };
        process.env.NODE_ENV = <span class="hljs-string">''</span>;
        process.stdout.write = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) </span>{

            output = message;
        };

        Hoek.abort(<span class="hljs-string">'my error message'</span>, <span class="hljs-literal">true</span>);

        process.env.NODE_ENV = env;
        process.stdout.write = write;
        process.exit = exit;

        expect(output).to.equal(<span class="hljs-string">'ABORT: my error message\n\t\n'</span>);

        done();
    });

    it(<span class="hljs-string">'throws in test mode'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> env = process.env.NODE_ENV;
        process.env.NODE_ENV = <span class="hljs-string">'test'</span>;

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.abort(<span class="hljs-string">'my error message'</span>, <span class="hljs-literal">true</span>);
        }).to.throw(<span class="hljs-string">'my error message'</span>);

        process.env.NODE_ENV = env;
        done();
    });

    it(<span class="hljs-string">'throws in test mode with default message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> env = process.env.NODE_ENV;
        process.env.NODE_ENV = <span class="hljs-string">'test'</span>;

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.abort(<span class="hljs-string">''</span>, <span class="hljs-literal">true</span>);
        }).to.throw(<span class="hljs-string">'Unknown error'</span>);

        process.env.NODE_ENV = env;
        done();
    });

    it(<span class="hljs-string">'defaults to showing stack'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> env = process.env.NODE_ENV;
        <span class="hljs-keyword">var</span> write = process.stdout.write;
        <span class="hljs-keyword">var</span> exit = process.exit;
        <span class="hljs-keyword">var</span> output = <span class="hljs-string">''</span>;

        process.exit = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ };
        process.env.NODE_ENV = <span class="hljs-string">''</span>;
        process.stdout.write = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) </span>{

            output = message;
        };

        Hoek.abort(<span class="hljs-string">'my error message'</span>);

        process.env.NODE_ENV = env;
        process.stdout.write = write;
        process.exit = exit;

        expect(output).to.contain(<span class="hljs-string">'index.js'</span>);

        done();
    });
});

describe(<span class="hljs-string">'assert()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'throws an Error when using assert in a test'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>, <span class="hljs-string">'my error message'</span>);
        };

        expect(fn).to.throw(<span class="hljs-string">'my error message'</span>);
        done();
    });

    it(<span class="hljs-string">'throws an Error when using assert in a test with no message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>);
        };

        expect(fn).to.throw(<span class="hljs-string">'Unknown error'</span>);
        done();
    });

    it(<span class="hljs-string">'throws an Error when using assert in a test with multipart message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>, <span class="hljs-string">'This'</span>, <span class="hljs-string">'is'</span>, <span class="hljs-string">'my message'</span>);
        };

        expect(fn).to.throw(<span class="hljs-string">'This is my message'</span>);
        done();
    });

    it(<span class="hljs-string">'throws an Error when using assert in a test with multipart message (empty)'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>, <span class="hljs-string">'This'</span>, <span class="hljs-string">'is'</span>, <span class="hljs-string">''</span>, <span class="hljs-string">'my message'</span>);
        };

        expect(fn).to.throw(<span class="hljs-string">'This is my message'</span>);
        done();
    });

    it(<span class="hljs-string">'throws an Error when using assert in a test with object message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>, <span class="hljs-string">'This'</span>, <span class="hljs-string">'is'</span>, { <span class="hljs-attr">spinal</span>: <span class="hljs-string">'tap'</span> });
        };

        expect(fn).to.throw(<span class="hljs-string">'This is {"spinal":"tap"}'</span>);
        done();
    });

    it(<span class="hljs-string">'throws an Error when using assert in a test with multipart string and error messages'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>, <span class="hljs-string">'This'</span>, <span class="hljs-string">'is'</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'spinal'</span>), <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'tap'</span>));
        };

        expect(fn).to.throw(<span class="hljs-string">'This is spinal tap'</span>);
        done();
    });

    it(<span class="hljs-string">'throws an Error when using assert in a test with error object message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'This is spinal tap'</span>));
        };

        expect(fn).to.throw(<span class="hljs-string">'This is spinal tap'</span>);
        done();
    });

    it(<span class="hljs-string">'throws the same Error that is passed to it if there is only one error passed'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> error = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'ruh roh'</span>);
        <span class="hljs-keyword">var</span> error2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'ruh roh'</span>);

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.assert(<span class="hljs-literal">false</span>, error);
        };

        <span class="hljs-keyword">try</span> {
            fn();
        } <span class="hljs-keyword">catch</span> (err) {
            expect(error).to.equal(error);  <span class="hljs-comment">// should be the same reference</span>
            expect(error).to.not.equal(error2); <span class="hljs-comment">// error with the same message should not match</span>
        }

        done();
    });
});

describe(<span class="hljs-string">'Timer'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'returns time elapsed'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> timer = <span class="hljs-keyword">new</span> Hoek.Timer();
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            expect(timer.elapsed()).to.be.above(<span class="hljs-number">9</span>);
            done();
        }, <span class="hljs-number">12</span>);
    });
});

describe(<span class="hljs-string">'Bench'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'returns time elapsed'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> timer = <span class="hljs-keyword">new</span> Hoek.Bench();
        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            expect(timer.elapsed()).to.be.above(<span class="hljs-number">9</span>);
            done();
        }, <span class="hljs-number">12</span>);
    });
});

describe(<span class="hljs-string">'escapeRegex()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'escapes all special regular expression characters'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.escapeRegex(<span class="hljs-string">'4^f$s.4*5+-_?%=#!:@|~\\/`"(&gt;)[&lt;]d{}s,'</span>);
        expect(a).to.equal(<span class="hljs-string">'4\\^f\\$s\\.4\\*5\\+\\-_\\?%\\=#\\!\\:@\\|~\\\\\\/`"\\(&gt;\\)\\[&lt;\\]d\\{\\}s\\,'</span>);
        done();
    });
});

describe(<span class="hljs-string">'Base64Url'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">var</span> base64str = <span class="hljs-string">'AAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmJygpKissLS4vMDEyMzQ1Njc4OTo7PD0-P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXV5fYGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6e3x9fn-AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmqq6ytrq-wsbKztLW2t7i5uru8vb6_wMHCw8TFxsfIycrLzM3Oz9DR0tPU1dbX2Nna29zd3t_g4eLj5OXm5-jp6uvs7e7v8PHy8_T19vf4-fr7_P3-_w'</span>;
    <span class="hljs-keyword">var</span> str = <span class="hljs-built_in">unescape</span>(<span class="hljs-string">'%00%01%02%03%04%05%06%07%08%09%0A%0B%0C%0D%0E%0F%10%11%12%13%14%15%16%17%18%19%1A%1B%1C%1D%1E%1F%20%21%22%23%24%25%26%27%28%29*+%2C-./0123456789%3A%3B%3C%3D%3E%3F@ABCDEFGHIJKLMNOPQRSTUVWXYZ%5B%5C%5D%5E_%60abcdefghijklmnopqrstuvwxyz%7B%7C%7D%7E%7F%80%81%82%83%84%85%86%87%88%89%8A%8B%8C%8D%8E%8F%90%91%92%93%94%95%96%97%98%99%9A%9B%9C%9D%9E%9F%A0%A1%A2%A3%A4%A5%A6%A7%A8%A9%AA%AB%AC%AD%AE%AF%B0%B1%B2%B3%B4%B5%B6%B7%B8%B9%BA%BB%BC%BD%BE%BF%C0%C1%C2%C3%C4%C5%C6%C7%C8%C9%CA%CB%CC%CD%CE%CF%D0%D1%D2%D3%D4%D5%D6%D7%D8%D9%DA%DB%DC%DD%DE%DF%E0%E1%E2%E3%E4%E5%E6%E7%E8%E9%EA%EB%EC%ED%EE%EF%F0%F1%F2%F3%F4%F5%F6%F7%F8%F9%FA%FB%FC%FD%FE%FF'</span>);

    describe(<span class="hljs-string">'base64urlEncode()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'should base64 URL-safe a string'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            expect(Hoek.base64urlEncode(str)).to.equal(base64str);
            done();
        });

        it(<span class="hljs-string">'encodes a buffer'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            expect(Hoek.base64urlEncode(<span class="hljs-keyword">new</span> Buffer(str, <span class="hljs-string">'binary'</span>))).to.equal(base64str);
            done();
        });

        it(<span class="hljs-string">'should base64 URL-safe a hex string'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            <span class="hljs-keyword">var</span> buffer = <span class="hljs-keyword">new</span> Buffer(str, <span class="hljs-string">'binary'</span>);
            expect(Hoek.base64urlEncode(buffer.toString(<span class="hljs-string">'hex'</span>), <span class="hljs-string">'hex'</span>)).to.equal(base64str);
            done();
        });

        it(<span class="hljs-string">'works on larger input strings'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            <span class="hljs-keyword">var</span> input = Fs.readFileSync(Path.join(__dirname, <span class="hljs-string">'index.js'</span>)).toString();
            <span class="hljs-keyword">var</span> encoded = Hoek.base64urlEncode(input);

            expect(encoded).to.not.contain(<span class="hljs-string">'+'</span>);
            expect(encoded).to.not.contain(<span class="hljs-string">'/'</span>);

            <span class="hljs-keyword">var</span> decoded = Hoek.base64urlDecode(encoded);

            expect(decoded).to.equal(input);
            done();
        });
    });

    describe(<span class="hljs-string">'base64urlDecode()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        it(<span class="hljs-string">'should un-base64 URL-safe a string'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            expect(Hoek.base64urlDecode(base64str)).to.equal(str);
            done();
        });

        it(<span class="hljs-string">'should un-base64 URL-safe a string into hex'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            expect(Hoek.base64urlDecode(base64str, <span class="hljs-string">'hex'</span>)).to.equal(<span class="hljs-keyword">new</span> Buffer(str, <span class="hljs-string">'binary'</span>).toString(<span class="hljs-string">'hex'</span>));
            done();
        });

        it(<span class="hljs-string">'should un-base64 URL-safe a string and return a buffer'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            <span class="hljs-keyword">var</span> buf = Hoek.base64urlDecode(base64str, <span class="hljs-string">'buffer'</span>);
            expect(buf <span class="hljs-keyword">instanceof</span> Buffer).to.equal(<span class="hljs-literal">true</span>);
            expect(buf.toString(<span class="hljs-string">'binary'</span>)).to.equal(str);
            done();
        });

        it(<span class="hljs-string">'returns error on undefined input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            expect(Hoek.base64urlDecode().message).to.exist();
            done();
        });

        it(<span class="hljs-string">'returns error on invalid input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

            expect(Hoek.base64urlDecode(<span class="hljs-string">'*'</span>).message).to.exist();
            done();
        });
    });
});

describe(<span class="hljs-string">'escapeHeaderAttribute()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'should not alter ascii values'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.escapeHeaderAttribute(<span class="hljs-string">'My Value'</span>);
        expect(a).to.equal(<span class="hljs-string">'My Value'</span>);
        done();
    });

    it(<span class="hljs-string">'escapes all special HTTP header attribute characters'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.escapeHeaderAttribute(<span class="hljs-string">'I said go!!!#"'</span> + <span class="hljs-built_in">String</span>.fromCharCode(<span class="hljs-number">92</span>));
        expect(a).to.equal(<span class="hljs-string">'I said go!!!#\\"\\\\'</span>);
        done();
    });

    it(<span class="hljs-string">'throws on large unicode characters'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.escapeHeaderAttribute(<span class="hljs-string">'this is a test'</span> + <span class="hljs-built_in">String</span>.fromCharCode(<span class="hljs-number">500</span>) + <span class="hljs-built_in">String</span>.fromCharCode(<span class="hljs-number">300</span>));
        };

        expect(fn).to.throw(<span class="hljs-built_in">Error</span>);
        done();
    });

    it(<span class="hljs-string">'throws on CRLF to prevent response splitting'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> fn = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            Hoek.escapeHeaderAttribute(<span class="hljs-string">'this is a test\r\n'</span>);
        };

        expect(fn).to.throw(<span class="hljs-built_in">Error</span>);
        done();
    });
});

describe(<span class="hljs-string">'escapeHtml()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'escapes all special HTML characters'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.escapeHtml(<span class="hljs-string">'&amp;&lt;&gt;"\'`'</span>);
        expect(a).to.equal(<span class="hljs-string">'&amp;amp;&amp;lt;&amp;gt;&amp;quot;&amp;#x27;&amp;#x60;'</span>);
        done();
    });

    it(<span class="hljs-string">'returns empty string on falsy input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.escapeHtml(<span class="hljs-string">''</span>);
        expect(a).to.equal(<span class="hljs-string">''</span>);
        done();
    });

    it(<span class="hljs-string">'returns unchanged string on no reserved input'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = Hoek.escapeHtml(<span class="hljs-string">'abc'</span>);
        expect(a).to.equal(<span class="hljs-string">'abc'</span>);
        done();
    });
});

describe(<span class="hljs-string">'nextTick()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'calls the provided callback on nextTick'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> a = <span class="hljs-number">0</span>;

        <span class="hljs-keyword">var</span> inc = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">step, next</span>) </span>{

            a += step;
            next();
        };

        <span class="hljs-keyword">var</span> ticked = Hoek.nextTick(inc);

        ticked(<span class="hljs-number">5</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            expect(a).to.equal(<span class="hljs-number">6</span>);
            done();
        });

        expect(a).to.equal(<span class="hljs-number">0</span>);
        inc(<span class="hljs-number">1</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            expect(a).to.equal(<span class="hljs-number">1</span>);
        });
    });
});

describe(<span class="hljs-string">'once()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'allows function to only execute once'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> gen = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) </span>{

            gen += x;
        };

        add(<span class="hljs-number">5</span>);
        expect(gen).to.equal(<span class="hljs-number">5</span>);
        add = Hoek.once(add);
        add(<span class="hljs-number">5</span>);
        expect(gen).to.equal(<span class="hljs-number">10</span>);
        add(<span class="hljs-number">5</span>);
        expect(gen).to.equal(<span class="hljs-number">10</span>);
        done();
    });

    it(<span class="hljs-string">'double once wraps one time'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> method = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ };
        method = Hoek.once(method);
        method.x = <span class="hljs-number">1</span>;
        method = Hoek.once(method);
        expect(method.x).to.equal(<span class="hljs-number">1</span>);
        done();
    });
});

describe(<span class="hljs-string">'isAbsoltePath()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'identifies if path is absolute on Unix without node support'</span>, { <span class="hljs-attr">parallel</span>: <span class="hljs-literal">false</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> orig = Path.isAbsolute;
        Path.isAbsolute = <span class="hljs-literal">undefined</span>;

        expect(Hoek.isAbsolutePath(<span class="hljs-string">''</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'a'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'./a'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'/a'</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'/'</span>)).to.equal(<span class="hljs-literal">true</span>);

        Path.isAbsolute = orig;

        done();
    });

    it(<span class="hljs-string">'identifies if path is absolute with fake node support'</span>, { <span class="hljs-attr">parallel</span>: <span class="hljs-literal">false</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> orig = Path.isAbsolute;
        Path.isAbsolute = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">path</span>) </span>{

            <span class="hljs-keyword">return</span> path[<span class="hljs-number">0</span>] === <span class="hljs-string">'/'</span>;
        };

        expect(Hoek.isAbsolutePath(<span class="hljs-string">''</span>, <span class="hljs-string">'linux'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'a'</span>, <span class="hljs-string">'linux'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'./a'</span>, <span class="hljs-string">'linux'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'/a'</span>, <span class="hljs-string">'linux'</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'/'</span>, <span class="hljs-string">'linux'</span>)).to.equal(<span class="hljs-literal">true</span>);

        Path.isAbsolute = orig;

        done();
    });

    it(<span class="hljs-string">'identifies if path is absolute on Windows without node support'</span>, { <span class="hljs-attr">parallel</span>: <span class="hljs-literal">false</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> orig = Path.isAbsolute;
        Path.isAbsolute = <span class="hljs-literal">undefined</span>;

        expect(Hoek.isAbsolutePath(<span class="hljs-string">'//server/file'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'//server/file'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'\\\\server\\file'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'C:/Users/'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'C:\\Users\\'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'C:cwd/another'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'C:cwd\\another'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'directory/directory'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isAbsolutePath(<span class="hljs-string">'directory\\directory'</span>, <span class="hljs-string">'win32'</span>)).to.equal(<span class="hljs-literal">false</span>);

        Path.isAbsolute = orig;

        done();
    });
});

describe(<span class="hljs-string">'isInteger()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'validates integers'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.isInteger(<span class="hljs-number">0</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isInteger(<span class="hljs-number">1</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isInteger(<span class="hljs-number">1394035612500</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isInteger(<span class="hljs-string">'0'</span>)).to.equal(<span class="hljs-literal">false</span>);
        expect(Hoek.isInteger(<span class="hljs-number">1.0</span>)).to.equal(<span class="hljs-literal">true</span>);
        expect(Hoek.isInteger(<span class="hljs-number">1.1</span>)).to.equal(<span class="hljs-literal">false</span>);
        done();
    });
});

describe(<span class="hljs-string">'ignore()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'exists'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.ignore).to.exist();
        expect(<span class="hljs-keyword">typeof</span> Hoek.ignore).to.equal(<span class="hljs-string">'function'</span>);
        done();
    });
});

describe(<span class="hljs-string">'inherits()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'exists'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.inherits).to.exist();
        expect(<span class="hljs-keyword">typeof</span> Hoek.inherits).to.equal(<span class="hljs-string">'function'</span>);
        done();
    });
});

describe(<span class="hljs-string">'format()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'exists'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.format).to.exist();
        expect(<span class="hljs-keyword">typeof</span> Hoek.format).to.equal(<span class="hljs-string">'function'</span>);
        done();
    });

    it(<span class="hljs-string">'is a reference to Util.format'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(Hoek.format(<span class="hljs-string">'hello %s'</span>, <span class="hljs-string">'world'</span>)).to.equal(<span class="hljs-string">'hello world'</span>);
        done();
    });
});

describe(<span class="hljs-string">'transform()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">var</span> source = {
        <span class="hljs-attr">address</span>: {
            <span class="hljs-attr">one</span>: <span class="hljs-string">'123 main street'</span>,
            <span class="hljs-attr">two</span>: <span class="hljs-string">'PO Box 1234'</span>
        },
        <span class="hljs-attr">zip</span>: {
            <span class="hljs-attr">code</span>: <span class="hljs-number">3321232</span>,
            <span class="hljs-attr">province</span>: <span class="hljs-literal">null</span>
        },
        <span class="hljs-attr">title</span>: <span class="hljs-string">'Warehouse'</span>,
        <span class="hljs-attr">state</span>: <span class="hljs-string">'CA'</span>
    };

    <span class="hljs-keyword">var</span> sourcesArray = [{
        <span class="hljs-attr">address</span>: {
            <span class="hljs-attr">one</span>: <span class="hljs-string">'123 main street'</span>,
            <span class="hljs-attr">two</span>: <span class="hljs-string">'PO Box 1234'</span>
        },
        <span class="hljs-attr">zip</span>: {
            <span class="hljs-attr">code</span>: <span class="hljs-number">3321232</span>,
            <span class="hljs-attr">province</span>: <span class="hljs-literal">null</span>
        },
        <span class="hljs-attr">title</span>: <span class="hljs-string">'Warehouse'</span>,
        <span class="hljs-attr">state</span>: <span class="hljs-string">'CA'</span>
    }, {
        <span class="hljs-attr">address</span>: {
            <span class="hljs-attr">one</span>: <span class="hljs-string">'456 market street'</span>,
            <span class="hljs-attr">two</span>: <span class="hljs-string">'PO Box 5678'</span>
        },
        <span class="hljs-attr">zip</span>: {
            <span class="hljs-attr">code</span>: <span class="hljs-number">9876</span>,
            <span class="hljs-attr">province</span>: <span class="hljs-literal">null</span>
        },
        <span class="hljs-attr">title</span>: <span class="hljs-string">'Garage'</span>,
        <span class="hljs-attr">state</span>: <span class="hljs-string">'NY'</span>
    }];

    it(<span class="hljs-string">'transforms an object based on the input object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.transform(source, {
            <span class="hljs-string">'person.address.lineOne'</span>: <span class="hljs-string">'address.one'</span>,
            <span class="hljs-string">'person.address.lineTwo'</span>: <span class="hljs-string">'address.two'</span>,
            <span class="hljs-string">'title'</span>: <span class="hljs-string">'title'</span>,
            <span class="hljs-string">'person.address.region'</span>: <span class="hljs-string">'state'</span>,
            <span class="hljs-string">'person.address.zip'</span>: <span class="hljs-string">'zip.code'</span>,
            <span class="hljs-string">'person.address.location'</span>: <span class="hljs-string">'zip.province'</span>
        });

        expect(result).to.deep.equal({
            <span class="hljs-attr">person</span>: {
                <span class="hljs-attr">address</span>: {
                    <span class="hljs-attr">lineOne</span>: <span class="hljs-string">'123 main street'</span>,
                    <span class="hljs-attr">lineTwo</span>: <span class="hljs-string">'PO Box 1234'</span>,
                    <span class="hljs-attr">region</span>: <span class="hljs-string">'CA'</span>,
                    <span class="hljs-attr">zip</span>: <span class="hljs-number">3321232</span>,
                    <span class="hljs-attr">location</span>: <span class="hljs-literal">null</span>
                }
            },
            <span class="hljs-attr">title</span>: <span class="hljs-string">'Warehouse'</span>
        });

        done();
    });

    it(<span class="hljs-string">'transforms an array of objects based on the input object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.transform(sourcesArray, {
            <span class="hljs-string">'person.address.lineOne'</span>: <span class="hljs-string">'address.one'</span>,
            <span class="hljs-string">'person.address.lineTwo'</span>: <span class="hljs-string">'address.two'</span>,
            <span class="hljs-string">'title'</span>: <span class="hljs-string">'title'</span>,
            <span class="hljs-string">'person.address.region'</span>: <span class="hljs-string">'state'</span>,
            <span class="hljs-string">'person.address.zip'</span>: <span class="hljs-string">'zip.code'</span>,
            <span class="hljs-string">'person.address.location'</span>: <span class="hljs-string">'zip.province'</span>
        });

        expect(result).to.deep.equal([
            {
                <span class="hljs-attr">person</span>: {
                    <span class="hljs-attr">address</span>: {
                        <span class="hljs-attr">lineOne</span>: <span class="hljs-string">'123 main street'</span>,
                        <span class="hljs-attr">lineTwo</span>: <span class="hljs-string">'PO Box 1234'</span>,
                        <span class="hljs-attr">region</span>: <span class="hljs-string">'CA'</span>,
                        <span class="hljs-attr">zip</span>: <span class="hljs-number">3321232</span>,
                        <span class="hljs-attr">location</span>: <span class="hljs-literal">null</span>
                    }
                },
                <span class="hljs-attr">title</span>: <span class="hljs-string">'Warehouse'</span>
            },
            {
                <span class="hljs-attr">person</span>: {
                    <span class="hljs-attr">address</span>: {
                        <span class="hljs-attr">lineOne</span>: <span class="hljs-string">'456 market street'</span>,
                        <span class="hljs-attr">lineTwo</span>: <span class="hljs-string">'PO Box 5678'</span>,
                        <span class="hljs-attr">region</span>: <span class="hljs-string">'NY'</span>,
                        <span class="hljs-attr">zip</span>: <span class="hljs-number">9876</span>,
                        <span class="hljs-attr">location</span>: <span class="hljs-literal">null</span>
                    }
                },
                <span class="hljs-attr">title</span>: <span class="hljs-string">'Garage'</span>
            }
        ]);

        done();
    });

    it(<span class="hljs-string">'uses the reach options passed into it'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> schema = {
            <span class="hljs-string">'person.address.lineOne'</span>: <span class="hljs-string">'address-one'</span>,
            <span class="hljs-string">'person.address.lineTwo'</span>: <span class="hljs-string">'address-two'</span>,
            <span class="hljs-string">'title'</span>: <span class="hljs-string">'title'</span>,
            <span class="hljs-string">'person.address.region'</span>: <span class="hljs-string">'state'</span>,
            <span class="hljs-string">'person.prefix'</span>: <span class="hljs-string">'person-title'</span>,
            <span class="hljs-string">'person.zip'</span>: <span class="hljs-string">'zip-code'</span>
        };
        <span class="hljs-keyword">var</span> options = {
            <span class="hljs-attr">separator</span>: <span class="hljs-string">'-'</span>,
            <span class="hljs-attr">default</span>: <span class="hljs-string">'unknown'</span>
        };
        <span class="hljs-keyword">var</span> result = Hoek.transform(source, schema, options);

        expect(result).to.deep.equal({
            <span class="hljs-attr">person</span>: {
                <span class="hljs-attr">address</span>: {
                    <span class="hljs-attr">lineOne</span>: <span class="hljs-string">'123 main street'</span>,
                    <span class="hljs-attr">lineTwo</span>: <span class="hljs-string">'PO Box 1234'</span>,
                    <span class="hljs-attr">region</span>: <span class="hljs-string">'CA'</span>
                },
                <span class="hljs-attr">prefix</span>: <span class="hljs-string">'unknown'</span>,
                <span class="hljs-attr">zip</span>: <span class="hljs-number">3321232</span>
            },
            <span class="hljs-attr">title</span>: <span class="hljs-string">'Warehouse'</span>
        });

        done();
    });

    it(<span class="hljs-string">'works to create shallow objects'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.transform(source, {
            <span class="hljs-attr">lineOne</span>: <span class="hljs-string">'address.one'</span>,
            <span class="hljs-attr">lineTwo</span>: <span class="hljs-string">'address.two'</span>,
            <span class="hljs-attr">title</span>: <span class="hljs-string">'title'</span>,
            <span class="hljs-attr">region</span>: <span class="hljs-string">'state'</span>,
            <span class="hljs-attr">province</span>: <span class="hljs-string">'zip.province'</span>
        });

        expect(result).to.deep.equal({
            <span class="hljs-attr">lineOne</span>: <span class="hljs-string">'123 main street'</span>,
            <span class="hljs-attr">lineTwo</span>: <span class="hljs-string">'PO Box 1234'</span>,
            <span class="hljs-attr">title</span>: <span class="hljs-string">'Warehouse'</span>,
            <span class="hljs-attr">region</span>: <span class="hljs-string">'CA'</span>,
            <span class="hljs-attr">province</span>: <span class="hljs-literal">null</span>
        });

        done();
    });

    it(<span class="hljs-string">'only allows strings in the map'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> result = Hoek.transform(source, {
                <span class="hljs-attr">lineOne</span>: {}
            });
        }).to.throw(<span class="hljs-string">'All mappings must be "." delineated strings'</span>);

        done();
    });

    it(<span class="hljs-string">'throws an error on invalid arguments'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        expect(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">var</span> result = Hoek.transform(<span class="hljs-literal">NaN</span>, {});
        }).to.throw(<span class="hljs-string">'Invalid source object: must be null, undefined, an object, or an array'</span>);

        done();
    });

    it(<span class="hljs-string">'is safe to pass null'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.transform(<span class="hljs-literal">null</span>, {});
        expect(result).to.deep.equal({});

        done();
    });

    it(<span class="hljs-string">'is safe to pass undefined'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.transform(<span class="hljs-literal">undefined</span>, {});
        expect(result).to.deep.equal({});

        done();
    });
});

describe(<span class="hljs-string">'uniqueFilename()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    it(<span class="hljs-string">'generates a random file path'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.uniqueFilename(<span class="hljs-string">'./test/modules'</span>);

        expect(result).to.exist();
        expect(result).to.be.a.string();
        expect(result).to.contain(<span class="hljs-string">'test/modules'</span>);
        done();
    });

    it(<span class="hljs-string">'is random enough to use in fast loops'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> results = [];

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i) {
            results[i] = Hoek.uniqueFilename(<span class="hljs-string">'./test/modules'</span>);
        }

        <span class="hljs-keyword">var</span> filter = results.filter(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item, index, array</span>) </span>{

            <span class="hljs-keyword">return</span> array.indexOf(item) === index;
        });

        expect(filter.length).to.equal(<span class="hljs-number">10</span>);
        expect(results.length).to.equal(<span class="hljs-number">10</span>);
        done();

    });

    it(<span class="hljs-string">'combines the random elements with a supplied character'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.uniqueFilename(<span class="hljs-string">'./test'</span>, <span class="hljs-string">'txt'</span>);

        expect(result).to.contain(<span class="hljs-string">'test/'</span>);
        expect(result).to.contain(<span class="hljs-string">'.txt'</span>);

        done();
    });

    it(<span class="hljs-string">'accepts extensions with a "." in it'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> result = Hoek.uniqueFilename(<span class="hljs-string">'./test'</span>, <span class="hljs-string">'.mp3'</span>);

        expect(result).to.contain(<span class="hljs-string">'test/'</span>);
        expect(result).to.contain(<span class="hljs-string">'.mp3'</span>);

        done();
    });
});

describe(<span class="hljs-string">'stringify()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

    it(<span class="hljs-string">'converts object to string'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> };
        expect(Hoek.stringify(obj)).to.equal(<span class="hljs-string">'{"a":1}'</span>);
        done();
    });

    it(<span class="hljs-string">'returns error in result string'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> };
        obj.b = obj;
        expect(Hoek.stringify(obj)).to.equal(<span class="hljs-string">'[Cannot display object: Converting circular structure to JSON]'</span>);
        done();
    });
});

describe(<span class="hljs-string">'shallow()'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

    it(<span class="hljs-string">'shallow copies an object'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">done</span>) </span>{

        <span class="hljs-keyword">var</span> obj = {
            <span class="hljs-attr">a</span>: <span class="hljs-number">5</span>,
            <span class="hljs-attr">b</span>: {
                <span class="hljs-attr">c</span>: <span class="hljs-number">6</span>
            }
        };

        <span class="hljs-keyword">var</span> shallow = Hoek.shallow(obj);
        expect(shallow).to.not.equal(obj);
        expect(shallow).to.deep.equal(obj);
        expect(shallow.b).to.equal(obj.b);
        done();
    });
});

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
