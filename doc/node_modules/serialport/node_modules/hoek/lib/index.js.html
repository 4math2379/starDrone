<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/hoek/lib/index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<p>Load modules</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> Crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);
<span class="hljs-keyword">var</span> Path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> Util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>);
<span class="hljs-keyword">var</span> Escape = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./escape'</span>);


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Declare internals</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> internals = {};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Clone object or array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.clone = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, seen</span>) </span>{

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span> ||
        obj === <span class="hljs-literal">null</span>) {

        <span class="hljs-keyword">return</span> obj;
    }

    seen = seen || { <span class="hljs-attr">orig</span>: [], <span class="hljs-attr">copy</span>: [] };

    <span class="hljs-keyword">var</span> lookup = seen.orig.indexOf(obj);
    <span class="hljs-keyword">if</span> (lookup !== <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">return</span> seen.copy[lookup];
    }

    <span class="hljs-keyword">var</span> newObj;
    <span class="hljs-keyword">var</span> cloneDeep = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Array</span>.isArray(obj)) {
        <span class="hljs-keyword">if</span> (Buffer.isBuffer(obj)) {
            newObj = <span class="hljs-keyword">new</span> Buffer(obj);
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>) {
            newObj = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(obj.getTime());
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) {
            newObj = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(obj);
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> proto = <span class="hljs-built_in">Object</span>.getPrototypeOf(obj);
            <span class="hljs-keyword">if</span> (proto &amp;&amp;
                proto.isImmutable) {

                newObj = obj;
            }
            <span class="hljs-keyword">else</span> {
                newObj = <span class="hljs-built_in">Object</span>.create(proto);
                cloneDeep = <span class="hljs-literal">true</span>;
            }
        }
    }
    <span class="hljs-keyword">else</span> {
        newObj = [];
        cloneDeep = <span class="hljs-literal">true</span>;
    }

    seen.orig.push(obj);
    seen.copy.push(newObj);

    <span class="hljs-keyword">if</span> (cloneDeep) {
        <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.getOwnPropertyNames(obj);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = keys.length; i &lt; il; ++i) {
            <span class="hljs-keyword">var</span> key = keys[i];
            <span class="hljs-keyword">var</span> descriptor = <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(obj, key);
            <span class="hljs-keyword">if</span> (descriptor &amp;&amp;
                (descriptor.get ||
                 descriptor.set)) {

                <span class="hljs-built_in">Object</span>.defineProperty(newObj, key, descriptor);
            }
            <span class="hljs-keyword">else</span> {
                newObj[key] = exports.clone(obj[key], seen);
            }
        }
    }

    <span class="hljs-keyword">return</span> newObj;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Merge all the properties of source into target, source wins in conflict, and by default null and undefined from source are applied</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-comment">/*eslint-disable */</span>
exports.merge = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, source, isNullOverride <span class="hljs-regexp">/* = true */</span>, isMergeArrays <span class="hljs-regexp">/* = true */</span></span>) </span>{
<span class="hljs-comment">/*eslint-enable */</span>
    exports.assert(target &amp;&amp; <span class="hljs-keyword">typeof</span> target === <span class="hljs-string">'object'</span>, <span class="hljs-string">'Invalid target value: must be an object'</span>);
    exports.assert(source === <span class="hljs-literal">null</span> || source === <span class="hljs-literal">undefined</span> || <span class="hljs-keyword">typeof</span> source === <span class="hljs-string">'object'</span>, <span class="hljs-string">'Invalid source value: must be null, undefined, or an object'</span>);

    <span class="hljs-keyword">if</span> (!source) {
        <span class="hljs-keyword">return</span> target;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(source)) {
        exports.assert(<span class="hljs-built_in">Array</span>.isArray(target), <span class="hljs-string">'Cannot merge array onto an object'</span>);
        <span class="hljs-keyword">if</span> (isMergeArrays === <span class="hljs-literal">false</span>) {                                                  <span class="hljs-comment">// isMergeArrays defaults to true</span>
            target.length = <span class="hljs-number">0</span>;                                                          <span class="hljs-comment">// Must not change target assignment</span>
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = source.length; i &lt; il; ++i) {
            target.push(exports.clone(source[i]));
        }

        <span class="hljs-keyword">return</span> target;
    }

    <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(source);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>, kl = keys.length; k &lt; kl; ++k) {
        <span class="hljs-keyword">var</span> key = keys[k];
        <span class="hljs-keyword">var</span> value = source[key];
        <span class="hljs-keyword">if</span> (value &amp;&amp;
            <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'object'</span>) {

            <span class="hljs-keyword">if</span> (!target[key] ||
                <span class="hljs-keyword">typeof</span> target[key] !== <span class="hljs-string">'object'</span> ||
                (<span class="hljs-built_in">Array</span>.isArray(target[key]) ^ <span class="hljs-built_in">Array</span>.isArray(value)) ||
                value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span> ||
                Buffer.isBuffer(value) ||
                value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) {

                target[key] = exports.clone(value);
            }
            <span class="hljs-keyword">else</span> {
                exports.merge(target[key], value, isNullOverride, isMergeArrays);
            }
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (value !== <span class="hljs-literal">null</span> &amp;&amp;
                value !== <span class="hljs-literal">undefined</span>) {                              <span class="hljs-comment">// Explicit to preserve empty strings</span>

                target[key] = value;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isNullOverride !== <span class="hljs-literal">false</span>) {                    <span class="hljs-comment">// Defaults to true</span>
                target[key] = value;
            }
        }
    }

    <span class="hljs-keyword">return</span> target;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Apply options to a copy of the defaults</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.applyToDefaults = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">defaults, options, isNullOverride</span>) </span>{

    exports.assert(defaults &amp;&amp; <span class="hljs-keyword">typeof</span> defaults === <span class="hljs-string">'object'</span>, <span class="hljs-string">'Invalid defaults value: must be an object'</span>);
    exports.assert(!options || options === <span class="hljs-literal">true</span> || <span class="hljs-keyword">typeof</span> options === <span class="hljs-string">'object'</span>, <span class="hljs-string">'Invalid options value: must be true, falsy or an object'</span>);

    <span class="hljs-keyword">if</span> (!options) {                                                 <span class="hljs-comment">// If no options, return null</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">var</span> copy = exports.clone(defaults);

    <span class="hljs-keyword">if</span> (options === <span class="hljs-literal">true</span>) {                                         <span class="hljs-comment">// If options is set to true, use defaults</span>
        <span class="hljs-keyword">return</span> copy;
    }

    <span class="hljs-keyword">return</span> exports.merge(copy, options, isNullOverride === <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Clone an object except for the listed keys which are shallow copied</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.cloneWithShallow = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source, keys</span>) </span>{

    <span class="hljs-keyword">if</span> (!source ||
        <span class="hljs-keyword">typeof</span> source !== <span class="hljs-string">'object'</span>) {

        <span class="hljs-keyword">return</span> source;
    }

    <span class="hljs-keyword">var</span> storage = internals.store(source, keys);    <span class="hljs-comment">// Move shallow copy items to storage</span>
    <span class="hljs-keyword">var</span> copy = exports.clone(source);               <span class="hljs-comment">// Deep copy the rest</span>
    internals.restore(copy, source, storage);       <span class="hljs-comment">// Shallow copy the stored items and restore</span>
    <span class="hljs-keyword">return</span> copy;
};


internals.store = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source, keys</span>) </span>{

    <span class="hljs-keyword">var</span> storage = {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = keys.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> key = keys[i];
        <span class="hljs-keyword">var</span> value = exports.reach(source, key);
        <span class="hljs-keyword">if</span> (value !== <span class="hljs-literal">undefined</span>) {
            storage[key] = value;
            internals.reachSet(source, key, <span class="hljs-literal">undefined</span>);
        }
    }

    <span class="hljs-keyword">return</span> storage;
};


internals.restore = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">copy, source, storage</span>) </span>{

    <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(storage);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = keys.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> key = keys[i];
        internals.reachSet(copy, key, storage[key]);
        internals.reachSet(source, key, storage[key]);
    }
};


internals.reachSet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, key, value</span>) </span>{

    <span class="hljs-keyword">var</span> path = key.split(<span class="hljs-string">'.'</span>);
    <span class="hljs-keyword">var</span> ref = obj;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = path.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> segment = path[i];
        <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> === il) {
            ref[segment] = value;
        }

        ref = ref[segment];
    }
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Apply options to defaults except for the listed keys which are shallow copied from option without merging</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.applyToDefaultsWithShallow = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">defaults, options, keys</span>) </span>{

    exports.assert(defaults &amp;&amp; <span class="hljs-keyword">typeof</span> defaults === <span class="hljs-string">'object'</span>, <span class="hljs-string">'Invalid defaults value: must be an object'</span>);
    exports.assert(!options || options === <span class="hljs-literal">true</span> || <span class="hljs-keyword">typeof</span> options === <span class="hljs-string">'object'</span>, <span class="hljs-string">'Invalid options value: must be true, falsy or an object'</span>);
    exports.assert(keys &amp;&amp; <span class="hljs-built_in">Array</span>.isArray(keys), <span class="hljs-string">'Invalid keys'</span>);

    <span class="hljs-keyword">if</span> (!options) {                                                 <span class="hljs-comment">// If no options, return null</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">var</span> copy = exports.cloneWithShallow(defaults, keys);

    <span class="hljs-keyword">if</span> (options === <span class="hljs-literal">true</span>) {                                         <span class="hljs-comment">// If options is set to true, use defaults</span>
        <span class="hljs-keyword">return</span> copy;
    }

    <span class="hljs-keyword">var</span> storage = internals.store(options, keys);   <span class="hljs-comment">// Move shallow copy items to storage</span>
    exports.merge(copy, options, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);     <span class="hljs-comment">// Deep copy the rest</span>
    internals.restore(copy, options, storage);      <span class="hljs-comment">// Shallow copy the stored items and restore</span>
    <span class="hljs-keyword">return</span> copy;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Deep object or array comparison</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.deepEqual = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, ref, options, seen</span>) </span>{

    options = options || { <span class="hljs-attr">prototype</span>: <span class="hljs-literal">true</span> };

    <span class="hljs-keyword">var</span> type = <span class="hljs-keyword">typeof</span> obj;

    <span class="hljs-keyword">if</span> (type !== <span class="hljs-keyword">typeof</span> ref) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">if</span> (type !== <span class="hljs-string">'object'</span> ||
        obj === <span class="hljs-literal">null</span> ||
        ref === <span class="hljs-literal">null</span>) {

        <span class="hljs-keyword">if</span> (obj === ref) {                                                      <span class="hljs-comment">// Copied from Deep-eql, copyright(c) 2013 Jake Luer, jake@alogicalparadox.com, MIT Licensed, https://github.com/chaijs/deep-eql</span>
            <span class="hljs-keyword">return</span> obj !== <span class="hljs-number">0</span> || <span class="hljs-number">1</span> / obj === <span class="hljs-number">1</span> / ref;        <span class="hljs-comment">// -0 / +0</span>
        }

        <span class="hljs-keyword">return</span> obj !== obj &amp;&amp; ref !== ref;                  <span class="hljs-comment">// NaN</span>
    }

    seen = seen || [];
    <span class="hljs-keyword">if</span> (seen.indexOf(obj) !== <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;                            <span class="hljs-comment">// If previous comparison failed, it would have stopped execution</span>
    }

    seen.push(obj);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(obj)) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Array</span>.isArray(ref)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">if</span> (!options.part &amp;&amp; obj.length !== ref.length) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = obj.length; i &lt; il; ++i) {
            <span class="hljs-keyword">if</span> (options.part) {
                <span class="hljs-keyword">var</span> found = <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> r = <span class="hljs-number">0</span>, rl = ref.length; r &lt; rl; ++r) {
                    <span class="hljs-keyword">if</span> (exports.deepEqual(obj[i], ref[r], options, seen)) {
                        found = <span class="hljs-literal">true</span>;
                        <span class="hljs-keyword">break</span>;
                    }
                }

                <span class="hljs-keyword">return</span> found;
            }

            <span class="hljs-keyword">if</span> (!exports.deepEqual(obj[i], ref[i], options, seen)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">if</span> (Buffer.isBuffer(obj)) {
        <span class="hljs-keyword">if</span> (!Buffer.isBuffer(ref)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">if</span> (obj.length !== ref.length) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>, jl = obj.length; j &lt; jl; ++j) {
            <span class="hljs-keyword">if</span> (obj[j] !== ref[j]) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>) {
        <span class="hljs-keyword">return</span> (ref <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span> &amp;&amp; obj.getTime() === ref.getTime());
    }

    <span class="hljs-keyword">if</span> (obj <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) {
        <span class="hljs-keyword">return</span> (ref <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span> &amp;&amp; obj.toString() === ref.toString());
    }

    <span class="hljs-keyword">if</span> (options.prototype) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.getPrototypeOf(obj) !== <span class="hljs-built_in">Object</span>.getPrototypeOf(ref)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.getOwnPropertyNames(obj);

    <span class="hljs-keyword">if</span> (!options.part &amp;&amp; keys.length !== <span class="hljs-built_in">Object</span>.getOwnPropertyNames(ref).length) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>, kl = keys.length; k &lt; kl; ++k) {
        <span class="hljs-keyword">var</span> key = keys[k];
        <span class="hljs-keyword">var</span> descriptor = <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(obj, key);
        <span class="hljs-keyword">if</span> (descriptor.get) {
            <span class="hljs-keyword">if</span> (!exports.deepEqual(descriptor, <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(ref, key), options, seen)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!exports.deepEqual(obj[key], ref[key], options, seen)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Remove duplicate items from array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.unique = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">array, key</span>) </span>{

    <span class="hljs-keyword">var</span> index = {};
    <span class="hljs-keyword">var</span> result = [];

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = array.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> id = (key ? array[i][key] : array[i]);
        <span class="hljs-keyword">if</span> (index[id] !== <span class="hljs-literal">true</span>) {

            result.push(array[i]);
            index[id] = <span class="hljs-literal">true</span>;
        }
    }

    <span class="hljs-keyword">return</span> result;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Convert array into object</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.mapToObject = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">array, key</span>) </span>{

    <span class="hljs-keyword">if</span> (!array) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">var</span> obj = {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = array.length; i &lt; il; ++i) {
        <span class="hljs-keyword">if</span> (key) {
            <span class="hljs-keyword">if</span> (array[i][key]) {
                obj[array[i][key]] = <span class="hljs-literal">true</span>;
            }
        }
        <span class="hljs-keyword">else</span> {
            obj[array[i]] = <span class="hljs-literal">true</span>;
        }
    }

    <span class="hljs-keyword">return</span> obj;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Find the common unique items in two arrays</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.intersect = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">array1, array2, justFirst</span>) </span>{

    <span class="hljs-keyword">if</span> (!array1 || !array2) {
        <span class="hljs-keyword">return</span> [];
    }

    <span class="hljs-keyword">var</span> common = [];
    <span class="hljs-keyword">var</span> hash = (<span class="hljs-built_in">Array</span>.isArray(array1) ? exports.mapToObject(array1) : array1);
    <span class="hljs-keyword">var</span> found = {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = array2.length; i &lt; il; ++i) {
        <span class="hljs-keyword">if</span> (hash[array2[i]] &amp;&amp; !found[array2[i]]) {
            <span class="hljs-keyword">if</span> (justFirst) {
                <span class="hljs-keyword">return</span> array2[i];
            }

            common.push(array2[i]);
            found[array2[i]] = <span class="hljs-literal">true</span>;
        }
    }

    <span class="hljs-keyword">return</span> (justFirst ? <span class="hljs-literal">null</span> : common);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Test if the reference contains the values</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.contain = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">ref, values, options</span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
<p>string -&gt; string(s)
array -&gt; item(s)
object -&gt; key(s)
object -&gt; object (key:value)</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    <span class="hljs-keyword">var</span> valuePairs = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ref === <span class="hljs-string">'object'</span> &amp;&amp;
        <span class="hljs-keyword">typeof</span> values === <span class="hljs-string">'object'</span> &amp;&amp;
        !<span class="hljs-built_in">Array</span>.isArray(ref) &amp;&amp;
        !<span class="hljs-built_in">Array</span>.isArray(values)) {

        valuePairs = values;
        values = <span class="hljs-built_in">Object</span>.keys(values);
    }
    <span class="hljs-keyword">else</span> {
        values = [].concat(values);
    }

    options = options || {};            <span class="hljs-comment">// deep, once, only, part</span>

    exports.assert(<span class="hljs-built_in">arguments</span>.length &gt;= <span class="hljs-number">2</span>, <span class="hljs-string">'Insufficient arguments'</span>);
    exports.assert(<span class="hljs-keyword">typeof</span> ref === <span class="hljs-string">'string'</span> || <span class="hljs-keyword">typeof</span> ref === <span class="hljs-string">'object'</span>, <span class="hljs-string">'Reference must be string or an object'</span>);
    exports.assert(values.length, <span class="hljs-string">'Values array cannot be empty'</span>);

    <span class="hljs-keyword">var</span> compare, compareFlags;
    <span class="hljs-keyword">if</span> (options.deep) {
        compare = exports.deepEqual;

        <span class="hljs-keyword">var</span> hasOnly = options.hasOwnProperty(<span class="hljs-string">'only'</span>), hasPart = options.hasOwnProperty(<span class="hljs-string">'part'</span>);

        compareFlags = {
            <span class="hljs-attr">prototype</span>: hasOnly ? options.only : hasPart ? !options.part : <span class="hljs-literal">false</span>,
            <span class="hljs-attr">part</span>: hasOnly ? !options.only : hasPart ? options.part : <span class="hljs-literal">true</span>
        };
    }
    <span class="hljs-keyword">else</span> {
        compare = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{

            <span class="hljs-keyword">return</span> a === b;
        };
    }

    <span class="hljs-keyword">var</span> misses = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> matches = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(values.length);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = matches.length; i &lt; il; ++i) {
        matches[i] = <span class="hljs-number">0</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ref === <span class="hljs-string">'string'</span>) {
        <span class="hljs-keyword">var</span> pattern = <span class="hljs-string">'('</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, il = values.length; i &lt; il; ++i) {
            <span class="hljs-keyword">var</span> value = values[i];
            exports.assert(<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'string'</span>, <span class="hljs-string">'Cannot compare string reference to non-string value'</span>);
            pattern += (i ? <span class="hljs-string">'|'</span> : <span class="hljs-string">''</span>) + exports.escapeRegex(value);
        }

        <span class="hljs-keyword">var</span> regex = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(pattern + <span class="hljs-string">')'</span>, <span class="hljs-string">'g'</span>);
        <span class="hljs-keyword">var</span> leftovers = ref.replace(regex, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$<span class="hljs-number">0</span>, $<span class="hljs-number">1</span></span>) </span>{

            <span class="hljs-keyword">var</span> index = values.indexOf($<span class="hljs-number">1</span>);
            ++matches[index];
            <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;          <span class="hljs-comment">// Remove from string</span>
        });

        misses = !!leftovers;
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(ref)) {
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, il = ref.length; i &lt; il; ++i) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>, jl = values.length, matched = <span class="hljs-literal">false</span>; j &lt; jl &amp;&amp; matched === <span class="hljs-literal">false</span>; ++j) {
                matched = compare(values[j], ref[i], compareFlags) &amp;&amp; j;
            }

            <span class="hljs-keyword">if</span> (matched !== <span class="hljs-literal">false</span>) {
                ++matches[matched];
            }
            <span class="hljs-keyword">else</span> {
                misses = <span class="hljs-literal">true</span>;
            }
        }
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(ref);
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, il = keys.length; i &lt; il; ++i) {
            <span class="hljs-keyword">var</span> key = keys[i];
            <span class="hljs-keyword">var</span> pos = values.indexOf(key);
            <span class="hljs-keyword">if</span> (pos !== <span class="hljs-number">-1</span>) {
                <span class="hljs-keyword">if</span> (valuePairs &amp;&amp;
                    !compare(valuePairs[key], ref[key], compareFlags)) {

                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }

                ++matches[pos];
            }
            <span class="hljs-keyword">else</span> {
                misses = <span class="hljs-literal">true</span>;
            }
        }
    }

    <span class="hljs-keyword">var</span> result = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, il = matches.length; i &lt; il; ++i) {
        result = result || !!matches[i];
        <span class="hljs-keyword">if</span> ((options.once &amp;&amp; matches[i] &gt; <span class="hljs-number">1</span>) ||
            (!options.part &amp;&amp; !matches[i])) {

            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">if</span> (options.only &amp;&amp;
        misses) {

        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">return</span> result;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>Flatten array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.flatten = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">array, target</span>) </span>{

    <span class="hljs-keyword">var</span> result = target || [];

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = array.length; i &lt; il; ++i) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(array[i])) {
            exports.flatten(array[i], result);
        }
        <span class="hljs-keyword">else</span> {
            result.push(array[i]);
        }
    }

    <span class="hljs-keyword">return</span> result;
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>Convert an object key chain string ('a.b.c') to reference (object[a][b][c])</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.reach = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, chain, options</span>) </span>{

    <span class="hljs-keyword">if</span> (chain === <span class="hljs-literal">false</span> ||
        chain === <span class="hljs-literal">null</span> ||
        <span class="hljs-keyword">typeof</span> chain === <span class="hljs-string">'undefined'</span>) {

        <span class="hljs-keyword">return</span> obj;
    }

    options = options || {};
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options === <span class="hljs-string">'string'</span>) {
        options = { <span class="hljs-attr">separator</span>: options };
    }

    <span class="hljs-keyword">var</span> path = chain.split(options.separator || <span class="hljs-string">'.'</span>);
    <span class="hljs-keyword">var</span> ref = obj;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = path.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> key = path[i];
        <span class="hljs-keyword">if</span> (key[<span class="hljs-number">0</span>] === <span class="hljs-string">'-'</span> &amp;&amp; <span class="hljs-built_in">Array</span>.isArray(ref)) {
            key = key.slice(<span class="hljs-number">1</span>, key.length);
            key = ref.length - key;
        }

        <span class="hljs-keyword">if</span> (!ref ||
            !ref.hasOwnProperty(key) ||
            (<span class="hljs-keyword">typeof</span> ref !== <span class="hljs-string">'object'</span> &amp;&amp; options.functions === <span class="hljs-literal">false</span>)) {         <span class="hljs-comment">// Only object and function can have properties</span>

            exports.assert(!options.strict || i + <span class="hljs-number">1</span> === il, <span class="hljs-string">'Missing segment'</span>, key, <span class="hljs-string">'in reach path '</span>, chain);
            exports.assert(<span class="hljs-keyword">typeof</span> ref === <span class="hljs-string">'object'</span> || options.functions === <span class="hljs-literal">true</span> || <span class="hljs-keyword">typeof</span> ref !== <span class="hljs-string">'function'</span>, <span class="hljs-string">'Invalid segment'</span>, key, <span class="hljs-string">'in reach path '</span>, chain);
            ref = options.default;
            <span class="hljs-keyword">break</span>;
        }

        ref = ref[key];
    }

    <span class="hljs-keyword">return</span> ref;
};


exports.reachTemplate = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, template, options</span>) </span>{

    <span class="hljs-keyword">return</span> template.replace(<span class="hljs-regexp">/{([^}]+)}/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">$<span class="hljs-number">0</span>, chain</span>) </span>{

        <span class="hljs-keyword">var</span> value = exports.reach(obj, chain, options);
        <span class="hljs-keyword">return</span> (value === <span class="hljs-literal">undefined</span> || value === <span class="hljs-literal">null</span> ? <span class="hljs-string">''</span> : value);
    });
};


exports.formatStack = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">stack</span>) </span>{

    <span class="hljs-keyword">var</span> trace = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = stack.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> item = stack[i];
        trace.push([item.getFileName(), item.getLineNumber(), item.getColumnNumber(), item.getFunctionName(), item.isConstructor()]);
    }

    <span class="hljs-keyword">return</span> trace;
};


exports.formatTrace = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">trace</span>) </span>{

    <span class="hljs-keyword">var</span> display = [];

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = trace.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> row = trace[i];
        display.push((row[<span class="hljs-number">4</span>] ? <span class="hljs-string">'new '</span> : <span class="hljs-string">''</span>) + row[<span class="hljs-number">3</span>] + <span class="hljs-string">' ('</span> + row[<span class="hljs-number">0</span>] + <span class="hljs-string">':'</span> + row[<span class="hljs-number">1</span>] + <span class="hljs-string">':'</span> + row[<span class="hljs-number">2</span>] + <span class="hljs-string">')'</span>);
    }

    <span class="hljs-keyword">return</span> display;
};


exports.callStack = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">slice</span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>http://code.google.com/p/v8/wiki/JavaScriptStackTraceApi</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    <span class="hljs-keyword">var</span> v8 = <span class="hljs-built_in">Error</span>.prepareStackTrace;
    <span class="hljs-built_in">Error</span>.prepareStackTrace = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, stack</span>) </span>{

        <span class="hljs-keyword">return</span> stack;
    };

    <span class="hljs-keyword">var</span> capture = {};
    <span class="hljs-built_in">Error</span>.captureStackTrace(capture, <span class="hljs-built_in">arguments</span>.callee);     <span class="hljs-comment">/*eslint no-caller:0 */</span>
    <span class="hljs-keyword">var</span> stack = capture.stack;

    <span class="hljs-built_in">Error</span>.prepareStackTrace = v8;

    <span class="hljs-keyword">var</span> trace = exports.formatStack(stack);

    <span class="hljs-keyword">if</span> (slice) {
        <span class="hljs-keyword">return</span> trace.slice(slice);
    }

    <span class="hljs-keyword">return</span> trace;
};


exports.displayStack = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">slice</span>) </span>{

    <span class="hljs-keyword">var</span> trace = exports.callStack(slice === <span class="hljs-literal">undefined</span> ? <span class="hljs-number">1</span> : slice + <span class="hljs-number">1</span>);

    <span class="hljs-keyword">return</span> exports.formatTrace(trace);
};


exports.abortThrow = <span class="hljs-literal">false</span>;


exports.abort = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">message, hideStack</span>) </span>{

    <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">'test'</span> || exports.abortThrow === <span class="hljs-literal">true</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(message || <span class="hljs-string">'Unknown error'</span>);
    }

    <span class="hljs-keyword">var</span> stack = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (!hideStack) {
        stack = exports.displayStack(<span class="hljs-number">1</span>).join(<span class="hljs-string">'\n\t'</span>);
    }
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'ABORT: '</span> + message + <span class="hljs-string">'\n\t'</span> + stack);
    process.exit(<span class="hljs-number">1</span>);
};


exports.assert = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">condition <span class="hljs-regexp">/*, msg1, msg2, msg3 */</span></span>) </span>{

    <span class="hljs-keyword">if</span> (condition) {
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length === <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>];
    }

    <span class="hljs-keyword">var</span> msgs = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>, il = <span class="hljs-built_in">arguments</span>.length; i &lt; il; ++i) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>[i] !== <span class="hljs-string">''</span>) {
            msgs.push(<span class="hljs-built_in">arguments</span>[i]);            <span class="hljs-comment">// Avoids Array.slice arguments leak, allowing for V8 optimizations</span>
        }
    }

    msgs = msgs.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">msg</span>) </span>{

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> msg === <span class="hljs-string">'string'</span> ? msg : msg <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span> ? msg.message : exports.stringify(msg);
    });
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(msgs.join(<span class="hljs-string">' '</span>) || <span class="hljs-string">'Unknown error'</span>);
};


exports.Timer = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">this</span>.ts = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.reset();
};


exports.Timer.prototype.reset = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">this</span>.ts = <span class="hljs-built_in">Date</span>.now();
};


exports.Timer.prototype.elapsed = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Date</span>.now() - <span class="hljs-keyword">this</span>.ts;
};


exports.Bench = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">this</span>.ts = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.reset();
};


exports.Bench.prototype.reset = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">this</span>.ts = exports.Bench.now();
};


exports.Bench.prototype.elapsed = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">return</span> exports.Bench.now() - <span class="hljs-keyword">this</span>.ts;
};


exports.Bench.now = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">var</span> ts = process.hrtime();
    <span class="hljs-keyword">return</span> (ts[<span class="hljs-number">0</span>] * <span class="hljs-number">1e3</span>) + (ts[<span class="hljs-number">1</span>] / <span class="hljs-number">1e6</span>);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>Escape string for Regex construction</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.escapeRegex = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>Escape ^$.*+-?=!:|/()[]{},</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">return</span> string.replace(<span class="hljs-regexp">/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g</span>, <span class="hljs-string">'\\$&amp;'</span>);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>Base64url (RFC 4648) encode</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.base64urlEncode = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value, encoding</span>) </span>{

    <span class="hljs-keyword">var</span> buf = (Buffer.isBuffer(value) ? value : <span class="hljs-keyword">new</span> Buffer(value, encoding || <span class="hljs-string">'binary'</span>));
    <span class="hljs-keyword">return</span> buf.toString(<span class="hljs-string">'base64'</span>).replace(<span class="hljs-regexp">/\+/g</span>, <span class="hljs-string">'-'</span>).replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">'_'</span>).replace(<span class="hljs-regexp">/\=/g</span>, <span class="hljs-string">''</span>);
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>Base64url (RFC 4648) decode</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.base64urlDecode = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value, encoding</span>) </span>{

    <span class="hljs-keyword">if</span> (value &amp;&amp;
        !<span class="hljs-regexp">/^[\w\-]*$/</span>.test(value)) {

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid character'</span>);
    }

    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">var</span> buf = <span class="hljs-keyword">new</span> Buffer(value, <span class="hljs-string">'base64'</span>);
        <span class="hljs-keyword">return</span> (encoding === <span class="hljs-string">'buffer'</span> ? buf : buf.toString(encoding || <span class="hljs-string">'binary'</span>));
    }
    <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-keyword">return</span> err;
    }
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>Escape attribute value for use in HTTP header</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
exports.escapeHeaderAttribute = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">attribute</span>) </span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>Allowed value characters: !#$%&amp;'()*+,-./:;&lt;=&gt;?@[]^_`{|}~ and space, a-z, A-Z, 0-9, , &quot;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    exports.assert(<span class="hljs-regexp">/^[ \w\!#\$%&amp;'\(\)\*\+,\-\.\/\:;&lt;\=&gt;\?@\[\]\^`\{\|\}~\"\\]*$/</span>.test(attribute), <span class="hljs-string">'Bad attribute value ('</span> + attribute + <span class="hljs-string">')'</span>);

    <span class="hljs-keyword">return</span> attribute.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'\\\\'</span>).replace(<span class="hljs-regexp">/\"/g</span>, <span class="hljs-string">'\\"'</span>);                             <span class="hljs-comment">// Escape quotes and slash</span>
};


exports.escapeHtml = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{

    <span class="hljs-keyword">return</span> Escape.escapeHtml(string);
};


exports.escapeJavaScript = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{

    <span class="hljs-keyword">return</span> Escape.escapeJavaScript(string);
};


exports.nextTick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) </span>{

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">arguments</span>;
        process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            callback.apply(<span class="hljs-literal">null</span>, args);
        });
    };
};


exports.once = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">method</span>) </span>{

    <span class="hljs-keyword">if</span> (method._hoekOnce) {
        <span class="hljs-keyword">return</span> method;
    }

    <span class="hljs-keyword">var</span> once = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> wrapped = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        <span class="hljs-keyword">if</span> (!once) {
            once = <span class="hljs-literal">true</span>;
            method.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>);
        }
    };

    wrapped._hoekOnce = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">return</span> wrapped;
};


exports.isAbsolutePath = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">path, platform</span>) </span>{

    <span class="hljs-keyword">if</span> (!path) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">if</span> (Path.isAbsolute) {                      <span class="hljs-comment">// node &gt;= 0.11</span>
        <span class="hljs-keyword">return</span> Path.isAbsolute(path);
    }

    platform = platform || process.platform;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>Unix</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    <span class="hljs-keyword">if</span> (platform !== <span class="hljs-string">'win32'</span>) {
        <span class="hljs-keyword">return</span> path[<span class="hljs-number">0</span>] === <span class="hljs-string">'/'</span>;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>Windows</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    <span class="hljs-keyword">return</span> !!<span class="hljs-regexp">/^(?:[a-zA-Z]:[\\\/])|(?:[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/])/</span>.test(path);        <span class="hljs-comment">// C:\ or \\something\something</span>
};


exports.isInteger = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{

    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'number'</span> &amp;&amp;
            <span class="hljs-built_in">parseFloat</span>(value) === <span class="hljs-built_in">parseInt</span>(value, <span class="hljs-number">10</span>) &amp;&amp;
            !<span class="hljs-built_in">isNaN</span>(value));
};


exports.ignore = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ };


exports.inherits = Util.inherits;


exports.format = Util.format;


exports.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source, transform, options</span>) </span>{

    exports.assert(source === <span class="hljs-literal">null</span> || source === <span class="hljs-literal">undefined</span> || <span class="hljs-keyword">typeof</span> source === <span class="hljs-string">'object'</span> || <span class="hljs-built_in">Array</span>.isArray(source), <span class="hljs-string">'Invalid source object: must be null, undefined, an object, or an array'</span>);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(source)) {
        <span class="hljs-keyword">var</span> results = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = source.length; i &lt; il; ++i) {
            results.push(exports.transform(source[i], transform, options));
        }
        <span class="hljs-keyword">return</span> results;
    }

    <span class="hljs-keyword">var</span> result = {};
    <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(transform);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>, kl = keys.length; k &lt; kl; ++k) {
        <span class="hljs-keyword">var</span> key = keys[k];
        <span class="hljs-keyword">var</span> path = key.split(<span class="hljs-string">'.'</span>);
        <span class="hljs-keyword">var</span> sourcePath = transform[key];

        exports.assert(<span class="hljs-keyword">typeof</span> sourcePath === <span class="hljs-string">'string'</span>, <span class="hljs-string">'All mappings must be "." delineated strings'</span>);

        <span class="hljs-keyword">var</span> segment;
        <span class="hljs-keyword">var</span> res = result;

        <span class="hljs-keyword">while</span> (path.length &gt; <span class="hljs-number">1</span>) {
            segment = path.shift();
            <span class="hljs-keyword">if</span> (!res[segment]) {
                res[segment] = {};
            }
            res = res[segment];
        }
        segment = path.shift();
        res[segment] = exports.reach(source, sourcePath, options);
    }

    <span class="hljs-keyword">return</span> result;
};


exports.uniqueFilename = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">path, extension</span>) </span>{

    <span class="hljs-keyword">if</span> (extension) {
        extension = extension[<span class="hljs-number">0</span>] !== <span class="hljs-string">'.'</span> ? <span class="hljs-string">'.'</span> + extension : extension;
    }
    <span class="hljs-keyword">else</span> {
        extension = <span class="hljs-string">''</span>;
    }

    path = Path.resolve(path);
    <span class="hljs-keyword">var</span> name = [<span class="hljs-built_in">Date</span>.now(), process.pid, Crypto.randomBytes(<span class="hljs-number">8</span>).toString(<span class="hljs-string">'hex'</span>)].join(<span class="hljs-string">'-'</span>) + extension;
    <span class="hljs-keyword">return</span> Path.join(path, name);
};


exports.stringify = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify.apply(<span class="hljs-literal">null</span>, <span class="hljs-built_in">arguments</span>);
    }
    <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">'[Cannot display object: '</span> + err.message + <span class="hljs-string">']'</span>;
    }
};


exports.shallow = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source</span>) </span>{

    <span class="hljs-keyword">var</span> target = {};
    <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(source);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, il = keys.length; i &lt; il; ++i) {
        <span class="hljs-keyword">var</span> key = keys[i];
        target[key] = source[key];
    }

    <span class="hljs-keyword">return</span> target;
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
