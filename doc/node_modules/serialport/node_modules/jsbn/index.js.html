<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../";
    var thisFile = "node_modules/serialport/node_modules/jsbn/index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Copyright (c) 2005  Tom Wu
All Rights Reserved.
See &quot;LICENSE&quot; for details.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Basic JavaScript BN library - subset useful for RSA encryption.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Bits per digit</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> dbits;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>JavaScript engine analysis</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> canary = <span class="hljs-number">0xdeadbeefcafe</span>;
    <span class="hljs-keyword">var</span> j_lm = ((canary&amp;<span class="hljs-number">0xffffff</span>)==<span class="hljs-number">0xefcafe</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>(public) Constructor</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BigInteger</span>(<span class="hljs-params">a,b,c</span>) </span>{
      <span class="hljs-keyword">if</span>(a != <span class="hljs-literal">null</span>)
        <span class="hljs-keyword">if</span>(<span class="hljs-string">"number"</span> == <span class="hljs-keyword">typeof</span> a) <span class="hljs-keyword">this</span>.fromNumber(a,b,c);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-literal">null</span> &amp;&amp; <span class="hljs-string">"string"</span> != <span class="hljs-keyword">typeof</span> a) <span class="hljs-keyword">this</span>.fromString(a,<span class="hljs-number">256</span>);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span>.fromString(a,b);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>return new, unset BigInteger</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nbi</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> BigInteger(<span class="hljs-literal">null</span>); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>am: Compute w_j += (x<em>this_i), propagate carries,
c is initial carry, returns final carry.
c &lt; 3</em>dvalue, x &lt; 2*dvalue, this_i &lt; dvalue
We need to select the fastest one that works in this environment.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>am1: use a single mult and divide to get the high bits,
max digit bits should be 26 because
max internal value = 2<em>dvalue^2-2</em>dvalue (&lt; 2^53)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">am1</span>(<span class="hljs-params">i,x,w,j,c,n</span>) </span>{
      <span class="hljs-keyword">while</span>(--n &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> v = x*<span class="hljs-keyword">this</span>[i++]+w[j]+c;
        c = <span class="hljs-built_in">Math</span>.floor(v/<span class="hljs-number">0x4000000</span>);
        w[j++] = v&amp;<span class="hljs-number">0x3ffffff</span>;
      }
      <span class="hljs-keyword">return</span> c;
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>am2 avoids a big mult-and-extract completely.
Max digit bits should be &lt;= 30 because we do bitwise ops
on values up to 2*hdvalue^2-hdvalue-1 (&lt; 2^31)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">am2</span>(<span class="hljs-params">i,x,w,j,c,n</span>) </span>{
      <span class="hljs-keyword">var</span> xl = x&amp;<span class="hljs-number">0x7fff</span>, xh = x&gt;&gt;<span class="hljs-number">15</span>;
      <span class="hljs-keyword">while</span>(--n &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>[i]&amp;<span class="hljs-number">0x7fff</span>;
        <span class="hljs-keyword">var</span> h = <span class="hljs-keyword">this</span>[i++]&gt;&gt;<span class="hljs-number">15</span>;
        <span class="hljs-keyword">var</span> m = xh*l+h*xl;
        l = xl*l+((m&amp;<span class="hljs-number">0x7fff</span>)&lt;&lt;<span class="hljs-number">15</span>)+w[j]+(c&amp;<span class="hljs-number">0x3fffffff</span>);
        c = (l&gt;&gt;&gt;<span class="hljs-number">30</span>)+(m&gt;&gt;&gt;<span class="hljs-number">15</span>)+xh*h+(c&gt;&gt;&gt;<span class="hljs-number">30</span>);
        w[j++] = l&amp;<span class="hljs-number">0x3fffffff</span>;
      }
      <span class="hljs-keyword">return</span> c;
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Alternately, set max digit bits to 28 since some
browsers slow down when dealing with 32-bit numbers.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">am3</span>(<span class="hljs-params">i,x,w,j,c,n</span>) </span>{
      <span class="hljs-keyword">var</span> xl = x&amp;<span class="hljs-number">0x3fff</span>, xh = x&gt;&gt;<span class="hljs-number">14</span>;
      <span class="hljs-keyword">while</span>(--n &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> l = <span class="hljs-keyword">this</span>[i]&amp;<span class="hljs-number">0x3fff</span>;
        <span class="hljs-keyword">var</span> h = <span class="hljs-keyword">this</span>[i++]&gt;&gt;<span class="hljs-number">14</span>;
        <span class="hljs-keyword">var</span> m = xh*l+h*xl;
        l = xl*l+((m&amp;<span class="hljs-number">0x3fff</span>)&lt;&lt;<span class="hljs-number">14</span>)+w[j]+c;
        c = (l&gt;&gt;<span class="hljs-number">28</span>)+(m&gt;&gt;<span class="hljs-number">14</span>)+xh*h;
        w[j++] = l&amp;<span class="hljs-number">0xfffffff</span>;
      }
      <span class="hljs-keyword">return</span> c;
    }
    <span class="hljs-keyword">var</span> inBrowser = <span class="hljs-keyword">typeof</span> navigator !== <span class="hljs-string">"undefined"</span>;
    <span class="hljs-keyword">if</span>(inBrowser &amp;&amp; j_lm &amp;&amp; (navigator.appName == <span class="hljs-string">"Microsoft Internet Explorer"</span>)) {
      BigInteger.prototype.am = am2;
      dbits = <span class="hljs-number">30</span>;
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(inBrowser &amp;&amp; j_lm &amp;&amp; (navigator.appName != <span class="hljs-string">"Netscape"</span>)) {
      BigInteger.prototype.am = am1;
      dbits = <span class="hljs-number">26</span>;
    }
    <span class="hljs-keyword">else</span> { <span class="hljs-comment">// Mozilla/Netscape seems to prefer am3</span>
      BigInteger.prototype.am = am3;
      dbits = <span class="hljs-number">28</span>;
    }

    BigInteger.prototype.DB = dbits;
    BigInteger.prototype.DM = ((<span class="hljs-number">1</span>&lt;&lt;dbits)<span class="hljs-number">-1</span>);
    BigInteger.prototype.DV = (<span class="hljs-number">1</span>&lt;&lt;dbits);

    <span class="hljs-keyword">var</span> BI_FP = <span class="hljs-number">52</span>;
    BigInteger.prototype.FV = <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>,BI_FP);
    BigInteger.prototype.F1 = BI_FP-dbits;
    BigInteger.prototype.F2 = <span class="hljs-number">2</span>*dbits-BI_FP;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Digit conversions</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> BI_RM = <span class="hljs-string">"0123456789abcdefghijklmnopqrstuvwxyz"</span>;
    <span class="hljs-keyword">var</span> BI_RC = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
    <span class="hljs-keyword">var</span> rr,vv;
    rr = <span class="hljs-string">"0"</span>.charCodeAt(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">for</span>(vv = <span class="hljs-number">0</span>; vv &lt;= <span class="hljs-number">9</span>; ++vv) BI_RC[rr++] = vv;
    rr = <span class="hljs-string">"a"</span>.charCodeAt(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">for</span>(vv = <span class="hljs-number">10</span>; vv &lt; <span class="hljs-number">36</span>; ++vv) BI_RC[rr++] = vv;
    rr = <span class="hljs-string">"A"</span>.charCodeAt(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">for</span>(vv = <span class="hljs-number">10</span>; vv &lt; <span class="hljs-number">36</span>; ++vv) BI_RC[rr++] = vv;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">int2char</span>(<span class="hljs-params">n</span>) </span>{ <span class="hljs-keyword">return</span> BI_RM.charAt(n); }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">intAt</span>(<span class="hljs-params">s,i</span>) </span>{
      <span class="hljs-keyword">var</span> c = BI_RC[s.charCodeAt(i)];
      <span class="hljs-keyword">return</span> (c==<span class="hljs-literal">null</span>)?<span class="hljs-number">-1</span>:c;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>(protected) copy this to r</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpCopyTo</span>(<span class="hljs-params">r</span>) </span>{
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i) r[i] = <span class="hljs-keyword">this</span>[i];
      r.t = <span class="hljs-keyword">this</span>.t;
      r.s = <span class="hljs-keyword">this</span>.s;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>(protected) set from integer value x, -DV &lt;= x &lt; DV</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpFromInt</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">this</span>.t = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">this</span>.s = (x&lt;<span class="hljs-number">0</span>)?<span class="hljs-number">-1</span>:<span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span>(x &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>] = x;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(x &lt; <span class="hljs-number">-1</span>) <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>] = x+<span class="hljs-keyword">this</span>.DV;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span>.t = <span class="hljs-number">0</span>;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>return bigint initialized to value</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nbv</span>(<span class="hljs-params">i</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); r.fromInt(i); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>(protected) set from string and radix</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpFromString</span>(<span class="hljs-params">s,b</span>) </span>{
      <span class="hljs-keyword">var</span> k;
      <span class="hljs-keyword">if</span>(b == <span class="hljs-number">16</span>) k = <span class="hljs-number">4</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">8</span>) k = <span class="hljs-number">3</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">256</span>) k = <span class="hljs-number">8</span>; <span class="hljs-comment">// byte array</span>
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">2</span>) k = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">32</span>) k = <span class="hljs-number">5</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">4</span>) k = <span class="hljs-number">2</span>;
      <span class="hljs-keyword">else</span> { <span class="hljs-keyword">this</span>.fromRadix(s,b); <span class="hljs-keyword">return</span>; }
      <span class="hljs-keyword">this</span>.t = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">this</span>.s = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> i = s.length, mi = <span class="hljs-literal">false</span>, sh = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">while</span>(--i &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">var</span> x = (k==<span class="hljs-number">8</span>)?s[i]&amp;<span class="hljs-number">0xff</span>:intAt(s,i);
        <span class="hljs-keyword">if</span>(x &lt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span>(s.charAt(i) == <span class="hljs-string">"-"</span>) mi = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">continue</span>;
        }
        mi = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span>(sh == <span class="hljs-number">0</span>)
          <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t++] = x;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(sh+k &gt; <span class="hljs-keyword">this</span>.DB) {
          <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>] |= (x&amp;((<span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-keyword">this</span>.DB-sh))<span class="hljs-number">-1</span>))&lt;&lt;sh;
          <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t++] = (x&gt;&gt;(<span class="hljs-keyword">this</span>.DB-sh));
        }
        <span class="hljs-keyword">else</span>
          <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>] |= x&lt;&lt;sh;
        sh += k;
        <span class="hljs-keyword">if</span>(sh &gt;= <span class="hljs-keyword">this</span>.DB) sh -= <span class="hljs-keyword">this</span>.DB;
      }
      <span class="hljs-keyword">if</span>(k == <span class="hljs-number">8</span> &amp;&amp; (s[<span class="hljs-number">0</span>]&amp;<span class="hljs-number">0x80</span>) != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>.s = <span class="hljs-number">-1</span>;
        <span class="hljs-keyword">if</span>(sh &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>] |= ((<span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-keyword">this</span>.DB-sh))<span class="hljs-number">-1</span>)&lt;&lt;sh;
      }
      <span class="hljs-keyword">this</span>.clamp();
      <span class="hljs-keyword">if</span>(mi) BigInteger.ZERO.subTo(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>(protected) clamp off excess high words</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpClamp</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">this</span>.s&amp;<span class="hljs-keyword">this</span>.DM;
      <span class="hljs-keyword">while</span>(<span class="hljs-keyword">this</span>.t &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>] == c) --<span class="hljs-keyword">this</span>.t;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>(public) return string representation in given radix</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnToString</span>(<span class="hljs-params">b</span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.s &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"-"</span>+<span class="hljs-keyword">this</span>.negate().toString(b);
      <span class="hljs-keyword">var</span> k;
      <span class="hljs-keyword">if</span>(b == <span class="hljs-number">16</span>) k = <span class="hljs-number">4</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">8</span>) k = <span class="hljs-number">3</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">2</span>) k = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">32</span>) k = <span class="hljs-number">5</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(b == <span class="hljs-number">4</span>) k = <span class="hljs-number">2</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.toRadix(b);
      <span class="hljs-keyword">var</span> km = (<span class="hljs-number">1</span>&lt;&lt;k)<span class="hljs-number">-1</span>, d, m = <span class="hljs-literal">false</span>, r = <span class="hljs-string">""</span>, i = <span class="hljs-keyword">this</span>.t;
      <span class="hljs-keyword">var</span> p = <span class="hljs-keyword">this</span>.DB-(i*<span class="hljs-keyword">this</span>.DB)%k;
      <span class="hljs-keyword">if</span>(i-- &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span>(p &lt; <span class="hljs-keyword">this</span>.DB &amp;&amp; (d = <span class="hljs-keyword">this</span>[i]&gt;&gt;p) &gt; <span class="hljs-number">0</span>) { m = <span class="hljs-literal">true</span>; r = int2char(d); }
        <span class="hljs-keyword">while</span>(i &gt;= <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span>(p &lt; k) {
            d = (<span class="hljs-keyword">this</span>[i]&amp;((<span class="hljs-number">1</span>&lt;&lt;p)<span class="hljs-number">-1</span>))&lt;&lt;(k-p);
            d |= <span class="hljs-keyword">this</span>[--i]&gt;&gt;(p+=<span class="hljs-keyword">this</span>.DB-k);
          }
          <span class="hljs-keyword">else</span> {
            d = (<span class="hljs-keyword">this</span>[i]&gt;&gt;(p-=k))&amp;km;
            <span class="hljs-keyword">if</span>(p &lt;= <span class="hljs-number">0</span>) { p += <span class="hljs-keyword">this</span>.DB; --i; }
          }
          <span class="hljs-keyword">if</span>(d &gt; <span class="hljs-number">0</span>) m = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">if</span>(m) r += int2char(d);
        }
      }
      <span class="hljs-keyword">return</span> m?r:<span class="hljs-string">"0"</span>;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>(public) -this</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnNegate</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); BigInteger.ZERO.subTo(<span class="hljs-keyword">this</span>,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>(public) |this|</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnAbs</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.s&lt;<span class="hljs-number">0</span>)?<span class="hljs-keyword">this</span>.negate():<span class="hljs-keyword">this</span>; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>(public) return + if this &gt; a, - if this &lt; a, 0 if equal</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnCompareTo</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-keyword">var</span> r = <span class="hljs-keyword">this</span>.s-a.s;
      <span class="hljs-keyword">if</span>(r != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> r;
      <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.t;
      r = i-a.t;
      <span class="hljs-keyword">if</span>(r != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.s&lt;<span class="hljs-number">0</span>)?-r:r;
      <span class="hljs-keyword">while</span>(--i &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">if</span>((r=<span class="hljs-keyword">this</span>[i]-a[i]) != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> r;
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>returns bit length of the integer x</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nbits</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">var</span> r = <span class="hljs-number">1</span>, t;
      <span class="hljs-keyword">if</span>((t=x&gt;&gt;&gt;<span class="hljs-number">16</span>) != <span class="hljs-number">0</span>) { x = t; r += <span class="hljs-number">16</span>; }
      <span class="hljs-keyword">if</span>((t=x&gt;&gt;<span class="hljs-number">8</span>) != <span class="hljs-number">0</span>) { x = t; r += <span class="hljs-number">8</span>; }
      <span class="hljs-keyword">if</span>((t=x&gt;&gt;<span class="hljs-number">4</span>) != <span class="hljs-number">0</span>) { x = t; r += <span class="hljs-number">4</span>; }
      <span class="hljs-keyword">if</span>((t=x&gt;&gt;<span class="hljs-number">2</span>) != <span class="hljs-number">0</span>) { x = t; r += <span class="hljs-number">2</span>; }
      <span class="hljs-keyword">if</span>((t=x&gt;&gt;<span class="hljs-number">1</span>) != <span class="hljs-number">0</span>) { x = t; r += <span class="hljs-number">1</span>; }
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<p>(public) return the number of bits in &quot;this&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnBitLength</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.DB*(<span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>)+nbits(<span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>]^(<span class="hljs-keyword">this</span>.s&amp;<span class="hljs-keyword">this</span>.DM));
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<p>(protected) r = this &lt;&lt; n*DB</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpDLShiftTo</span>(<span class="hljs-params">n,r</span>) </span>{
      <span class="hljs-keyword">var</span> i;
      <span class="hljs-keyword">for</span>(i = <span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i) r[i+n] = <span class="hljs-keyword">this</span>[i];
      <span class="hljs-keyword">for</span>(i = n<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i) r[i] = <span class="hljs-number">0</span>;
      r.t = <span class="hljs-keyword">this</span>.t+n;
      r.s = <span class="hljs-keyword">this</span>.s;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<p>(protected) r = this &gt;&gt; n*DB</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpDRShiftTo</span>(<span class="hljs-params">n,r</span>) </span>{
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = n; i &lt; <span class="hljs-keyword">this</span>.t; ++i) r[i-n] = <span class="hljs-keyword">this</span>[i];
      r.t = <span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>.t-n,<span class="hljs-number">0</span>);
      r.s = <span class="hljs-keyword">this</span>.s;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<p>(protected) r = this &lt;&lt; n</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpLShiftTo</span>(<span class="hljs-params">n,r</span>) </span>{
      <span class="hljs-keyword">var</span> bs = n%<span class="hljs-keyword">this</span>.DB;
      <span class="hljs-keyword">var</span> cbs = <span class="hljs-keyword">this</span>.DB-bs;
      <span class="hljs-keyword">var</span> bm = (<span class="hljs-number">1</span>&lt;&lt;cbs)<span class="hljs-number">-1</span>;
      <span class="hljs-keyword">var</span> ds = <span class="hljs-built_in">Math</span>.floor(n/<span class="hljs-keyword">this</span>.DB), c = (<span class="hljs-keyword">this</span>.s&lt;&lt;bs)&amp;<span class="hljs-keyword">this</span>.DM, i;
      <span class="hljs-keyword">for</span>(i = <span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i) {
        r[i+ds+<span class="hljs-number">1</span>] = (<span class="hljs-keyword">this</span>[i]&gt;&gt;cbs)|c;
        c = (<span class="hljs-keyword">this</span>[i]&amp;bm)&lt;&lt;bs;
      }
      <span class="hljs-keyword">for</span>(i = ds<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i) r[i] = <span class="hljs-number">0</span>;
      r[ds] = c;
      r.t = <span class="hljs-keyword">this</span>.t+ds+<span class="hljs-number">1</span>;
      r.s = <span class="hljs-keyword">this</span>.s;
      r.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>(protected) r = this &gt;&gt; n</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpRShiftTo</span>(<span class="hljs-params">n,r</span>) </span>{
      r.s = <span class="hljs-keyword">this</span>.s;
      <span class="hljs-keyword">var</span> ds = <span class="hljs-built_in">Math</span>.floor(n/<span class="hljs-keyword">this</span>.DB);
      <span class="hljs-keyword">if</span>(ds &gt;= <span class="hljs-keyword">this</span>.t) { r.t = <span class="hljs-number">0</span>; <span class="hljs-keyword">return</span>; }
      <span class="hljs-keyword">var</span> bs = n%<span class="hljs-keyword">this</span>.DB;
      <span class="hljs-keyword">var</span> cbs = <span class="hljs-keyword">this</span>.DB-bs;
      <span class="hljs-keyword">var</span> bm = (<span class="hljs-number">1</span>&lt;&lt;bs)<span class="hljs-number">-1</span>;
      r[<span class="hljs-number">0</span>] = <span class="hljs-keyword">this</span>[ds]&gt;&gt;bs;
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = ds+<span class="hljs-number">1</span>; i &lt; <span class="hljs-keyword">this</span>.t; ++i) {
        r[i-ds<span class="hljs-number">-1</span>] |= (<span class="hljs-keyword">this</span>[i]&amp;bm)&lt;&lt;cbs;
        r[i-ds] = <span class="hljs-keyword">this</span>[i]&gt;&gt;bs;
      }
      <span class="hljs-keyword">if</span>(bs &gt; <span class="hljs-number">0</span>) r[<span class="hljs-keyword">this</span>.t-ds<span class="hljs-number">-1</span>] |= (<span class="hljs-keyword">this</span>.s&amp;bm)&lt;&lt;cbs;
      r.t = <span class="hljs-keyword">this</span>.t-ds;
      r.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>(protected) r = this - a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpSubTo</span>(<span class="hljs-params">a,r</span>) </span>{
      <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, c = <span class="hljs-number">0</span>, m = <span class="hljs-built_in">Math</span>.min(a.t,<span class="hljs-keyword">this</span>.t);
      <span class="hljs-keyword">while</span>(i &lt; m) {
        c += <span class="hljs-keyword">this</span>[i]-a[i];
        r[i++] = c&amp;<span class="hljs-keyword">this</span>.DM;
        c &gt;&gt;= <span class="hljs-keyword">this</span>.DB;
      }
      <span class="hljs-keyword">if</span>(a.t &lt; <span class="hljs-keyword">this</span>.t) {
        c -= a.s;
        <span class="hljs-keyword">while</span>(i &lt; <span class="hljs-keyword">this</span>.t) {
          c += <span class="hljs-keyword">this</span>[i];
          r[i++] = c&amp;<span class="hljs-keyword">this</span>.DM;
          c &gt;&gt;= <span class="hljs-keyword">this</span>.DB;
        }
        c += <span class="hljs-keyword">this</span>.s;
      }
      <span class="hljs-keyword">else</span> {
        c += <span class="hljs-keyword">this</span>.s;
        <span class="hljs-keyword">while</span>(i &lt; a.t) {
          c -= a[i];
          r[i++] = c&amp;<span class="hljs-keyword">this</span>.DM;
          c &gt;&gt;= <span class="hljs-keyword">this</span>.DB;
        }
        c -= a.s;
      }
      r.s = (c&lt;<span class="hljs-number">0</span>)?<span class="hljs-number">-1</span>:<span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span>(c &lt; <span class="hljs-number">-1</span>) r[i++] = <span class="hljs-keyword">this</span>.DV+c;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(c &gt; <span class="hljs-number">0</span>) r[i++] = c;
      r.t = i;
      r.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p>(protected) r = this * a, r != this,a (HAC 14.12)
&quot;this&quot; should be the larger one if appropriate.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpMultiplyTo</span>(<span class="hljs-params">a,r</span>) </span>{
      <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>.abs(), y = a.abs();
      <span class="hljs-keyword">var</span> i = x.t;
      r.t = i+y.t;
      <span class="hljs-keyword">while</span>(--i &gt;= <span class="hljs-number">0</span>) r[i] = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; y.t; ++i) r[i+x.t] = x.am(<span class="hljs-number">0</span>,y[i],r,i,<span class="hljs-number">0</span>,x.t);
      r.s = <span class="hljs-number">0</span>;
      r.clamp();
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.s != a.s) BigInteger.ZERO.subTo(r,r);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<p>(protected) r = this^2, r != this (HAC 14.16)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpSquareTo</span>(<span class="hljs-params">r</span>) </span>{
      <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>.abs();
      <span class="hljs-keyword">var</span> i = r.t = <span class="hljs-number">2</span>*x.t;
      <span class="hljs-keyword">while</span>(--i &gt;= <span class="hljs-number">0</span>) r[i] = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; x.t<span class="hljs-number">-1</span>; ++i) {
        <span class="hljs-keyword">var</span> c = x.am(i,x[i],r,<span class="hljs-number">2</span>*i,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
        <span class="hljs-keyword">if</span>((r[i+x.t]+=x.am(i+<span class="hljs-number">1</span>,<span class="hljs-number">2</span>*x[i],r,<span class="hljs-number">2</span>*i+<span class="hljs-number">1</span>,c,x.t-i<span class="hljs-number">-1</span>)) &gt;= x.DV) {
          r[i+x.t] -= x.DV;
          r[i+x.t+<span class="hljs-number">1</span>] = <span class="hljs-number">1</span>;
        }
      }
      <span class="hljs-keyword">if</span>(r.t &gt; <span class="hljs-number">0</span>) r[r.t<span class="hljs-number">-1</span>] += x.am(i,x[i],r,<span class="hljs-number">2</span>*i,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>);
      r.s = <span class="hljs-number">0</span>;
      r.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<p>(protected) divide this by m, quotient and remainder to q, r (HAC 14.20)
r != q, this != m.  q or r may be null.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpDivRemTo</span>(<span class="hljs-params">m,q,r</span>) </span>{
      <span class="hljs-keyword">var</span> pm = m.abs();
      <span class="hljs-keyword">if</span>(pm.t &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">var</span> pt = <span class="hljs-keyword">this</span>.abs();
      <span class="hljs-keyword">if</span>(pt.t &lt; pm.t) {
        <span class="hljs-keyword">if</span>(q != <span class="hljs-literal">null</span>) q.fromInt(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">if</span>(r != <span class="hljs-literal">null</span>) <span class="hljs-keyword">this</span>.copyTo(r);
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">if</span>(r == <span class="hljs-literal">null</span>) r = nbi();
      <span class="hljs-keyword">var</span> y = nbi(), ts = <span class="hljs-keyword">this</span>.s, ms = m.s;
      <span class="hljs-keyword">var</span> nsh = <span class="hljs-keyword">this</span>.DB-nbits(pm[pm.t<span class="hljs-number">-1</span>]);   <span class="hljs-comment">// normalize modulus</span>
      <span class="hljs-keyword">if</span>(nsh &gt; <span class="hljs-number">0</span>) { pm.lShiftTo(nsh,y); pt.lShiftTo(nsh,r); }
      <span class="hljs-keyword">else</span> { pm.copyTo(y); pt.copyTo(r); }
      <span class="hljs-keyword">var</span> ys = y.t;
      <span class="hljs-keyword">var</span> y0 = y[ys<span class="hljs-number">-1</span>];
      <span class="hljs-keyword">if</span>(y0 == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">var</span> yt = y0*(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-keyword">this</span>.F1)+((ys&gt;<span class="hljs-number">1</span>)?y[ys<span class="hljs-number">-2</span>]&gt;&gt;<span class="hljs-keyword">this</span>.F2:<span class="hljs-number">0</span>);
      <span class="hljs-keyword">var</span> d1 = <span class="hljs-keyword">this</span>.FV/yt, d2 = (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-keyword">this</span>.F1)/yt, e = <span class="hljs-number">1</span>&lt;&lt;<span class="hljs-keyword">this</span>.F2;
      <span class="hljs-keyword">var</span> i = r.t, j = i-ys, t = (q==<span class="hljs-literal">null</span>)?nbi():q;
      y.dlShiftTo(j,t);
      <span class="hljs-keyword">if</span>(r.compareTo(t) &gt;= <span class="hljs-number">0</span>) {
        r[r.t++] = <span class="hljs-number">1</span>;
        r.subTo(t,r);
      }
      BigInteger.ONE.dlShiftTo(ys,t);
      t.subTo(y,y);  <span class="hljs-comment">// "negative" y so we can replace sub with am later</span>
      <span class="hljs-keyword">while</span>(y.t &lt; ys) y[y.t++] = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">while</span>(--j &gt;= <span class="hljs-number">0</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<p>Estimate quotient digit</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> qd = (r[--i]==y0)?<span class="hljs-keyword">this</span>.DM:<span class="hljs-built_in">Math</span>.floor(r[i]*d1+(r[i<span class="hljs-number">-1</span>]+e)*d2);
        <span class="hljs-keyword">if</span>((r[i]+=y.am(<span class="hljs-number">0</span>,qd,r,j,<span class="hljs-number">0</span>,ys)) &lt; qd) {   <span class="hljs-comment">// Try it out</span>
          y.dlShiftTo(j,t);
          r.subTo(t,r);
          <span class="hljs-keyword">while</span>(r[i] &lt; --qd) r.subTo(t,r);
        }
      }
      <span class="hljs-keyword">if</span>(q != <span class="hljs-literal">null</span>) {
        r.drShiftTo(ys,q);
        <span class="hljs-keyword">if</span>(ts != ms) BigInteger.ZERO.subTo(q,q);
      }
      r.t = ys;
      r.clamp();
      <span class="hljs-keyword">if</span>(nsh &gt; <span class="hljs-number">0</span>) r.rShiftTo(nsh,r); <span class="hljs-comment">// Denormalize remainder</span>
      <span class="hljs-keyword">if</span>(ts &lt; <span class="hljs-number">0</span>) BigInteger.ZERO.subTo(r,r);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<p>(public) this mod a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnMod</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-keyword">var</span> r = nbi();
      <span class="hljs-keyword">this</span>.abs().divRemTo(a,<span class="hljs-literal">null</span>,r);
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.s &lt; <span class="hljs-number">0</span> &amp;&amp; r.compareTo(BigInteger.ZERO) &gt; <span class="hljs-number">0</span>) a.subTo(r,r);
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>Modular reduction using &quot;classic&quot; algorithm</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Classic</span>(<span class="hljs-params">m</span>) </span>{ <span class="hljs-keyword">this</span>.m = m; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cConvert</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">if</span>(x.s &lt; <span class="hljs-number">0</span> || x.compareTo(<span class="hljs-keyword">this</span>.m) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> x.mod(<span class="hljs-keyword">this</span>.m);
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> x;
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cRevert</span>(<span class="hljs-params">x</span>) </span>{ <span class="hljs-keyword">return</span> x; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cReduce</span>(<span class="hljs-params">x</span>) </span>{ x.divRemTo(<span class="hljs-keyword">this</span>.m,<span class="hljs-literal">null</span>,x); }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cMulTo</span>(<span class="hljs-params">x,y,r</span>) </span>{ x.multiplyTo(y,r); <span class="hljs-keyword">this</span>.reduce(r); }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cSqrTo</span>(<span class="hljs-params">x,r</span>) </span>{ x.squareTo(r); <span class="hljs-keyword">this</span>.reduce(r); }

    Classic.prototype.convert = cConvert;
    Classic.prototype.revert = cRevert;
    Classic.prototype.reduce = cReduce;
    Classic.prototype.mulTo = cMulTo;
    Classic.prototype.sqrTo = cSqrTo;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<p>(protected) return &quot;-1/this % 2^DB&quot;; useful for Mont. reduction
justification:
xy == 1 (mod m)
xy =  1+km
xy(2-xy) = (1+km)(1-km)
x[y(2-xy)] = 1-k^2m^2
x[y(2-xy)] == 1 (mod m^2)
if y is 1/x mod m, then y(2-xy) is 1/x mod m^2
should reduce x and y(2-xy) by m^2 at each step to keep size bounded.
JS multiply &quot;overflows&quot; differently from C/C++, so care is needed here.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpInvDigit</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t &lt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">if</span>((x&amp;<span class="hljs-number">1</span>) == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> y = x&amp;<span class="hljs-number">3</span>;       <span class="hljs-comment">// y == 1/x mod 2^2</span>
      y = (y*(<span class="hljs-number">2</span>-(x&amp;<span class="hljs-number">0xf</span>)*y))&amp;<span class="hljs-number">0xf</span>; <span class="hljs-comment">// y == 1/x mod 2^4</span>
      y = (y*(<span class="hljs-number">2</span>-(x&amp;<span class="hljs-number">0xff</span>)*y))&amp;<span class="hljs-number">0xff</span>;   <span class="hljs-comment">// y == 1/x mod 2^8</span>
      y = (y*(<span class="hljs-number">2</span>-(((x&amp;<span class="hljs-number">0xffff</span>)*y)&amp;<span class="hljs-number">0xffff</span>)))&amp;<span class="hljs-number">0xffff</span>;    <span class="hljs-comment">// y == 1/x mod 2^16</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>last step - calculate inverse mod DV directly;
assumes 16 &lt; DB &lt;= 32 and assumes ability to handle 48-bit ints</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      y = (y*(<span class="hljs-number">2</span>-x*y%<span class="hljs-keyword">this</span>.DV))%<span class="hljs-keyword">this</span>.DV;       <span class="hljs-comment">// y == 1/x mod 2^dbits</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<p>we really want the negative inverse, and -DV &lt; y &lt; DV</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">return</span> (y&gt;<span class="hljs-number">0</span>)?<span class="hljs-keyword">this</span>.DV-y:-y;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<p>Montgomery reduction</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Montgomery</span>(<span class="hljs-params">m</span>) </span>{
      <span class="hljs-keyword">this</span>.m = m;
      <span class="hljs-keyword">this</span>.mp = m.invDigit();
      <span class="hljs-keyword">this</span>.mpl = <span class="hljs-keyword">this</span>.mp&amp;<span class="hljs-number">0x7fff</span>;
      <span class="hljs-keyword">this</span>.mph = <span class="hljs-keyword">this</span>.mp&gt;&gt;<span class="hljs-number">15</span>;
      <span class="hljs-keyword">this</span>.um = (<span class="hljs-number">1</span>&lt;&lt;(m.DB<span class="hljs-number">-15</span>))<span class="hljs-number">-1</span>;
      <span class="hljs-keyword">this</span>.mt2 = <span class="hljs-number">2</span>*m.t;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<p>xR mod m</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">montConvert</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">var</span> r = nbi();
      x.abs().dlShiftTo(<span class="hljs-keyword">this</span>.m.t,r);
      r.divRemTo(<span class="hljs-keyword">this</span>.m,<span class="hljs-literal">null</span>,r);
      <span class="hljs-keyword">if</span>(x.s &lt; <span class="hljs-number">0</span> &amp;&amp; r.compareTo(BigInteger.ZERO) &gt; <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>.m.subTo(r,r);
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<p>x/R mod m</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">montRevert</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">var</span> r = nbi();
      x.copyTo(r);
      <span class="hljs-keyword">this</span>.reduce(r);
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<p>x = x/R mod m (HAC 14.32)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">montReduce</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">while</span>(x.t &lt;= <span class="hljs-keyword">this</span>.mt2) <span class="hljs-comment">// pad x so am has enough room later</span>
        x[x.t++] = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.m.t; ++i) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42"></a>
</div>
<p>faster way of calculating u0 = x[i]*mp mod DV</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> j = x[i]&amp;<span class="hljs-number">0x7fff</span>;
        <span class="hljs-keyword">var</span> u0 = (j*<span class="hljs-keyword">this</span>.mpl+(((j*<span class="hljs-keyword">this</span>.mph+(x[i]&gt;&gt;<span class="hljs-number">15</span>)*<span class="hljs-keyword">this</span>.mpl)&amp;<span class="hljs-keyword">this</span>.um)&lt;&lt;<span class="hljs-number">15</span>))&amp;x.DM;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<p>use am to combine the multiply-shift-add into one call</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        j = i+<span class="hljs-keyword">this</span>.m.t;
        x[j] += <span class="hljs-keyword">this</span>.m.am(<span class="hljs-number">0</span>,u0,x,i,<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.m.t);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>propagate carry</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">while</span>(x[j] &gt;= x.DV) { x[j] -= x.DV; x[++j]++; }
      }
      x.clamp();
      x.drShiftTo(<span class="hljs-keyword">this</span>.m.t,x);
      <span class="hljs-keyword">if</span>(x.compareTo(<span class="hljs-keyword">this</span>.m) &gt;= <span class="hljs-number">0</span>) x.subTo(<span class="hljs-keyword">this</span>.m,x);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>r = &quot;x^2/R mod m&quot;; x != r</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">montSqrTo</span>(<span class="hljs-params">x,r</span>) </span>{ x.squareTo(r); <span class="hljs-keyword">this</span>.reduce(r); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>r = &quot;xy/R mod m&quot;; x,y != r</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">montMulTo</span>(<span class="hljs-params">x,y,r</span>) </span>{ x.multiplyTo(y,r); <span class="hljs-keyword">this</span>.reduce(r); }

    Montgomery.prototype.convert = montConvert;
    Montgomery.prototype.revert = montRevert;
    Montgomery.prototype.reduce = montReduce;
    Montgomery.prototype.mulTo = montMulTo;
    Montgomery.prototype.sqrTo = montSqrTo;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<p>(protected) true iff this is even</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpIsEven</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">this</span>.t&gt;<span class="hljs-number">0</span>)?(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>]&amp;<span class="hljs-number">1</span>):<span class="hljs-keyword">this</span>.s) == <span class="hljs-number">0</span>; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<p>(protected) this^e, e &lt; 2^32, doing sqr and mul with &quot;r&quot; (HAC 14.79)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpExp</span>(<span class="hljs-params">e,z</span>) </span>{
      <span class="hljs-keyword">if</span>(e &gt; <span class="hljs-number">0xffffffff</span> || e &lt; <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> BigInteger.ONE;
      <span class="hljs-keyword">var</span> r = nbi(), r2 = nbi(), g = z.convert(<span class="hljs-keyword">this</span>), i = nbits(e)<span class="hljs-number">-1</span>;
      g.copyTo(r);
      <span class="hljs-keyword">while</span>(--i &gt;= <span class="hljs-number">0</span>) {
        z.sqrTo(r,r2);
        <span class="hljs-keyword">if</span>((e&amp;(<span class="hljs-number">1</span>&lt;&lt;i)) &gt; <span class="hljs-number">0</span>) z.mulTo(r2,g,r);
        <span class="hljs-keyword">else</span> { <span class="hljs-keyword">var</span> t = r; r = r2; r2 = t; }
      }
      <span class="hljs-keyword">return</span> z.revert(r);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<p>(public) this^e % m, 0 &lt;= e &lt; 2^32</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnModPowInt</span>(<span class="hljs-params">e,m</span>) </span>{
      <span class="hljs-keyword">var</span> z;
      <span class="hljs-keyword">if</span>(e &lt; <span class="hljs-number">256</span> || m.isEven()) z = <span class="hljs-keyword">new</span> Classic(m); <span class="hljs-keyword">else</span> z = <span class="hljs-keyword">new</span> Montgomery(m);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.exp(e,z);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>protected</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    BigInteger.prototype.copyTo = bnpCopyTo;
    BigInteger.prototype.fromInt = bnpFromInt;
    BigInteger.prototype.fromString = bnpFromString;
    BigInteger.prototype.clamp = bnpClamp;
    BigInteger.prototype.dlShiftTo = bnpDLShiftTo;
    BigInteger.prototype.drShiftTo = bnpDRShiftTo;
    BigInteger.prototype.lShiftTo = bnpLShiftTo;
    BigInteger.prototype.rShiftTo = bnpRShiftTo;
    BigInteger.prototype.subTo = bnpSubTo;
    BigInteger.prototype.multiplyTo = bnpMultiplyTo;
    BigInteger.prototype.squareTo = bnpSquareTo;
    BigInteger.prototype.divRemTo = bnpDivRemTo;
    BigInteger.prototype.invDigit = bnpInvDigit;
    BigInteger.prototype.isEven = bnpIsEven;
    BigInteger.prototype.exp = bnpExp;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<p>public</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    BigInteger.prototype.toString = bnToString;
    BigInteger.prototype.negate = bnNegate;
    BigInteger.prototype.abs = bnAbs;
    BigInteger.prototype.compareTo = bnCompareTo;
    BigInteger.prototype.bitLength = bnBitLength;
    BigInteger.prototype.mod = bnMod;
    BigInteger.prototype.modPowInt = bnModPowInt;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<p>&quot;constants&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    BigInteger.ZERO = nbv(<span class="hljs-number">0</span>);
    BigInteger.ONE = nbv(<span class="hljs-number">1</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<p>Copyright (c) 2005-2009  Tom Wu
All Rights Reserved.
See &quot;LICENSE&quot; for details.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<p>Extended JavaScript BN functions, required for RSA private ops.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<p>Version 1.1: new BigInteger(&quot;0&quot;, 10) returns &quot;proper&quot; zero
Version 1.2: square() API, isProbablePrime fix</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<p>(public)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnClone</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.copyTo(r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<p>(public) return value as integer</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnIntValue</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.s &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>]-<span class="hljs-keyword">this</span>.DV;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
      }
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t == <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<p>assumes 16 &lt; DB &lt; 32</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">return</span> ((<span class="hljs-keyword">this</span>[<span class="hljs-number">1</span>]&amp;((<span class="hljs-number">1</span>&lt;&lt;(<span class="hljs-number">32</span>-<span class="hljs-keyword">this</span>.DB))<span class="hljs-number">-1</span>))&lt;&lt;<span class="hljs-keyword">this</span>.DB)|<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59"></a>
</div>
<p>(public) return value as byte</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnByteValue</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.t==<span class="hljs-number">0</span>)?<span class="hljs-keyword">this</span>.s:(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">24</span>)&gt;&gt;<span class="hljs-number">24</span>; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60"></a>
</div>
<p>(public) return value as short (assumes DB&gt;=16)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnShortValue</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.t==<span class="hljs-number">0</span>)?<span class="hljs-keyword">this</span>.s:(<span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>]&lt;&lt;<span class="hljs-number">16</span>)&gt;&gt;<span class="hljs-number">16</span>; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61"></a>
</div>
<p>(protected) return x s.t. r^x &lt; DV</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpChunkSize</span>(<span class="hljs-params">r</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.LN2*<span class="hljs-keyword">this</span>.DB/<span class="hljs-built_in">Math</span>.log(r)); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62"></a>
</div>
<p>(public) 0 if this == 0, 1 if this &gt; 0</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnSigNum</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.s &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t &lt;= <span class="hljs-number">0</span> || (<span class="hljs-keyword">this</span>.t == <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>] &lt;= <span class="hljs-number">0</span>)) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63"></a>
</div>
<p>(protected) convert to radix string</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpToRadix</span>(<span class="hljs-params">b</span>) </span>{
      <span class="hljs-keyword">if</span>(b == <span class="hljs-literal">null</span>) b = <span class="hljs-number">10</span>;
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.signum() == <span class="hljs-number">0</span> || b &lt; <span class="hljs-number">2</span> || b &gt; <span class="hljs-number">36</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"0"</span>;
      <span class="hljs-keyword">var</span> cs = <span class="hljs-keyword">this</span>.chunkSize(b);
      <span class="hljs-keyword">var</span> a = <span class="hljs-built_in">Math</span>.pow(b,cs);
      <span class="hljs-keyword">var</span> d = nbv(a), y = nbi(), z = nbi(), r = <span class="hljs-string">""</span>;
      <span class="hljs-keyword">this</span>.divRemTo(d,y,z);
      <span class="hljs-keyword">while</span>(y.signum() &gt; <span class="hljs-number">0</span>) {
        r = (a+z.intValue()).toString(b).substr(<span class="hljs-number">1</span>) + r;
        y.divRemTo(d,y,z);
      }
      <span class="hljs-keyword">return</span> z.intValue().toString(b) + r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64"></a>
</div>
<p>(protected) convert from radix string</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpFromRadix</span>(<span class="hljs-params">s,b</span>) </span>{
      <span class="hljs-keyword">this</span>.fromInt(<span class="hljs-number">0</span>);
      <span class="hljs-keyword">if</span>(b == <span class="hljs-literal">null</span>) b = <span class="hljs-number">10</span>;
      <span class="hljs-keyword">var</span> cs = <span class="hljs-keyword">this</span>.chunkSize(b);
      <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">Math</span>.pow(b,cs), mi = <span class="hljs-literal">false</span>, j = <span class="hljs-number">0</span>, w = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; s.length; ++i) {
        <span class="hljs-keyword">var</span> x = intAt(s,i);
        <span class="hljs-keyword">if</span>(x &lt; <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span>(s.charAt(i) == <span class="hljs-string">"-"</span> &amp;&amp; <span class="hljs-keyword">this</span>.signum() == <span class="hljs-number">0</span>) mi = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">continue</span>;
        }
        w = b*w+x;
        <span class="hljs-keyword">if</span>(++j &gt;= cs) {
          <span class="hljs-keyword">this</span>.dMultiply(d);
          <span class="hljs-keyword">this</span>.dAddOffset(w,<span class="hljs-number">0</span>);
          j = <span class="hljs-number">0</span>;
          w = <span class="hljs-number">0</span>;
        }
      }
      <span class="hljs-keyword">if</span>(j &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>.dMultiply(<span class="hljs-built_in">Math</span>.pow(b,j));
        <span class="hljs-keyword">this</span>.dAddOffset(w,<span class="hljs-number">0</span>);
      }
      <span class="hljs-keyword">if</span>(mi) BigInteger.ZERO.subTo(<span class="hljs-keyword">this</span>,<span class="hljs-keyword">this</span>);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65"></a>
</div>
<p>(protected) alternate constructor</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpFromNumber</span>(<span class="hljs-params">a,b,c</span>) </span>{
      <span class="hljs-keyword">if</span>(<span class="hljs-string">"number"</span> == <span class="hljs-keyword">typeof</span> b) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66"></a>
</div>
<p>new BigInteger(int,int,RNG)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span>(a &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">this</span>.fromInt(<span class="hljs-number">1</span>);
        <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">this</span>.fromNumber(a,c);
          <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.testBit(a<span class="hljs-number">-1</span>))	<span class="hljs-comment">// force MSB set</span>
            <span class="hljs-keyword">this</span>.bitwiseTo(BigInteger.ONE.shiftLeft(a<span class="hljs-number">-1</span>),op_or,<span class="hljs-keyword">this</span>);
          <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.isEven()) <span class="hljs-keyword">this</span>.dAddOffset(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>); <span class="hljs-comment">// force odd</span>
          <span class="hljs-keyword">while</span>(!<span class="hljs-keyword">this</span>.isProbablePrime(b)) {
            <span class="hljs-keyword">this</span>.dAddOffset(<span class="hljs-number">2</span>,<span class="hljs-number">0</span>);
            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.bitLength() &gt; a) <span class="hljs-keyword">this</span>.subTo(BigInteger.ONE.shiftLeft(a<span class="hljs-number">-1</span>),<span class="hljs-keyword">this</span>);
          }
        }
      }
      <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67"></a>
</div>
<p>new BigInteger(int,RNG)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> x = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(), t = a&amp;<span class="hljs-number">7</span>;
        x.length = (a&gt;&gt;<span class="hljs-number">3</span>)+<span class="hljs-number">1</span>;
        b.nextBytes(x);
        <span class="hljs-keyword">if</span>(t &gt; <span class="hljs-number">0</span>) x[<span class="hljs-number">0</span>] &amp;= ((<span class="hljs-number">1</span>&lt;&lt;t)<span class="hljs-number">-1</span>); <span class="hljs-keyword">else</span> x[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.fromString(x,<span class="hljs-number">256</span>);
      }
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68"></a>
</div>
<p>(public) convert to bigendian byte array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnToByteArray</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.t, r = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
      r[<span class="hljs-number">0</span>] = <span class="hljs-keyword">this</span>.s;
      <span class="hljs-keyword">var</span> p = <span class="hljs-keyword">this</span>.DB-(i*<span class="hljs-keyword">this</span>.DB)%<span class="hljs-number">8</span>, d, k = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span>(i-- &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span>(p &lt; <span class="hljs-keyword">this</span>.DB &amp;&amp; (d = <span class="hljs-keyword">this</span>[i]&gt;&gt;p) != (<span class="hljs-keyword">this</span>.s&amp;<span class="hljs-keyword">this</span>.DM)&gt;&gt;p)
          r[k++] = d|(<span class="hljs-keyword">this</span>.s&lt;&lt;(<span class="hljs-keyword">this</span>.DB-p));
        <span class="hljs-keyword">while</span>(i &gt;= <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">if</span>(p &lt; <span class="hljs-number">8</span>) {
            d = (<span class="hljs-keyword">this</span>[i]&amp;((<span class="hljs-number">1</span>&lt;&lt;p)<span class="hljs-number">-1</span>))&lt;&lt;(<span class="hljs-number">8</span>-p);
            d |= <span class="hljs-keyword">this</span>[--i]&gt;&gt;(p+=<span class="hljs-keyword">this</span>.DB<span class="hljs-number">-8</span>);
          }
          <span class="hljs-keyword">else</span> {
            d = (<span class="hljs-keyword">this</span>[i]&gt;&gt;(p-=<span class="hljs-number">8</span>))&amp;<span class="hljs-number">0xff</span>;
            <span class="hljs-keyword">if</span>(p &lt;= <span class="hljs-number">0</span>) { p += <span class="hljs-keyword">this</span>.DB; --i; }
          }
          <span class="hljs-keyword">if</span>((d&amp;<span class="hljs-number">0x80</span>) != <span class="hljs-number">0</span>) d |= <span class="hljs-number">-256</span>;
          <span class="hljs-keyword">if</span>(k == <span class="hljs-number">0</span> &amp;&amp; (<span class="hljs-keyword">this</span>.s&amp;<span class="hljs-number">0x80</span>) != (d&amp;<span class="hljs-number">0x80</span>)) ++k;
          <span class="hljs-keyword">if</span>(k &gt; <span class="hljs-number">0</span> || d != <span class="hljs-keyword">this</span>.s) r[k++] = d;
        }
      }
      <span class="hljs-keyword">return</span> r;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnEquals</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span>(<span class="hljs-keyword">this</span>.compareTo(a)==<span class="hljs-number">0</span>); }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnMin</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span>(<span class="hljs-keyword">this</span>.compareTo(a)&lt;<span class="hljs-number">0</span>)?<span class="hljs-keyword">this</span>:a; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnMax</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">return</span>(<span class="hljs-keyword">this</span>.compareTo(a)&gt;<span class="hljs-number">0</span>)?<span class="hljs-keyword">this</span>:a; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69"></a>
</div>
<p>(protected) r = this op a (bitwise)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpBitwiseTo</span>(<span class="hljs-params">a,op,r</span>) </span>{
      <span class="hljs-keyword">var</span> i, f, m = <span class="hljs-built_in">Math</span>.min(a.t,<span class="hljs-keyword">this</span>.t);
      <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; m; ++i) r[i] = op(<span class="hljs-keyword">this</span>[i],a[i]);
      <span class="hljs-keyword">if</span>(a.t &lt; <span class="hljs-keyword">this</span>.t) {
        f = a.s&amp;<span class="hljs-keyword">this</span>.DM;
        <span class="hljs-keyword">for</span>(i = m; i &lt; <span class="hljs-keyword">this</span>.t; ++i) r[i] = op(<span class="hljs-keyword">this</span>[i],f);
        r.t = <span class="hljs-keyword">this</span>.t;
      }
      <span class="hljs-keyword">else</span> {
        f = <span class="hljs-keyword">this</span>.s&amp;<span class="hljs-keyword">this</span>.DM;
        <span class="hljs-keyword">for</span>(i = m; i &lt; a.t; ++i) r[i] = op(f,a[i]);
        r.t = a.t;
      }
      r.s = op(<span class="hljs-keyword">this</span>.s,a.s);
      r.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70"></a>
</div>
<p>(public) this &amp; a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">op_and</span>(<span class="hljs-params">x,y</span>) </span>{ <span class="hljs-keyword">return</span> x&amp;y; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnAnd</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.bitwiseTo(a,op_and,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-71" id="section-71"></a>
</div>
<p>(public) this | a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">op_or</span>(<span class="hljs-params">x,y</span>) </span>{ <span class="hljs-keyword">return</span> x|y; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnOr</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.bitwiseTo(a,op_or,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72"></a>
</div>
<p>(public) this ^ a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">op_xor</span>(<span class="hljs-params">x,y</span>) </span>{ <span class="hljs-keyword">return</span> x^y; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnXor</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.bitwiseTo(a,op_xor,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73"></a>
</div>
<p>(public) this &amp; ~a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">op_andnot</span>(<span class="hljs-params">x,y</span>) </span>{ <span class="hljs-keyword">return</span> x&amp;~y; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnAndNot</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.bitwiseTo(a,op_andnot,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74"></a>
</div>
<p>(public) ~this</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnNot</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> r = nbi();
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.t; ++i) r[i] = <span class="hljs-keyword">this</span>.DM&amp;~<span class="hljs-keyword">this</span>[i];
      r.t = <span class="hljs-keyword">this</span>.t;
      r.s = ~<span class="hljs-keyword">this</span>.s;
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-75" id="section-75"></a>
</div>
<p>(public) this &lt;&lt; n</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnShiftLeft</span>(<span class="hljs-params">n</span>) </span>{
      <span class="hljs-keyword">var</span> r = nbi();
      <span class="hljs-keyword">if</span>(n &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>.rShiftTo(-n,r); <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span>.lShiftTo(n,r);
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76"></a>
</div>
<p>(public) this &gt;&gt; n</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnShiftRight</span>(<span class="hljs-params">n</span>) </span>{
      <span class="hljs-keyword">var</span> r = nbi();
      <span class="hljs-keyword">if</span>(n &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>.lShiftTo(-n,r); <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span>.rShiftTo(n,r);
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77"></a>
</div>
<p>return index of lowest 1-bit in x, x &lt; 2^31</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">lbit</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">if</span>(x == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
      <span class="hljs-keyword">var</span> r = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span>((x&amp;<span class="hljs-number">0xffff</span>) == <span class="hljs-number">0</span>) { x &gt;&gt;= <span class="hljs-number">16</span>; r += <span class="hljs-number">16</span>; }
      <span class="hljs-keyword">if</span>((x&amp;<span class="hljs-number">0xff</span>) == <span class="hljs-number">0</span>) { x &gt;&gt;= <span class="hljs-number">8</span>; r += <span class="hljs-number">8</span>; }
      <span class="hljs-keyword">if</span>((x&amp;<span class="hljs-number">0xf</span>) == <span class="hljs-number">0</span>) { x &gt;&gt;= <span class="hljs-number">4</span>; r += <span class="hljs-number">4</span>; }
      <span class="hljs-keyword">if</span>((x&amp;<span class="hljs-number">3</span>) == <span class="hljs-number">0</span>) { x &gt;&gt;= <span class="hljs-number">2</span>; r += <span class="hljs-number">2</span>; }
      <span class="hljs-keyword">if</span>((x&amp;<span class="hljs-number">1</span>) == <span class="hljs-number">0</span>) ++r;
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78"></a>
</div>
<p>(public) returns index of lowest 1-bit (or -1 if none)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnGetLowestSetBit</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.t; ++i)
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>[i] != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> i*<span class="hljs-keyword">this</span>.DB+lbit(<span class="hljs-keyword">this</span>[i]);
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.s &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.t*<span class="hljs-keyword">this</span>.DB;
      <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79"></a>
</div>
<p>return number of 1 bits in x</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cbit</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">var</span> r = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">while</span>(x != <span class="hljs-number">0</span>) { x &amp;= x<span class="hljs-number">-1</span>; ++r; }
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-80" id="section-80"></a>
</div>
<p>(public) return number of set bits</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnBitCount</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> r = <span class="hljs-number">0</span>, x = <span class="hljs-keyword">this</span>.s&amp;<span class="hljs-keyword">this</span>.DM;
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.t; ++i) r += cbit(<span class="hljs-keyword">this</span>[i]^x);
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-81" id="section-81"></a>
</div>
<p>(public) true iff nth bit is set</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnTestBit</span>(<span class="hljs-params">n</span>) </span>{
      <span class="hljs-keyword">var</span> j = <span class="hljs-built_in">Math</span>.floor(n/<span class="hljs-keyword">this</span>.DB);
      <span class="hljs-keyword">if</span>(j &gt;= <span class="hljs-keyword">this</span>.t) <span class="hljs-keyword">return</span>(<span class="hljs-keyword">this</span>.s!=<span class="hljs-number">0</span>);
      <span class="hljs-keyword">return</span>((<span class="hljs-keyword">this</span>[j]&amp;(<span class="hljs-number">1</span>&lt;&lt;(n%<span class="hljs-keyword">this</span>.DB)))!=<span class="hljs-number">0</span>);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-82" id="section-82"></a>
</div>
<p>(protected) this op (1&lt;&lt;n)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpChangeBit</span>(<span class="hljs-params">n,op</span>) </span>{
      <span class="hljs-keyword">var</span> r = BigInteger.ONE.shiftLeft(n);
      <span class="hljs-keyword">this</span>.bitwiseTo(r,op,r);
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-83" id="section-83"></a>
</div>
<p>(public) this | (1&lt;&lt;n)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnSetBit</span>(<span class="hljs-params">n</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.changeBit(n,op_or); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-84" id="section-84"></a>
</div>
<p>(public) this &amp; ~(1&lt;&lt;n)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnClearBit</span>(<span class="hljs-params">n</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.changeBit(n,op_andnot); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-85" id="section-85"></a>
</div>
<p>(public) this ^ (1&lt;&lt;n)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnFlipBit</span>(<span class="hljs-params">n</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.changeBit(n,op_xor); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-86" id="section-86"></a>
</div>
<p>(protected) r = this + a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpAddTo</span>(<span class="hljs-params">a,r</span>) </span>{
      <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, c = <span class="hljs-number">0</span>, m = <span class="hljs-built_in">Math</span>.min(a.t,<span class="hljs-keyword">this</span>.t);
      <span class="hljs-keyword">while</span>(i &lt; m) {
        c += <span class="hljs-keyword">this</span>[i]+a[i];
        r[i++] = c&amp;<span class="hljs-keyword">this</span>.DM;
        c &gt;&gt;= <span class="hljs-keyword">this</span>.DB;
      }
      <span class="hljs-keyword">if</span>(a.t &lt; <span class="hljs-keyword">this</span>.t) {
        c += a.s;
        <span class="hljs-keyword">while</span>(i &lt; <span class="hljs-keyword">this</span>.t) {
          c += <span class="hljs-keyword">this</span>[i];
          r[i++] = c&amp;<span class="hljs-keyword">this</span>.DM;
          c &gt;&gt;= <span class="hljs-keyword">this</span>.DB;
        }
        c += <span class="hljs-keyword">this</span>.s;
      }
      <span class="hljs-keyword">else</span> {
        c += <span class="hljs-keyword">this</span>.s;
        <span class="hljs-keyword">while</span>(i &lt; a.t) {
          c += a[i];
          r[i++] = c&amp;<span class="hljs-keyword">this</span>.DM;
          c &gt;&gt;= <span class="hljs-keyword">this</span>.DB;
        }
        c += a.s;
      }
      r.s = (c&lt;<span class="hljs-number">0</span>)?<span class="hljs-number">-1</span>:<span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span>(c &gt; <span class="hljs-number">0</span>) r[i++] = c;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(c &lt; <span class="hljs-number">-1</span>) r[i++] = <span class="hljs-keyword">this</span>.DV+c;
      r.t = i;
      r.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-87" id="section-87"></a>
</div>
<p>(public) this + a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnAdd</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.addTo(a,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-88" id="section-88"></a>
</div>
<p>(public) this - a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnSubtract</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.subTo(a,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-89" id="section-89"></a>
</div>
<p>(public) this * a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnMultiply</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.multiplyTo(a,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-90" id="section-90"></a>
</div>
<p>(public) this^2</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnSquare</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.squareTo(r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-91" id="section-91"></a>
</div>
<p>(public) this / a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnDivide</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.divRemTo(a,r,<span class="hljs-literal">null</span>); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-92" id="section-92"></a>
</div>
<p>(public) this % a</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnRemainder</span>(<span class="hljs-params">a</span>) </span>{ <span class="hljs-keyword">var</span> r = nbi(); <span class="hljs-keyword">this</span>.divRemTo(a,<span class="hljs-literal">null</span>,r); <span class="hljs-keyword">return</span> r; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-93" id="section-93"></a>
</div>
<p>(public) [this/a,this%a]</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnDivideAndRemainder</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-keyword">var</span> q = nbi(), r = nbi();
      <span class="hljs-keyword">this</span>.divRemTo(a,q,r);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(q,r);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-94" id="section-94"></a>
</div>
<p>(protected) this *= n, this &gt;= 0, 1 &lt; n &lt; DV</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpDMultiply</span>(<span class="hljs-params">n</span>) </span>{
      <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t] = <span class="hljs-keyword">this</span>.am(<span class="hljs-number">0</span>,n<span class="hljs-number">-1</span>,<span class="hljs-keyword">this</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.t);
      ++<span class="hljs-keyword">this</span>.t;
      <span class="hljs-keyword">this</span>.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-95" id="section-95"></a>
</div>
<p>(protected) this += n &lt;&lt; w words, this &gt;= 0</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpDAddOffset</span>(<span class="hljs-params">n,w</span>) </span>{
      <span class="hljs-keyword">if</span>(n == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
      <span class="hljs-keyword">while</span>(<span class="hljs-keyword">this</span>.t &lt;= w) <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t++] = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">this</span>[w] += n;
      <span class="hljs-keyword">while</span>(<span class="hljs-keyword">this</span>[w] &gt;= <span class="hljs-keyword">this</span>.DV) {
        <span class="hljs-keyword">this</span>[w] -= <span class="hljs-keyword">this</span>.DV;
        <span class="hljs-keyword">if</span>(++w &gt;= <span class="hljs-keyword">this</span>.t) <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.t++] = <span class="hljs-number">0</span>;
        ++<span class="hljs-keyword">this</span>[w];
      }
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-96" id="section-96"></a>
</div>
<p>A &quot;null&quot; reducer</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NullExp</span>(<span class="hljs-params"></span>) </span>{}
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nNop</span>(<span class="hljs-params">x</span>) </span>{ <span class="hljs-keyword">return</span> x; }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nMulTo</span>(<span class="hljs-params">x,y,r</span>) </span>{ x.multiplyTo(y,r); }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nSqrTo</span>(<span class="hljs-params">x,r</span>) </span>{ x.squareTo(r); }

    NullExp.prototype.convert = nNop;
    NullExp.prototype.revert = nNop;
    NullExp.prototype.mulTo = nMulTo;
    NullExp.prototype.sqrTo = nSqrTo;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-97" id="section-97"></a>
</div>
<p>(public) this^e</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnPow</span>(<span class="hljs-params">e</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.exp(e,<span class="hljs-keyword">new</span> NullExp()); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-98" id="section-98"></a>
</div>
<p>(protected) r = lower n words of &quot;this * a&quot;, a.t &lt;= n
&quot;this&quot; should be the larger one if appropriate.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpMultiplyLowerTo</span>(<span class="hljs-params">a,n,r</span>) </span>{
      <span class="hljs-keyword">var</span> i = <span class="hljs-built_in">Math</span>.min(<span class="hljs-keyword">this</span>.t+a.t,n);
      r.s = <span class="hljs-number">0</span>; <span class="hljs-comment">// assumes a,this &gt;= 0</span>
      r.t = i;
      <span class="hljs-keyword">while</span>(i &gt; <span class="hljs-number">0</span>) r[--i] = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> j;
      <span class="hljs-keyword">for</span>(j = r.t-<span class="hljs-keyword">this</span>.t; i &lt; j; ++i) r[i+<span class="hljs-keyword">this</span>.t] = <span class="hljs-keyword">this</span>.am(<span class="hljs-number">0</span>,a[i],r,i,<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.t);
      <span class="hljs-keyword">for</span>(j = <span class="hljs-built_in">Math</span>.min(a.t,n); i &lt; j; ++i) <span class="hljs-keyword">this</span>.am(<span class="hljs-number">0</span>,a[i],r,i,<span class="hljs-number">0</span>,n-i);
      r.clamp();
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-99" id="section-99"></a>
</div>
<p>(protected) r = &quot;this * a&quot; without lower n words, n &gt; 0
&quot;this&quot; should be the larger one if appropriate.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpMultiplyUpperTo</span>(<span class="hljs-params">a,n,r</span>) </span>{
      --n;
      <span class="hljs-keyword">var</span> i = r.t = <span class="hljs-keyword">this</span>.t+a.t-n;
      r.s = <span class="hljs-number">0</span>; <span class="hljs-comment">// assumes a,this &gt;= 0</span>
      <span class="hljs-keyword">while</span>(--i &gt;= <span class="hljs-number">0</span>) r[i] = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span>(i = <span class="hljs-built_in">Math</span>.max(n-<span class="hljs-keyword">this</span>.t,<span class="hljs-number">0</span>); i &lt; a.t; ++i)
        r[<span class="hljs-keyword">this</span>.t+i-n] = <span class="hljs-keyword">this</span>.am(n-i,a[i],r,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-keyword">this</span>.t+i-n);
      r.clamp();
      r.drShiftTo(<span class="hljs-number">1</span>,r);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-100" id="section-100"></a>
</div>
<p>Barrett modular reduction</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Barrett</span>(<span class="hljs-params">m</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-101" id="section-101"></a>
</div>
<p>setup Barrett</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">this</span>.r2 = nbi();
      <span class="hljs-keyword">this</span>.q3 = nbi();
      BigInteger.ONE.dlShiftTo(<span class="hljs-number">2</span>*m.t,<span class="hljs-keyword">this</span>.r2);
      <span class="hljs-keyword">this</span>.mu = <span class="hljs-keyword">this</span>.r2.divide(m);
      <span class="hljs-keyword">this</span>.m = m;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">barrettConvert</span>(<span class="hljs-params">x</span>) </span>{
      <span class="hljs-keyword">if</span>(x.s &lt; <span class="hljs-number">0</span> || x.t &gt; <span class="hljs-number">2</span>*<span class="hljs-keyword">this</span>.m.t) <span class="hljs-keyword">return</span> x.mod(<span class="hljs-keyword">this</span>.m);
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(x.compareTo(<span class="hljs-keyword">this</span>.m) &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> x;
      <span class="hljs-keyword">else</span> { <span class="hljs-keyword">var</span> r = nbi(); x.copyTo(r); <span class="hljs-keyword">this</span>.reduce(r); <span class="hljs-keyword">return</span> r; }
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">barrettRevert</span>(<span class="hljs-params">x</span>) </span>{ <span class="hljs-keyword">return</span> x; }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-102" id="section-102"></a>
</div>
<p>x = x mod m (HAC 14.42)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">barrettReduce</span>(<span class="hljs-params">x</span>) </span>{
      x.drShiftTo(<span class="hljs-keyword">this</span>.m.t<span class="hljs-number">-1</span>,<span class="hljs-keyword">this</span>.r2);
      <span class="hljs-keyword">if</span>(x.t &gt; <span class="hljs-keyword">this</span>.m.t+<span class="hljs-number">1</span>) { x.t = <span class="hljs-keyword">this</span>.m.t+<span class="hljs-number">1</span>; x.clamp(); }
      <span class="hljs-keyword">this</span>.mu.multiplyUpperTo(<span class="hljs-keyword">this</span>.r2,<span class="hljs-keyword">this</span>.m.t+<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.q3);
      <span class="hljs-keyword">this</span>.m.multiplyLowerTo(<span class="hljs-keyword">this</span>.q3,<span class="hljs-keyword">this</span>.m.t+<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.r2);
      <span class="hljs-keyword">while</span>(x.compareTo(<span class="hljs-keyword">this</span>.r2) &lt; <span class="hljs-number">0</span>) x.dAddOffset(<span class="hljs-number">1</span>,<span class="hljs-keyword">this</span>.m.t+<span class="hljs-number">1</span>);
      x.subTo(<span class="hljs-keyword">this</span>.r2,x);
      <span class="hljs-keyword">while</span>(x.compareTo(<span class="hljs-keyword">this</span>.m) &gt;= <span class="hljs-number">0</span>) x.subTo(<span class="hljs-keyword">this</span>.m,x);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-103" id="section-103"></a>
</div>
<p>r = x^2 mod m; x != r</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">barrettSqrTo</span>(<span class="hljs-params">x,r</span>) </span>{ x.squareTo(r); <span class="hljs-keyword">this</span>.reduce(r); }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-104" id="section-104"></a>
</div>
<p>r = x*y mod m; x,y != r</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">barrettMulTo</span>(<span class="hljs-params">x,y,r</span>) </span>{ x.multiplyTo(y,r); <span class="hljs-keyword">this</span>.reduce(r); }

    Barrett.prototype.convert = barrettConvert;
    Barrett.prototype.revert = barrettRevert;
    Barrett.prototype.reduce = barrettReduce;
    Barrett.prototype.mulTo = barrettMulTo;
    Barrett.prototype.sqrTo = barrettSqrTo;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-105" id="section-105"></a>
</div>
<p>(public) this^e % m (HAC 14.85)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnModPow</span>(<span class="hljs-params">e,m</span>) </span>{
      <span class="hljs-keyword">var</span> i = e.bitLength(), k, r = nbv(<span class="hljs-number">1</span>), z;
      <span class="hljs-keyword">if</span>(i &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> r;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">18</span>) k = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">48</span>) k = <span class="hljs-number">3</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">144</span>) k = <span class="hljs-number">4</span>;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">768</span>) k = <span class="hljs-number">5</span>;
      <span class="hljs-keyword">else</span> k = <span class="hljs-number">6</span>;
      <span class="hljs-keyword">if</span>(i &lt; <span class="hljs-number">8</span>)
        z = <span class="hljs-keyword">new</span> Classic(m);
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(m.isEven())
        z = <span class="hljs-keyword">new</span> Barrett(m);
      <span class="hljs-keyword">else</span>
        z = <span class="hljs-keyword">new</span> Montgomery(m);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-106" id="section-106"></a>
</div>
<p>precomputation</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      <span class="hljs-keyword">var</span> g = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(), n = <span class="hljs-number">3</span>, k1 = k<span class="hljs-number">-1</span>, km = (<span class="hljs-number">1</span>&lt;&lt;k)<span class="hljs-number">-1</span>;
      g[<span class="hljs-number">1</span>] = z.convert(<span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">if</span>(k &gt; <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">var</span> g2 = nbi();
        z.sqrTo(g[<span class="hljs-number">1</span>],g2);
        <span class="hljs-keyword">while</span>(n &lt;= km) {
          g[n] = nbi();
          z.mulTo(g2,g[n<span class="hljs-number">-2</span>],g[n]);
          n += <span class="hljs-number">2</span>;
        }
      }

      <span class="hljs-keyword">var</span> j = e.t<span class="hljs-number">-1</span>, w, is1 = <span class="hljs-literal">true</span>, r2 = nbi(), t;
      i = nbits(e[j])<span class="hljs-number">-1</span>;
      <span class="hljs-keyword">while</span>(j &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span>(i &gt;= k1) w = (e[j]&gt;&gt;(i-k1))&amp;km;
        <span class="hljs-keyword">else</span> {
          w = (e[j]&amp;((<span class="hljs-number">1</span>&lt;&lt;(i+<span class="hljs-number">1</span>))<span class="hljs-number">-1</span>))&lt;&lt;(k1-i);
          <span class="hljs-keyword">if</span>(j &gt; <span class="hljs-number">0</span>) w |= e[j<span class="hljs-number">-1</span>]&gt;&gt;(<span class="hljs-keyword">this</span>.DB+i-k1);
        }

        n = k;
        <span class="hljs-keyword">while</span>((w&amp;<span class="hljs-number">1</span>) == <span class="hljs-number">0</span>) { w &gt;&gt;= <span class="hljs-number">1</span>; --n; }
        <span class="hljs-keyword">if</span>((i -= n) &lt; <span class="hljs-number">0</span>) { i += <span class="hljs-keyword">this</span>.DB; --j; }
        <span class="hljs-keyword">if</span>(is1) {	<span class="hljs-comment">// ret == 1, don't bother squaring or multiplying it</span>
          g[w].copyTo(r);
          is1 = <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">while</span>(n &gt; <span class="hljs-number">1</span>) { z.sqrTo(r,r2); z.sqrTo(r2,r); n -= <span class="hljs-number">2</span>; }
          <span class="hljs-keyword">if</span>(n &gt; <span class="hljs-number">0</span>) z.sqrTo(r,r2); <span class="hljs-keyword">else</span> { t = r; r = r2; r2 = t; }
          z.mulTo(r2,g[w],r);
        }

        <span class="hljs-keyword">while</span>(j &gt;= <span class="hljs-number">0</span> &amp;&amp; (e[j]&amp;(<span class="hljs-number">1</span>&lt;&lt;i)) == <span class="hljs-number">0</span>) {
          z.sqrTo(r,r2); t = r; r = r2; r2 = t;
          <span class="hljs-keyword">if</span>(--i &lt; <span class="hljs-number">0</span>) { i = <span class="hljs-keyword">this</span>.DB<span class="hljs-number">-1</span>; --j; }
        }
      }
      <span class="hljs-keyword">return</span> z.revert(r);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-107" id="section-107"></a>
</div>
<p>(public) gcd(this,a) (HAC 14.54)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnGCD</span>(<span class="hljs-params">a</span>) </span>{
      <span class="hljs-keyword">var</span> x = (<span class="hljs-keyword">this</span>.s&lt;<span class="hljs-number">0</span>)?<span class="hljs-keyword">this</span>.negate():<span class="hljs-keyword">this</span>.clone();
      <span class="hljs-keyword">var</span> y = (a.s&lt;<span class="hljs-number">0</span>)?a.negate():a.clone();
      <span class="hljs-keyword">if</span>(x.compareTo(y) &lt; <span class="hljs-number">0</span>) { <span class="hljs-keyword">var</span> t = x; x = y; y = t; }
      <span class="hljs-keyword">var</span> i = x.getLowestSetBit(), g = y.getLowestSetBit();
      <span class="hljs-keyword">if</span>(g &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> x;
      <span class="hljs-keyword">if</span>(i &lt; g) g = i;
      <span class="hljs-keyword">if</span>(g &gt; <span class="hljs-number">0</span>) {
        x.rShiftTo(g,x);
        y.rShiftTo(g,y);
      }
      <span class="hljs-keyword">while</span>(x.signum() &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span>((i = x.getLowestSetBit()) &gt; <span class="hljs-number">0</span>) x.rShiftTo(i,x);
        <span class="hljs-keyword">if</span>((i = y.getLowestSetBit()) &gt; <span class="hljs-number">0</span>) y.rShiftTo(i,y);
        <span class="hljs-keyword">if</span>(x.compareTo(y) &gt;= <span class="hljs-number">0</span>) {
          x.subTo(y,x);
          x.rShiftTo(<span class="hljs-number">1</span>,x);
        }
        <span class="hljs-keyword">else</span> {
          y.subTo(x,y);
          y.rShiftTo(<span class="hljs-number">1</span>,y);
        }
      }
      <span class="hljs-keyword">if</span>(g &gt; <span class="hljs-number">0</span>) y.lShiftTo(g,y);
      <span class="hljs-keyword">return</span> y;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-108" id="section-108"></a>
</div>
<p>(protected) this % n, n &lt; 2^26</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpModInt</span>(<span class="hljs-params">n</span>) </span>{
      <span class="hljs-keyword">if</span>(n &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      <span class="hljs-keyword">var</span> d = <span class="hljs-keyword">this</span>.DV%n, r = (<span class="hljs-keyword">this</span>.s&lt;<span class="hljs-number">0</span>)?n<span class="hljs-number">-1</span>:<span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.t &gt; <span class="hljs-number">0</span>)
        <span class="hljs-keyword">if</span>(d == <span class="hljs-number">0</span>) r = <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>]%n;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-keyword">this</span>.t<span class="hljs-number">-1</span>; i &gt;= <span class="hljs-number">0</span>; --i) r = (d*r+<span class="hljs-keyword">this</span>[i])%n;
      <span class="hljs-keyword">return</span> r;
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-109" id="section-109"></a>
</div>
<p>(public) 1/this % m (HAC 14.61)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnModInverse</span>(<span class="hljs-params">m</span>) </span>{
      <span class="hljs-keyword">var</span> ac = m.isEven();
      <span class="hljs-keyword">if</span>((<span class="hljs-keyword">this</span>.isEven() &amp;&amp; ac) || m.signum() == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> BigInteger.ZERO;
      <span class="hljs-keyword">var</span> u = m.clone(), v = <span class="hljs-keyword">this</span>.clone();
      <span class="hljs-keyword">var</span> a = nbv(<span class="hljs-number">1</span>), b = nbv(<span class="hljs-number">0</span>), c = nbv(<span class="hljs-number">0</span>), d = nbv(<span class="hljs-number">1</span>);
      <span class="hljs-keyword">while</span>(u.signum() != <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">while</span>(u.isEven()) {
          u.rShiftTo(<span class="hljs-number">1</span>,u);
          <span class="hljs-keyword">if</span>(ac) {
            <span class="hljs-keyword">if</span>(!a.isEven() || !b.isEven()) { a.addTo(<span class="hljs-keyword">this</span>,a); b.subTo(m,b); }
            a.rShiftTo(<span class="hljs-number">1</span>,a);
          }
          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!b.isEven()) b.subTo(m,b);
          b.rShiftTo(<span class="hljs-number">1</span>,b);
        }
        <span class="hljs-keyword">while</span>(v.isEven()) {
          v.rShiftTo(<span class="hljs-number">1</span>,v);
          <span class="hljs-keyword">if</span>(ac) {
            <span class="hljs-keyword">if</span>(!c.isEven() || !d.isEven()) { c.addTo(<span class="hljs-keyword">this</span>,c); d.subTo(m,d); }
            c.rShiftTo(<span class="hljs-number">1</span>,c);
          }
          <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!d.isEven()) d.subTo(m,d);
          d.rShiftTo(<span class="hljs-number">1</span>,d);
        }
        <span class="hljs-keyword">if</span>(u.compareTo(v) &gt;= <span class="hljs-number">0</span>) {
          u.subTo(v,u);
          <span class="hljs-keyword">if</span>(ac) a.subTo(c,a);
          b.subTo(d,b);
        }
        <span class="hljs-keyword">else</span> {
          v.subTo(u,v);
          <span class="hljs-keyword">if</span>(ac) c.subTo(a,c);
          d.subTo(b,d);
        }
      }
      <span class="hljs-keyword">if</span>(v.compareTo(BigInteger.ONE) != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> BigInteger.ZERO;
      <span class="hljs-keyword">if</span>(d.compareTo(m) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> d.subtract(m);
      <span class="hljs-keyword">if</span>(d.signum() &lt; <span class="hljs-number">0</span>) d.addTo(m,d); <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> d;
      <span class="hljs-keyword">if</span>(d.signum() &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> d.add(m); <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> d;
    }

    <span class="hljs-keyword">var</span> lowprimes = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">7</span>,<span class="hljs-number">11</span>,<span class="hljs-number">13</span>,<span class="hljs-number">17</span>,<span class="hljs-number">19</span>,<span class="hljs-number">23</span>,<span class="hljs-number">29</span>,<span class="hljs-number">31</span>,<span class="hljs-number">37</span>,<span class="hljs-number">41</span>,<span class="hljs-number">43</span>,<span class="hljs-number">47</span>,<span class="hljs-number">53</span>,<span class="hljs-number">59</span>,<span class="hljs-number">61</span>,<span class="hljs-number">67</span>,<span class="hljs-number">71</span>,<span class="hljs-number">73</span>,<span class="hljs-number">79</span>,<span class="hljs-number">83</span>,<span class="hljs-number">89</span>,<span class="hljs-number">97</span>,<span class="hljs-number">101</span>,<span class="hljs-number">103</span>,<span class="hljs-number">107</span>,<span class="hljs-number">109</span>,<span class="hljs-number">113</span>,<span class="hljs-number">127</span>,<span class="hljs-number">131</span>,<span class="hljs-number">137</span>,<span class="hljs-number">139</span>,<span class="hljs-number">149</span>,<span class="hljs-number">151</span>,<span class="hljs-number">157</span>,<span class="hljs-number">163</span>,<span class="hljs-number">167</span>,<span class="hljs-number">173</span>,<span class="hljs-number">179</span>,<span class="hljs-number">181</span>,<span class="hljs-number">191</span>,<span class="hljs-number">193</span>,<span class="hljs-number">197</span>,<span class="hljs-number">199</span>,<span class="hljs-number">211</span>,<span class="hljs-number">223</span>,<span class="hljs-number">227</span>,<span class="hljs-number">229</span>,<span class="hljs-number">233</span>,<span class="hljs-number">239</span>,<span class="hljs-number">241</span>,<span class="hljs-number">251</span>,<span class="hljs-number">257</span>,<span class="hljs-number">263</span>,<span class="hljs-number">269</span>,<span class="hljs-number">271</span>,<span class="hljs-number">277</span>,<span class="hljs-number">281</span>,<span class="hljs-number">283</span>,<span class="hljs-number">293</span>,<span class="hljs-number">307</span>,<span class="hljs-number">311</span>,<span class="hljs-number">313</span>,<span class="hljs-number">317</span>,<span class="hljs-number">331</span>,<span class="hljs-number">337</span>,<span class="hljs-number">347</span>,<span class="hljs-number">349</span>,<span class="hljs-number">353</span>,<span class="hljs-number">359</span>,<span class="hljs-number">367</span>,<span class="hljs-number">373</span>,<span class="hljs-number">379</span>,<span class="hljs-number">383</span>,<span class="hljs-number">389</span>,<span class="hljs-number">397</span>,<span class="hljs-number">401</span>,<span class="hljs-number">409</span>,<span class="hljs-number">419</span>,<span class="hljs-number">421</span>,<span class="hljs-number">431</span>,<span class="hljs-number">433</span>,<span class="hljs-number">439</span>,<span class="hljs-number">443</span>,<span class="hljs-number">449</span>,<span class="hljs-number">457</span>,<span class="hljs-number">461</span>,<span class="hljs-number">463</span>,<span class="hljs-number">467</span>,<span class="hljs-number">479</span>,<span class="hljs-number">487</span>,<span class="hljs-number">491</span>,<span class="hljs-number">499</span>,<span class="hljs-number">503</span>,<span class="hljs-number">509</span>,<span class="hljs-number">521</span>,<span class="hljs-number">523</span>,<span class="hljs-number">541</span>,<span class="hljs-number">547</span>,<span class="hljs-number">557</span>,<span class="hljs-number">563</span>,<span class="hljs-number">569</span>,<span class="hljs-number">571</span>,<span class="hljs-number">577</span>,<span class="hljs-number">587</span>,<span class="hljs-number">593</span>,<span class="hljs-number">599</span>,<span class="hljs-number">601</span>,<span class="hljs-number">607</span>,<span class="hljs-number">613</span>,<span class="hljs-number">617</span>,<span class="hljs-number">619</span>,<span class="hljs-number">631</span>,<span class="hljs-number">641</span>,<span class="hljs-number">643</span>,<span class="hljs-number">647</span>,<span class="hljs-number">653</span>,<span class="hljs-number">659</span>,<span class="hljs-number">661</span>,<span class="hljs-number">673</span>,<span class="hljs-number">677</span>,<span class="hljs-number">683</span>,<span class="hljs-number">691</span>,<span class="hljs-number">701</span>,<span class="hljs-number">709</span>,<span class="hljs-number">719</span>,<span class="hljs-number">727</span>,<span class="hljs-number">733</span>,<span class="hljs-number">739</span>,<span class="hljs-number">743</span>,<span class="hljs-number">751</span>,<span class="hljs-number">757</span>,<span class="hljs-number">761</span>,<span class="hljs-number">769</span>,<span class="hljs-number">773</span>,<span class="hljs-number">787</span>,<span class="hljs-number">797</span>,<span class="hljs-number">809</span>,<span class="hljs-number">811</span>,<span class="hljs-number">821</span>,<span class="hljs-number">823</span>,<span class="hljs-number">827</span>,<span class="hljs-number">829</span>,<span class="hljs-number">839</span>,<span class="hljs-number">853</span>,<span class="hljs-number">857</span>,<span class="hljs-number">859</span>,<span class="hljs-number">863</span>,<span class="hljs-number">877</span>,<span class="hljs-number">881</span>,<span class="hljs-number">883</span>,<span class="hljs-number">887</span>,<span class="hljs-number">907</span>,<span class="hljs-number">911</span>,<span class="hljs-number">919</span>,<span class="hljs-number">929</span>,<span class="hljs-number">937</span>,<span class="hljs-number">941</span>,<span class="hljs-number">947</span>,<span class="hljs-number">953</span>,<span class="hljs-number">967</span>,<span class="hljs-number">971</span>,<span class="hljs-number">977</span>,<span class="hljs-number">983</span>,<span class="hljs-number">991</span>,<span class="hljs-number">997</span>];
    <span class="hljs-keyword">var</span> lplim = (<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">26</span>)/lowprimes[lowprimes.length<span class="hljs-number">-1</span>];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-110" id="section-110"></a>
</div>
<p>(public) test primality with certainty &gt;= 1-.5^t</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnIsProbablePrime</span>(<span class="hljs-params">t</span>) </span>{
      <span class="hljs-keyword">var</span> i, x = <span class="hljs-keyword">this</span>.abs();
      <span class="hljs-keyword">if</span>(x.t == <span class="hljs-number">1</span> &amp;&amp; x[<span class="hljs-number">0</span>] &lt;= lowprimes[lowprimes.length<span class="hljs-number">-1</span>]) {
        <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; lowprimes.length; ++i)
          <span class="hljs-keyword">if</span>(x[<span class="hljs-number">0</span>] == lowprimes[i]) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
      <span class="hljs-keyword">if</span>(x.isEven()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      i = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">while</span>(i &lt; lowprimes.length) {
        <span class="hljs-keyword">var</span> m = lowprimes[i], j = i+<span class="hljs-number">1</span>;
        <span class="hljs-keyword">while</span>(j &lt; lowprimes.length &amp;&amp; m &lt; lplim) m *= lowprimes[j++];
        m = x.modInt(m);
        <span class="hljs-keyword">while</span>(i &lt; j) <span class="hljs-keyword">if</span>(m%lowprimes[i++] == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
      <span class="hljs-keyword">return</span> x.millerRabin(t);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-111" id="section-111"></a>
</div>
<p>(protected) true if probably prime (HAC 4.24, Miller-Rabin)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bnpMillerRabin</span>(<span class="hljs-params">t</span>) </span>{
      <span class="hljs-keyword">var</span> n1 = <span class="hljs-keyword">this</span>.subtract(BigInteger.ONE);
      <span class="hljs-keyword">var</span> k = n1.getLowestSetBit();
      <span class="hljs-keyword">if</span>(k &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">var</span> r = n1.shiftRight(k);
      t = (t+<span class="hljs-number">1</span>)&gt;&gt;<span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span>(t &gt; lowprimes.length) t = lowprimes.length;
      <span class="hljs-keyword">var</span> a = nbi();
      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; t; ++i) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-112" id="section-112"></a>
</div>
<p>Pick bases at random, instead of starting at 2</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        a.fromInt(lowprimes[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random()*lowprimes.length)]);
        <span class="hljs-keyword">var</span> y = a.modPow(r,<span class="hljs-keyword">this</span>);
        <span class="hljs-keyword">if</span>(y.compareTo(BigInteger.ONE) != <span class="hljs-number">0</span> &amp;&amp; y.compareTo(n1) != <span class="hljs-number">0</span>) {
          <span class="hljs-keyword">var</span> j = <span class="hljs-number">1</span>;
          <span class="hljs-keyword">while</span>(j++ <span class="xml"><span class="hljs-tag">&lt; <span class="hljs-attr">k</span> &amp;&amp; <span class="hljs-attr">y.compareTo</span>(<span class="hljs-attr">n1</span>) != <span class="hljs-string">0)</span> {
            <span class="hljs-attr">y</span> = <span class="hljs-string">y.modPowInt(2,this);</span>
            <span class="hljs-attr">if</span>(<span class="hljs-attr">y.compareTo</span>(<span class="hljs-attr">BigInteger.ONE</span>) == <span class="hljs-string">0)</span> <span class="hljs-attr">return</span> <span class="hljs-attr">false</span>;
          }
          <span class="hljs-attr">if</span>(<span class="hljs-attr">y.compareTo</span>(<span class="hljs-attr">n1</span>) != <span class="hljs-string">0)</span> <span class="hljs-attr">return</span> <span class="hljs-attr">false</span>;
        }
      }
      <span class="hljs-attr">return</span> <span class="hljs-attr">true</span>;
    }

</span></span></pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-113" id="section-113"></a>
</div>
<p>protected</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    BigInteger.prototype.chunkSize = bnpChunkSize;
    BigInteger.prototype.toRadix = bnpToRadix;
    BigInteger.prototype.fromRadix = bnpFromRadix;
    BigInteger.prototype.fromNumber = bnpFromNumber;
    BigInteger.prototype.bitwiseTo = bnpBitwiseTo;
    BigInteger.prototype.changeBit = bnpChangeBit;
    BigInteger.prototype.addTo = bnpAddTo;
    BigInteger.prototype.dMultiply = bnpDMultiply;
    BigInteger.prototype.dAddOffset = bnpDAddOffset;
    BigInteger.prototype.multiplyLowerTo = bnpMultiplyLowerTo;
    BigInteger.prototype.multiplyUpperTo = bnpMultiplyUpperTo;
    BigInteger.prototype.modInt = bnpModInt;
    BigInteger.prototype.millerRabin = bnpMillerRabin;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-114" id="section-114"></a>
</div>
<p>public</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    BigInteger.prototype.clone = bnClone;
    BigInteger.prototype.intValue = bnIntValue;
    BigInteger.prototype.byteValue = bnByteValue;
    BigInteger.prototype.shortValue = bnShortValue;
    BigInteger.prototype.signum = bnSigNum;
    BigInteger.prototype.toByteArray = bnToByteArray;
    BigInteger.prototype.equals = bnEquals;
    BigInteger.prototype.min = bnMin;
    BigInteger.prototype.max = bnMax;
    BigInteger.prototype.and = bnAnd;
    BigInteger.prototype.or = bnOr;
    BigInteger.prototype.xor = bnXor;
    BigInteger.prototype.andNot = bnAndNot;
    BigInteger.prototype.not = bnNot;
    BigInteger.prototype.shiftLeft = bnShiftLeft;
    BigInteger.prototype.shiftRight = bnShiftRight;
    BigInteger.prototype.getLowestSetBit = bnGetLowestSetBit;
    BigInteger.prototype.bitCount = bnBitCount;
    BigInteger.prototype.testBit = bnTestBit;
    BigInteger.prototype.setBit = bnSetBit;
    BigInteger.prototype.clearBit = bnClearBit;
    BigInteger.prototype.flipBit = bnFlipBit;
    BigInteger.prototype.add = bnAdd;
    BigInteger.prototype.subtract = bnSubtract;
    BigInteger.prototype.multiply = bnMultiply;
    BigInteger.prototype.divide = bnDivide;
    BigInteger.prototype.remainder = bnRemainder;
    BigInteger.prototype.divideAndRemainder = bnDivideAndRemainder;
    BigInteger.prototype.modPow = bnModPow;
    BigInteger.prototype.modInverse = bnModInverse;
    BigInteger.prototype.pow = bnPow;
    BigInteger.prototype.gcd = bnGCD;
    BigInteger.prototype.isProbablePrime = bnIsProbablePrime;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-115" id="section-115"></a>
</div>
<p>JSBN-specific extension</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    BigInteger.prototype.square = bnSquare;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-116" id="section-116"></a>
</div>
<p>Expose the Barrett function</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    BigInteger.prototype.Barrett = Barrett

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-117" id="section-117"></a>
</div>
<p>BigInteger interfaces not implemented in jsbn:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-118" id="section-118"></a>
</div>
<p>BigInteger(int signum, byte[] magnitude)
double doubleValue()
float floatValue()
int hashCode()
long longValue()
static BigInteger valueOf(long val)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-119" id="section-119"></a>
</div>
<p>Random number generator - requires a PRNG backend, e.g. prng4.js</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-120" id="section-120"></a>
</div>
<p>For best results, put code like</p>
<body onClick='rng_seed_time();' onKeyPress='rng_seed_time();'>
in your main HTML document.

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-keyword">var</span> rng_state;
	<span class="hljs-keyword">var</span> rng_pool;
	<span class="hljs-keyword">var</span> rng_pptr;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-121" id="section-121"></a>
</div>
<p>Mix in a 32-bit integer into the pool</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rng_seed_int</span>(<span class="hljs-params">x</span>) </span>{
	  rng_pool[rng_pptr++] ^= x &amp; <span class="hljs-number">255</span>;
	  rng_pool[rng_pptr++] ^= (x &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">255</span>;
	  rng_pool[rng_pptr++] ^= (x &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">255</span>;
	  rng_pool[rng_pptr++] ^= (x &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">255</span>;
	  <span class="hljs-keyword">if</span>(rng_pptr &gt;= rng_psize) rng_pptr -= rng_psize;
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-122" id="section-122"></a>
</div>
<p>Mix in the current time (w/milliseconds) into the pool</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rng_seed_time</span>(<span class="hljs-params"></span>) </span>{
	  rng_seed_int(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime());
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-123" id="section-123"></a>
</div>
<p>Initialize the pool with junk if needed.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span>(rng_pool == <span class="hljs-literal">null</span>) {
	  rng_pool = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
	  rng_pptr = <span class="hljs-number">0</span>;
	  <span class="hljs-keyword">var</span> t;
	  <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">"undefined"</span> &amp;&amp; <span class="hljs-built_in">window</span>.crypto) {
		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.crypto.getRandomValues) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-124" id="section-124"></a>
</div>
<p>Use webcrypto if available</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		  <span class="hljs-keyword">var</span> ua = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">32</span>);
		  <span class="hljs-built_in">window</span>.crypto.getRandomValues(ua);
		  <span class="hljs-keyword">for</span>(t = <span class="hljs-number">0</span>; t &lt; <span class="hljs-number">32</span>; ++t)
			rng_pool[rng_pptr++] = ua[t];
		}
		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(navigator.appName == <span class="hljs-string">"Netscape"</span> &amp;&amp; navigator.appVersion &lt; <span class="hljs-string">"5"</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-125" id="section-125"></a>
</div>
<p>Extract entropy (256 bits) from NS4 RNG if available</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		  <span class="hljs-keyword">var</span> z = <span class="hljs-built_in">window</span>.crypto.random(<span class="hljs-number">32</span>);
		  <span class="hljs-keyword">for</span>(t = <span class="hljs-number">0</span>; t &lt; z.length; ++t)
			rng_pool[rng_pptr++] = z.charCodeAt(t) &amp; <span class="hljs-number">255</span>;
		}
	  }
	  <span class="hljs-keyword">while</span>(rng_pptr &lt; rng_psize) {  <span class="hljs-comment">// extract some randomness from Math.random()</span>
		t = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-number">65536</span> * <span class="hljs-built_in">Math</span>.random());
		rng_pool[rng_pptr++] = t &gt;&gt;&gt; <span class="hljs-number">8</span>;
		rng_pool[rng_pptr++] = t &amp; <span class="hljs-number">255</span>;
	  }
	  rng_pptr = <span class="hljs-number">0</span>;
	  rng_seed_time();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-126" id="section-126"></a>
</div>
<p>rng_seed_int(window.screenX);
rng_seed_int(window.screenY);</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rng_get_byte</span>(<span class="hljs-params"></span>) </span>{
	  <span class="hljs-keyword">if</span>(rng_state == <span class="hljs-literal">null</span>) {
		rng_seed_time();
		rng_state = prng_newstate();
		rng_state.init(rng_pool);
		<span class="hljs-keyword">for</span>(rng_pptr = <span class="hljs-number">0</span>; rng_pptr &lt; rng_pool.length; ++rng_pptr)
		  rng_pool[rng_pptr] = <span class="hljs-number">0</span>;
		rng_pptr = <span class="hljs-number">0</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-127" id="section-127"></a>
</div>
<p>rng_pool = null;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	  }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-128" id="section-128"></a>
</div>
<p>TODO: allow reseeding after first request</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	  <span class="hljs-keyword">return</span> rng_state.next();
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rng_get_bytes</span>(<span class="hljs-params">ba</span>) </span>{
	  <span class="hljs-keyword">var</span> i;
	  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; ba.length; ++i) ba[i] = rng_get_byte();
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SecureRandom</span>(<span class="hljs-params"></span>) </span>{}

	SecureRandom.prototype.nextBytes = rng_get_bytes;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-129" id="section-129"></a>
</div>
<p>prng4.js - uses Arcfour as a PRNG</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Arcfour</span>(<span class="hljs-params"></span>) </span>{
	  <span class="hljs-keyword">this</span>.i = <span class="hljs-number">0</span>;
	  <span class="hljs-keyword">this</span>.j = <span class="hljs-number">0</span>;
	  <span class="hljs-keyword">this</span>.S = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-130" id="section-130"></a>
</div>
<p>Initialize arcfour context from key, an array of ints, each from [0..255]</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ARC4init</span>(<span class="hljs-params">key</span>) </span>{
	  <span class="hljs-keyword">var</span> i, j, t;
	  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; ++i)
		<span class="hljs-keyword">this</span>.S[i] = i;
	  j = <span class="hljs-number">0</span>;
	  <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; ++i) {
		j = (j + <span class="hljs-keyword">this</span>.S[i] + key[i % key.length]) &amp; <span class="hljs-number">255</span>;
		t = <span class="hljs-keyword">this</span>.S[i];
		<span class="hljs-keyword">this</span>.S[i] = <span class="hljs-keyword">this</span>.S[j];
		<span class="hljs-keyword">this</span>.S[j] = t;
	  }
	  <span class="hljs-keyword">this</span>.i = <span class="hljs-number">0</span>;
	  <span class="hljs-keyword">this</span>.j = <span class="hljs-number">0</span>;
	}

	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ARC4next</span>(<span class="hljs-params"></span>) </span>{
	  <span class="hljs-keyword">var</span> t;
	  <span class="hljs-keyword">this</span>.i = (<span class="hljs-keyword">this</span>.i + <span class="hljs-number">1</span>) &amp; <span class="hljs-number">255</span>;
	  <span class="hljs-keyword">this</span>.j = (<span class="hljs-keyword">this</span>.j + <span class="hljs-keyword">this</span>.S[<span class="hljs-keyword">this</span>.i]) &amp; <span class="hljs-number">255</span>;
	  t = <span class="hljs-keyword">this</span>.S[<span class="hljs-keyword">this</span>.i];
	  <span class="hljs-keyword">this</span>.S[<span class="hljs-keyword">this</span>.i] = <span class="hljs-keyword">this</span>.S[<span class="hljs-keyword">this</span>.j];
	  <span class="hljs-keyword">this</span>.S[<span class="hljs-keyword">this</span>.j] = t;
	  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.S[(t + <span class="hljs-keyword">this</span>.S[<span class="hljs-keyword">this</span>.i]) &amp; <span class="hljs-number">255</span>];
	}

	Arcfour.prototype.init = ARC4init;
	Arcfour.prototype.next = ARC4next;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-131" id="section-131"></a>
</div>
<p>Plug in your RNG constructor here</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prng_newstate</span>(<span class="hljs-params"></span>) </span>{
	  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Arcfour();
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-132" id="section-132"></a>
</div>
<p>Pool size must be a multiple of 4 and greater than 32.
An array of bytes the size of the pool will be passed to init()</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> rng_psize = <span class="hljs-number">256</span>;

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> exports !== <span class="hljs-string">'undefined'</span>) {
        exports = <span class="hljs-built_in">module</span>.exports = {
			<span class="hljs-attr">BigInteger</span>: BigInteger,
			<span class="hljs-attr">SecureRandom</span>: SecureRandom,
		};
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.BigInteger = BigInteger;
        <span class="hljs-keyword">this</span>.SecureRandom = SecureRandom;
    }

}).call(<span class="hljs-keyword">this</span>);

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
