<!DOCTYPE html>
<html>
<head>
  <title>sec.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/ecc-jsbn/lib/sec.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>sec.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<p>Named EC curves</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Requires ec.js, jsbn.js, and jsbn2.js</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> BigInteger = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jsbn'</span>)
<span class="hljs-keyword">var</span> ECCurveFp = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./ec.js'</span>).ECCurveFp


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<hr>
<p>X9ECParameters</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>constructor</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">X9ECParameters</span>(<span class="hljs-params">curve,g,n,h</span>) </span>{
    <span class="hljs-keyword">this</span>.curve = curve;
    <span class="hljs-keyword">this</span>.g = g;
    <span class="hljs-keyword">this</span>.n = n;
    <span class="hljs-keyword">this</span>.h = h;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x9getCurve</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.curve;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x9getG</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.g;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x9getN</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.n;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x9getH</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.h;
}

X9ECParameters.prototype.getCurve = x9getCurve;
X9ECParameters.prototype.getG = x9getG;
X9ECParameters.prototype.getN = x9getN;
X9ECParameters.prototype.getH = x9getH;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<hr>
<p>SECNamedCurves</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromHex</span>(<span class="hljs-params">s</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> BigInteger(s, <span class="hljs-number">16</span>); }

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secp128r1</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>p = 2^128 - 2^97 - 1</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> p = fromHex(<span class="hljs-string">"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF"</span>);
    <span class="hljs-keyword">var</span> a = fromHex(<span class="hljs-string">"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC"</span>);
    <span class="hljs-keyword">var</span> b = fromHex(<span class="hljs-string">"E87579C11079F43DD824993C2CEE5ED3"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>byte[] S = Hex.decode(&quot;000E0D4D696E6768756151750CC03A4473D03679&quot;);</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> n = fromHex(<span class="hljs-string">"FFFFFFFE0000000075A30D1B9038A115"</span>);
    <span class="hljs-keyword">var</span> h = BigInteger.ONE;
    <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> ECCurveFp(p, a, b);
    <span class="hljs-keyword">var</span> G = curve.decodePointHex(<span class="hljs-string">"04"</span>
                + <span class="hljs-string">"161FF7528B899B2D0C28607CA52C5B86"</span>
		+ <span class="hljs-string">"CF5AC8395BAFEB13C02DA292DDED7A83"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X9ECParameters(curve, G, n, h);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secp160k1</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>p = 2^160 - 2^32 - 2^14 - 2^12 - 2^9 - 2^8 - 2^7 - 2^3 - 2^2 - 1</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> p = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73"</span>);
    <span class="hljs-keyword">var</span> a = BigInteger.ZERO;
    <span class="hljs-keyword">var</span> b = fromHex(<span class="hljs-string">"7"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>byte[] S = null;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> n = fromHex(<span class="hljs-string">"0100000000000000000001B8FA16DFAB9ACA16B6B3"</span>);
    <span class="hljs-keyword">var</span> h = BigInteger.ONE;
    <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> ECCurveFp(p, a, b);
    <span class="hljs-keyword">var</span> G = curve.decodePointHex(<span class="hljs-string">"04"</span>
                + <span class="hljs-string">"3B4C382CE37AA192A4019E763036F4F5DD4D7EBB"</span>
                + <span class="hljs-string">"938CF935318FDCED6BC28286531733C3F03C4FEE"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X9ECParameters(curve, G, n, h);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secp160r1</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>p = 2^160 - 2^31 - 1</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> p = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF"</span>);
    <span class="hljs-keyword">var</span> a = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC"</span>);
    <span class="hljs-keyword">var</span> b = fromHex(<span class="hljs-string">"1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>byte[] S = Hex.decode(&quot;1053CDE42C14D696E67687561517533BF3F83345&quot;);</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> n = fromHex(<span class="hljs-string">"0100000000000000000001F4C8F927AED3CA752257"</span>);
    <span class="hljs-keyword">var</span> h = BigInteger.ONE;
    <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> ECCurveFp(p, a, b);
    <span class="hljs-keyword">var</span> G = curve.decodePointHex(<span class="hljs-string">"04"</span>
		+ <span class="hljs-string">"4A96B5688EF573284664698968C38BB913CBFC82"</span>
		+ <span class="hljs-string">"23A628553168947D59DCC912042351377AC5FB32"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X9ECParameters(curve, G, n, h);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secp192k1</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>p = 2^192 - 2^32 - 2^12 - 2^8 - 2^7 - 2^6 - 2^3 - 1</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> p = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37"</span>);
    <span class="hljs-keyword">var</span> a = BigInteger.ZERO;
    <span class="hljs-keyword">var</span> b = fromHex(<span class="hljs-string">"3"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>byte[] S = null;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> n = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D"</span>);
    <span class="hljs-keyword">var</span> h = BigInteger.ONE;
    <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> ECCurveFp(p, a, b);
    <span class="hljs-keyword">var</span> G = curve.decodePointHex(<span class="hljs-string">"04"</span>
                + <span class="hljs-string">"DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D"</span>
                + <span class="hljs-string">"9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X9ECParameters(curve, G, n, h);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secp192r1</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>p = 2^192 - 2^64 - 1</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> p = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF"</span>);
    <span class="hljs-keyword">var</span> a = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC"</span>);
    <span class="hljs-keyword">var</span> b = fromHex(<span class="hljs-string">"64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>byte[] S = Hex.decode(&quot;3045AE6FC8422F64ED579528D38120EAE12196D5&quot;);</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> n = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831"</span>);
    <span class="hljs-keyword">var</span> h = BigInteger.ONE;
    <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> ECCurveFp(p, a, b);
    <span class="hljs-keyword">var</span> G = curve.decodePointHex(<span class="hljs-string">"04"</span>
                + <span class="hljs-string">"188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012"</span>
                + <span class="hljs-string">"07192B95FFC8DA78631011ED6B24CDD573F977A11E794811"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X9ECParameters(curve, G, n, h);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secp224r1</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>p = 2^224 - 2^96 + 1</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> p = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001"</span>);
    <span class="hljs-keyword">var</span> a = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE"</span>);
    <span class="hljs-keyword">var</span> b = fromHex(<span class="hljs-string">"B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>byte[] S = Hex.decode(&quot;BD71344799D5C7FCDC45B59FA3B9AB8F6A948BC5&quot;);</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> n = fromHex(<span class="hljs-string">"FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D"</span>);
    <span class="hljs-keyword">var</span> h = BigInteger.ONE;
    <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> ECCurveFp(p, a, b);
    <span class="hljs-keyword">var</span> G = curve.decodePointHex(<span class="hljs-string">"04"</span>
                + <span class="hljs-string">"B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21"</span>
                + <span class="hljs-string">"BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X9ECParameters(curve, G, n, h);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secp256r1</span>(<span class="hljs-params"></span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>p = 2^224 (2^32 - 1) + 2^192 + 2^96 - 1</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> p = fromHex(<span class="hljs-string">"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF"</span>);
    <span class="hljs-keyword">var</span> a = fromHex(<span class="hljs-string">"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC"</span>);
    <span class="hljs-keyword">var</span> b = fromHex(<span class="hljs-string">"5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>byte[] S = Hex.decode(&quot;C49D360886E704936A6678E1139D26B7819F7E90&quot;);</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> n = fromHex(<span class="hljs-string">"FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"</span>);
    <span class="hljs-keyword">var</span> h = BigInteger.ONE;
    <span class="hljs-keyword">var</span> curve = <span class="hljs-keyword">new</span> ECCurveFp(p, a, b);
    <span class="hljs-keyword">var</span> G = curve.decodePointHex(<span class="hljs-string">"04"</span>
                + <span class="hljs-string">"6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296"</span>
		+ <span class="hljs-string">"4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> X9ECParameters(curve, G, n, h);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>TODO: make this into a proper hashtable</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSECCurveByName</span>(<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"secp128r1"</span>) <span class="hljs-keyword">return</span> secp128r1();
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"secp160k1"</span>) <span class="hljs-keyword">return</span> secp160k1();
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"secp160r1"</span>) <span class="hljs-keyword">return</span> secp160r1();
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"secp192k1"</span>) <span class="hljs-keyword">return</span> secp192k1();
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"secp192r1"</span>) <span class="hljs-keyword">return</span> secp192r1();
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"secp224r1"</span>) <span class="hljs-keyword">return</span> secp224r1();
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"secp256r1"</span>) <span class="hljs-keyword">return</span> secp256r1();
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-string">"secp128r1"</span>:secp128r1,
  <span class="hljs-string">"secp160k1"</span>:secp160k1,
  <span class="hljs-string">"secp160r1"</span>:secp160r1,
  <span class="hljs-string">"secp192k1"</span>:secp192k1,
  <span class="hljs-string">"secp192r1"</span>:secp192r1,
  <span class="hljs-string">"secp224r1"</span>:secp224r1,
  <span class="hljs-string">"secp256r1"</span>:secp256r1
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
