<!DOCTYPE html>
<html>
<head>
  <title>tst.inherit.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/verror/tests/tst.inherit.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>tst.inherit.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>tst.inherit.js: test that inheriting from VError and WError work as expected.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> mod_assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">'assert'</span>);
<span class="hljs-keyword">var</span> mod_util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'util'</span>);

<span class="hljs-keyword">var</span> mod_verror = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../lib/verror'</span>);

<span class="hljs-keyword">var</span> VError = mod_verror.VError;
<span class="hljs-keyword">var</span> WError = mod_verror.WError;
<span class="hljs-keyword">var</span> err, suberr;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">VErrorChild</span>(<span class="hljs-params"></span>)
</span>{
	VError.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>));
}

mod_util.inherits(VErrorChild, VError);
VErrorChild.prototype.name = <span class="hljs-string">'VErrorChild'</span>;


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WErrorChild</span>(<span class="hljs-params"></span>)
</span>{
	WError.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>));
}

mod_util.inherits(WErrorChild, WError);
WErrorChild.prototype.name = <span class="hljs-string">'WErrorChild'</span>;


suberr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'root cause'</span>);
err = <span class="hljs-keyword">new</span> VErrorChild(suberr, <span class="hljs-string">'top'</span>);
mod_assert.ok(err <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>);
mod_assert.ok(err <span class="hljs-keyword">instanceof</span> VError);
mod_assert.ok(err <span class="hljs-keyword">instanceof</span> VErrorChild);
mod_assert.equal(err.cause(), suberr);
mod_assert.equal(err.message, <span class="hljs-string">'top: root cause'</span>);
mod_assert.equal(err.toString(), <span class="hljs-string">'VErrorChild: top: root cause'</span>);
mod_assert.equal(err.stack.split(<span class="hljs-string">'\n'</span>)[<span class="hljs-number">0</span>], <span class="hljs-string">'VErrorChild: top: root cause'</span>);

suberr = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'root cause'</span>);
err = <span class="hljs-keyword">new</span> WErrorChild(suberr, <span class="hljs-string">'top'</span>);
mod_assert.ok(err <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Error</span>);
mod_assert.ok(err <span class="hljs-keyword">instanceof</span> WError);
mod_assert.ok(err <span class="hljs-keyword">instanceof</span> WErrorChild);
mod_assert.equal(err.cause(), suberr);
mod_assert.equal(err.message, <span class="hljs-string">'top'</span>);
mod_assert.equal(err.toString(),
	<span class="hljs-string">'WErrorChild: top; caused by Error: root cause'</span>);
mod_assert.equal(err.stack.split(<span class="hljs-string">'\n'</span>)[<span class="hljs-number">0</span>],
	<span class="hljs-string">'WErrorChild: top; caused by Error: root cause'</span>);


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Test that <code>&lt;Ctor&gt;.toString()</code> uses the ctor name. I.e. setting
<code>&lt;Ctor&gt;.prototype.name</code> isn't necessary.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">VErrorChildNoName</span>(<span class="hljs-params"></span>) </span>{
	VError.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>));
}
mod_util.inherits(VErrorChildNoName, VError);
err = <span class="hljs-keyword">new</span> VErrorChildNoName(<span class="hljs-string">'top'</span>);
mod_assert.equal(err.toString(), <span class="hljs-string">'VErrorChildNoName: top'</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WErrorChildNoName</span>(<span class="hljs-params"></span>) </span>{
	WError.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>));
}
mod_util.inherits(WErrorChildNoName, WError);
err = <span class="hljs-keyword">new</span> WErrorChildNoName(<span class="hljs-string">'top'</span>);
mod_assert.equal(err.toString(), <span class="hljs-string">'WErrorChildNoName: top'</span>);


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Test that <code>&lt;Ctor&gt;.prototype.name</code> can be used for the <code>.toString()</code>
when the ctor is anonymous.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> VErrorChildAnon = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
	VError.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>));
};
mod_util.inherits(VErrorChildAnon, VError);
VErrorChildAnon.prototype.name = <span class="hljs-string">'VErrorChildAnon'</span>;
err = <span class="hljs-keyword">new</span> VErrorChildAnon(<span class="hljs-string">'top'</span>);
mod_assert.equal(err.toString(), <span class="hljs-string">'VErrorChildAnon: top'</span>);

<span class="hljs-keyword">var</span> WErrorChildAnon = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
	WError.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>));
};
mod_util.inherits(WErrorChildAnon, WError);
WErrorChildAnon.prototype.name = <span class="hljs-string">'WErrorChildAnon'</span>;
err = <span class="hljs-keyword">new</span> WErrorChildAnon(<span class="hljs-string">'top'</span>);
mod_assert.equal(err.toString(), <span class="hljs-string">'WErrorChildAnon: top'</span>);


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Test get appropriate exception name in <code>.toString()</code> when reconstituting
an error instance a la:
https://github.com/mcavage/node-fast/blob/master/lib/client.js#L215</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">err = <span class="hljs-keyword">new</span> VError(<span class="hljs-string">'top'</span>);
err.name = <span class="hljs-string">'CustomNameError'</span>;
mod_assert.equal(err.toString(), <span class="hljs-string">'CustomNameError: top'</span>);

err = <span class="hljs-keyword">new</span> WError(<span class="hljs-string">'top'</span>);
err.name = <span class="hljs-string">'CustomNameError'</span>;
mod_assert.equal(err.toString(), <span class="hljs-string">'CustomNameError: top'</span>);

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
