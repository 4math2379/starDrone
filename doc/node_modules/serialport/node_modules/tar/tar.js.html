<!DOCTYPE html>
<html>
<head>
  <title>tar.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../";
    var thisFile = "node_modules/serialport/node_modules/tar/tar.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>tar.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<p>field paths that every tar file must have.
header is padded to 512 bytes.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> f = <span class="hljs-number">0</span>
  , fields = {}
  , path = fields.path = f++
  , mode = fields.mode = f++
  , uid = fields.uid = f++
  , gid = fields.gid = f++
  , size = fields.size = f++
  , mtime = fields.mtime = f++
  , cksum = fields.cksum = f++
  , type = fields.type = f++
  , linkpath = fields.linkpath = f++
  , headerSize = <span class="hljs-number">512</span>
  , blockSize = <span class="hljs-number">512</span>
  , fieldSize = []

fieldSize[path] = <span class="hljs-number">100</span>
fieldSize[mode] = <span class="hljs-number">8</span>
fieldSize[uid] = <span class="hljs-number">8</span>
fieldSize[gid] = <span class="hljs-number">8</span>
fieldSize[size] = <span class="hljs-number">12</span>
fieldSize[mtime] = <span class="hljs-number">12</span>
fieldSize[cksum] = <span class="hljs-number">8</span>
fieldSize[type] = <span class="hljs-number">1</span>
fieldSize[linkpath] = <span class="hljs-number">100</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>&quot;ustar\0&quot; may introduce another bunch of headers.
these are optional, and will be nulled out if not present.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> ustar = fields.ustar = f++
  , ustarver = fields.ustarver = f++
  , uname = fields.uname = f++
  , gname = fields.gname = f++
  , devmaj = fields.devmaj = f++
  , devmin = fields.devmin = f++
  , prefix = fields.prefix = f++
  , fill = fields.fill = f++

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>terminate fields.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">fields[f] = <span class="hljs-literal">null</span>

fieldSize[ustar] = <span class="hljs-number">6</span>
fieldSize[ustarver] = <span class="hljs-number">2</span>
fieldSize[uname] = <span class="hljs-number">32</span>
fieldSize[gname] = <span class="hljs-number">32</span>
fieldSize[devmaj] = <span class="hljs-number">8</span>
fieldSize[devmin] = <span class="hljs-number">8</span>
fieldSize[prefix] = <span class="hljs-number">155</span>
fieldSize[fill] = <span class="hljs-number">12</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>nb: prefix field may in fact be 130 bytes of prefix,
a null char, 12 bytes for atime, 12 bytes for ctime.</p>
<p>To recognize this format:</p>
<ol>
<li>prefix[130] === ' ' or '\0'</li>
<li>atime and ctime are octal numeric values</li>
<li>atime and ctime have ' ' in their last byte</li>
</ol>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> fieldEnds = {}
  , fieldOffs = {}
  , fe = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; f; i ++) {
  fieldOffs[i] = fe
  fieldEnds[i] = (fe += fieldSize[i])
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>build a translation table of field paths.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-built_in">Object</span>.keys(fields).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">f</span>) </span>{
  <span class="hljs-keyword">if</span> (fields[f] !== <span class="hljs-literal">null</span>) fields[fields[f]] = f
})

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>different values of the 'type' field
paths match the values of Stats.isX() functions, where appropriate</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> types =
  { <span class="hljs-number">0</span>: <span class="hljs-string">"File"</span>
  , <span class="hljs-string">"\0"</span>: <span class="hljs-string">"OldFile"</span> <span class="hljs-comment">// like 0</span>
  , <span class="hljs-string">""</span>: <span class="hljs-string">"OldFile"</span>
  , <span class="hljs-number">1</span>: <span class="hljs-string">"Link"</span>
  , <span class="hljs-number">2</span>: <span class="hljs-string">"SymbolicLink"</span>
  , <span class="hljs-number">3</span>: <span class="hljs-string">"CharacterDevice"</span>
  , <span class="hljs-number">4</span>: <span class="hljs-string">"BlockDevice"</span>
  , <span class="hljs-number">5</span>: <span class="hljs-string">"Directory"</span>
  , <span class="hljs-number">6</span>: <span class="hljs-string">"FIFO"</span>
  , <span class="hljs-number">7</span>: <span class="hljs-string">"ContiguousFile"</span> <span class="hljs-comment">// like 0</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>posix headers</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  , <span class="hljs-attr">g</span>: <span class="hljs-string">"GlobalExtendedHeader"</span> <span class="hljs-comment">// k=v for the rest of the archive</span>
  , <span class="hljs-attr">x</span>: <span class="hljs-string">"ExtendedHeader"</span> <span class="hljs-comment">// k=v for the next file</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>vendor-specific stuff</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  , <span class="hljs-attr">A</span>: <span class="hljs-string">"SolarisACL"</span> <span class="hljs-comment">// skip</span>
  , <span class="hljs-attr">D</span>: <span class="hljs-string">"GNUDumpDir"</span> <span class="hljs-comment">// like 5, but with data, which should be skipped</span>
  , <span class="hljs-attr">I</span>: <span class="hljs-string">"Inode"</span> <span class="hljs-comment">// metadata only, skip</span>
  , <span class="hljs-attr">K</span>: <span class="hljs-string">"NextFileHasLongLinkpath"</span> <span class="hljs-comment">// data = link path of next file</span>
  , <span class="hljs-attr">L</span>: <span class="hljs-string">"NextFileHasLongPath"</span> <span class="hljs-comment">// data = path of next file</span>
  , <span class="hljs-attr">M</span>: <span class="hljs-string">"ContinuationFile"</span> <span class="hljs-comment">// skip</span>
  , <span class="hljs-attr">N</span>: <span class="hljs-string">"OldGnuLongPath"</span> <span class="hljs-comment">// like L</span>
  , <span class="hljs-attr">S</span>: <span class="hljs-string">"SparseFile"</span> <span class="hljs-comment">// skip</span>
  , <span class="hljs-attr">V</span>: <span class="hljs-string">"TapeVolumeHeader"</span> <span class="hljs-comment">// skip</span>
  , <span class="hljs-attr">X</span>: <span class="hljs-string">"OldExtendedHeader"</span> <span class="hljs-comment">// like x</span>
  }

<span class="hljs-built_in">Object</span>.keys(types).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  types[types[t]] = types[types[t]] || t
})

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>values for the mode field</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> modes =
  { <span class="hljs-attr">suid</span>: <span class="hljs-number">04000</span> <span class="hljs-comment">// set uid on extraction</span>
  , <span class="hljs-attr">sgid</span>: <span class="hljs-number">02000</span> <span class="hljs-comment">// set gid on extraction</span>
  , <span class="hljs-attr">svtx</span>: <span class="hljs-number">01000</span> <span class="hljs-comment">// set restricted deletion flag on dirs on extraction</span>
  , <span class="hljs-attr">uread</span>:  <span class="hljs-number">0400</span>
  , <span class="hljs-attr">uwrite</span>: <span class="hljs-number">0200</span>
  , <span class="hljs-attr">uexec</span>:  <span class="hljs-number">0100</span>
  , <span class="hljs-attr">gread</span>:  <span class="hljs-number">040</span>
  , <span class="hljs-attr">gwrite</span>: <span class="hljs-number">020</span>
  , <span class="hljs-attr">gexec</span>:  <span class="hljs-number">010</span>
  , <span class="hljs-attr">oread</span>:  <span class="hljs-number">4</span>
  , <span class="hljs-attr">owrite</span>: <span class="hljs-number">2</span>
  , <span class="hljs-attr">oexec</span>:  <span class="hljs-number">1</span>
  , <span class="hljs-attr">all</span>: <span class="hljs-number">07777</span>
  }

<span class="hljs-keyword">var</span> numeric =
  { <span class="hljs-attr">mode</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">uid</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">gid</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">size</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">mtime</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">devmaj</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">devmin</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">cksum</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">atime</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">ctime</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">dev</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">ino</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">nlink</span>: <span class="hljs-literal">true</span>
  }

<span class="hljs-built_in">Object</span>.keys(modes).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  modes[modes[t]] = modes[modes[t]] || t
})

<span class="hljs-keyword">var</span> knownExtended =
  { <span class="hljs-attr">atime</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">charset</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">comment</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">ctime</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">gid</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">gname</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">linkpath</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">mtime</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">path</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">realtime</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">security</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">size</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">uid</span>: <span class="hljs-literal">true</span>
  , <span class="hljs-attr">uname</span>: <span class="hljs-literal">true</span> }


exports.fields = fields
exports.fieldSize = fieldSize
exports.fieldOffs = fieldOffs
exports.fieldEnds = fieldEnds
exports.types = types
exports.modes = modes
exports.numeric = numeric
exports.headerSize = headerSize
exports.blockSize = blockSize
exports.knownExtended = knownExtended

exports.Pack = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./lib/pack.js"</span>)
exports.Parse = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./lib/parse.js"</span>)
exports.Extract = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./lib/extract.js"</span>)

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
