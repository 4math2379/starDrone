<!DOCTYPE html>
<html>
<head>
  <title>header.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/tar/test/header.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>header.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> tap = <span class="hljs-built_in">require</span>(<span class="hljs-string">"tap"</span>)
<span class="hljs-keyword">var</span> TarHeader = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../lib/header.js"</span>)
<span class="hljs-keyword">var</span> tar = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../tar.js"</span>)
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>)


<span class="hljs-keyword">var</span> headers =
  { <span class="hljs-string">"a.txt file header"</span>:
    [ <span class="hljs-string">"612e747874000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303430312031313635313336303333332030313234353100203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>
    , { <span class="hljs-attr">cksumValid</span>: <span class="hljs-literal">true</span>
      , <span class="hljs-attr">path</span>: <span class="hljs-string">'a.txt'</span>
      , <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>
      , <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>
      , <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>
      , <span class="hljs-attr">size</span>: <span class="hljs-number">257</span>
      , <span class="hljs-attr">mtime</span>: <span class="hljs-number">1319493851</span>
      , <span class="hljs-attr">cksum</span>: <span class="hljs-number">5417</span>
      , <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>
      , <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>
      , <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>
      , <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>
      , <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>
      , <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>
      , <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> }
    ]

  , <span class="hljs-string">"omega pax"</span>: <span class="hljs-comment">// the extended header from omega tar.</span>
    [ <span class="hljs-string">"5061784865616465722fcea92e74787400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303137302031313534333731303631312030313530353100207800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>
    , { <span class="hljs-attr">cksumValid</span>: <span class="hljs-literal">true</span>
      , <span class="hljs-attr">path</span>: <span class="hljs-string">'PaxHeader/Ω.txt'</span>
      , <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>
      , <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>
      , <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>
      , <span class="hljs-attr">size</span>: <span class="hljs-number">120</span>
      , <span class="hljs-attr">mtime</span>: <span class="hljs-number">1301254537</span>
      , <span class="hljs-attr">cksum</span>: <span class="hljs-number">6697</span>
      , <span class="hljs-attr">type</span>: <span class="hljs-string">'x'</span>
      , <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>
      , <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>
      , <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>
      , <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>
      , <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>
      , <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> } ]

  , <span class="hljs-string">"omega file header"</span>:
    [ <span class="hljs-string">"cea92e7478740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303030322031313534333731303631312030313330373200203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>
    , { <span class="hljs-attr">cksumValid</span>: <span class="hljs-literal">true</span>
      , <span class="hljs-attr">path</span>: <span class="hljs-string">'Ω.txt'</span>
      , <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>
      , <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>
      , <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>
      , <span class="hljs-attr">size</span>: <span class="hljs-number">2</span>
      , <span class="hljs-attr">mtime</span>: <span class="hljs-number">1301254537</span>
      , <span class="hljs-attr">cksum</span>: <span class="hljs-number">5690</span>
      , <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>
      , <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>
      , <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>
      , <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>
      , <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>
      , <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>
      , <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> } ]

  , <span class="hljs-string">"foo.js file header"</span>:
    [ <span class="hljs-string">"666f6f2e6a730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030303030342031313534333637303734312030313236313700203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>
    , { <span class="hljs-attr">cksumValid</span>: <span class="hljs-literal">true</span>
      , <span class="hljs-attr">path</span>: <span class="hljs-string">'foo.js'</span>
      , <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>
      , <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>
      , <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>
      , <span class="hljs-attr">size</span>: <span class="hljs-number">4</span>
      , <span class="hljs-attr">mtime</span>: <span class="hljs-number">1301246433</span>
      , <span class="hljs-attr">cksum</span>: <span class="hljs-number">5519</span>
      , <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>
      , <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>
      , <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>
      , <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>
      , <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>
      , <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>
      , <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> }
    ]

  , <span class="hljs-string">"b.txt file header"</span>:
    [ <span class="hljs-string">"622e747874000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030303036343420003035373736312000303030303234200030303030303030313030302031313635313336303637372030313234363100203000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000757374617200303069736161637300000000000000000000000000000000000000000000000000007374616666000000000000000000000000000000000000000000000000000000303030303030200030303030303020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>
    , { <span class="hljs-attr">cksumValid</span>: <span class="hljs-literal">true</span>
      , <span class="hljs-attr">path</span>: <span class="hljs-string">'b.txt'</span>
      , <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>
      , <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>
      , <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>
      , <span class="hljs-attr">size</span>: <span class="hljs-number">512</span>
      , <span class="hljs-attr">mtime</span>: <span class="hljs-number">1319494079</span>
      , <span class="hljs-attr">cksum</span>: <span class="hljs-number">5425</span>
      , <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>
      , <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>
      , <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>
      , <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>
      , <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>
      , <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>
      , <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> }
    ]

  , <span class="hljs-string">"deep nested file"</span>:
    [ <span class="hljs-string">"636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363633030303634342000303537373631200030303030323420003030303030303030313434203131363532313531353333203034333331340020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000075737461720030306973616163730000000000000000000000000000000000000000000000000000737461666600000000000000000000000000000000000000000000000000000030303030303020003030303030302000722f652f612f6c2f6c2f792f2d2f642f652f652f702f2d2f662f6f2f6c2f642f652f722f2d2f702f612f742f680000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"</span>
    , { <span class="hljs-attr">cksumValid</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">path</span>: <span class="hljs-string">'r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a/t/h/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>
      , <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>
      , <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>
      , <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>
      , <span class="hljs-attr">size</span>: <span class="hljs-number">100</span>
      , <span class="hljs-attr">mtime</span>: <span class="hljs-number">1319687003</span>
      , <span class="hljs-attr">cksum</span>: <span class="hljs-number">18124</span>
      , <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>
      , <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>
      , <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>
      , <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>
      , <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>
      , <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>
      , <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>
      , <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> }
    ]
  }

tap.test(<span class="hljs-string">"parsing"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  <span class="hljs-built_in">Object</span>.keys(headers).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> h = headers[name]
      , header = <span class="hljs-keyword">new</span> Buffer(h[<span class="hljs-number">0</span>], <span class="hljs-string">"hex"</span>)
      , expect = h[<span class="hljs-number">1</span>]
      , parsed = <span class="hljs-keyword">new</span> TarHeader(header)

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>console.error(parsed)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    t.has(parsed, expect, <span class="hljs-string">"parse "</span> + name)
  })
  t.end()
})

tap.test(<span class="hljs-string">"encoding"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  <span class="hljs-built_in">Object</span>.keys(headers).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> h = headers[name]
      , expect = <span class="hljs-keyword">new</span> Buffer(h[<span class="hljs-number">0</span>], <span class="hljs-string">"hex"</span>)
      , encoded = TarHeader.encode(h[<span class="hljs-number">1</span>])

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>might have slightly different bytes, since the standard
isn't very strict, but should have the same semantics
checkSum will be different, but cksumValid will be true</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
    <span class="hljs-keyword">var</span> th = <span class="hljs-keyword">new</span> TarHeader(encoded)
    <span class="hljs-keyword">delete</span> h[<span class="hljs-number">1</span>].block
    <span class="hljs-keyword">delete</span> h[<span class="hljs-number">1</span>].needExtended
    <span class="hljs-keyword">delete</span> h[<span class="hljs-number">1</span>].cksum
    t.has(th, h[<span class="hljs-number">1</span>], <span class="hljs-string">"fields "</span>+name)
  })
  t.end()
})

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>test these manually.  they're a bit rare to find in the wild</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">tap.test(<span class="hljs-string">"parseNumeric tests"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  <span class="hljs-keyword">var</span> parseNumeric = TarHeader.parseNumeric
    , numbers =
      { <span class="hljs-string">"303737373737373700"</span>: <span class="hljs-number">2097151</span>
      , <span class="hljs-string">"30373737373737373737373700"</span>: <span class="hljs-number">8589934591</span>
      , <span class="hljs-string">"303030303036343400"</span>: <span class="hljs-number">420</span>
      , <span class="hljs-string">"800000ffffffffffff"</span>: <span class="hljs-number">281474976710655</span>
      , <span class="hljs-string">"ffffff000000000001"</span>: <span class="hljs-number">-281474976710654</span>
      , <span class="hljs-string">"ffffff000000000000"</span>: <span class="hljs-number">-281474976710655</span>
      , <span class="hljs-string">"800000000000200000"</span>: <span class="hljs-number">2097152</span>
      , <span class="hljs-string">"8000000000001544c5"</span>: <span class="hljs-number">1393861</span>
      , <span class="hljs-string">"ffffffffffff1544c5"</span>: <span class="hljs-number">-15383354</span> }
  <span class="hljs-built_in">Object</span>.keys(numbers).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) </span>{
    <span class="hljs-keyword">var</span> b = <span class="hljs-keyword">new</span> Buffer(n, <span class="hljs-string">"hex"</span>)
    t.equal(parseNumeric(b), numbers[n], n + <span class="hljs-string">" === "</span> + numbers[n])
  })
  t.end()
})

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
