<!DOCTYPE html>
<html>
<head>
  <title>parse.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/tar/test/parse.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>parse.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> tap = <span class="hljs-built_in">require</span>(<span class="hljs-string">"tap"</span>)
  , tar = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../tar.js"</span>)
  , fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>)
  , path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>)
  , file = path.resolve(__dirname, <span class="hljs-string">"fixtures/c.tar"</span>)
  , index = <span class="hljs-number">0</span>

  , expect =
[ [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'c.txt'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">513</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Wed, 26 Oct 2011 01:10:58 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">5422</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'cc.txt'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">513</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Wed, 26 Oct 2011 01:11:02 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">5525</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'r/e/a/l/l/y/-/d/e/e/p/-/f/o/l/d/e/r/-/p/a/t/h/cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:43:23 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">18124</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'立.txt'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 17:51:49 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">5695</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'extendedHeader'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'PaxHeader/立.txt'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">120</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 17:51:49 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">6702</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'x'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'立.txt'</span>,
      <span class="hljs-attr">ctime</span>: <span class="hljs-number">1319737909</span>,
      <span class="hljs-attr">atime</span>: <span class="hljs-number">1319739061</span>,
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51693379</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">1</span> } ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'立.txt'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 17:51:49 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">5695</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ctime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 17:51:49 GMT'</span>),
      <span class="hljs-attr">atime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 18:11:01 GMT'</span>),
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51693379</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">1</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'extendedHeader'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'PaxHeader/200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">353</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:41:08 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">14488</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'x'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">ctime</span>: <span class="hljs-number">1319686868</span>,
      <span class="hljs-attr">atime</span>: <span class="hljs-number">1319741254</span>,
      <span class="hljs-string">'LIBARCHIVE.creationtime'</span>: <span class="hljs-string">'1319686852'</span>,
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51681874</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">1</span> } ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">200</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:41:08 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">14570</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ctime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:41:08 GMT'</span>),
      <span class="hljs-attr">atime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 18:47:34 GMT'</span>),
      <span class="hljs-string">'LIBARCHIVE.creationtime'</span>: <span class="hljs-string">'1319686852'</span>,
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51681874</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">1</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'longPath'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'././@LongLink'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">201</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 01 Jan 1970 00:00:00 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">4976</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'L'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-literal">false</span> },
    <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span> ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">1000</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">1000</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">201</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 22:21:50 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">14086</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-literal">false</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'longLinkpath'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'././@LongLink'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">201</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 01 Jan 1970 00:00:00 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">4975</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'K'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-literal">false</span> },
    <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span> ],
  [ <span class="hljs-string">'longPath'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'././@LongLink'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">201</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 01 Jan 1970 00:00:00 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">4976</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'L'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-literal">false</span> },
    <span class="hljs-string">'200LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL'</span> ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'200LLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLL'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">511</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">1000</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">1000</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Fri, 28 Oct 2011 23:05:17 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">21603</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'2'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-literal">false</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'extendedHeader'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'PaxHeader/200-hard'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">143</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:41:08 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">6533</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'x'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">ctime</span>: <span class="hljs-number">1320617144</span>,
      <span class="hljs-attr">atime</span>: <span class="hljs-number">1320617232</span>,
      <span class="hljs-string">'LIBARCHIVE.creationtime'</span>: <span class="hljs-string">'1319686852'</span>,
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51681874</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">2</span> } ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'200-hard'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">200</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:41:08 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">5526</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'0'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ctime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Sun, 06 Nov 2011 22:05:44 GMT'</span>),
      <span class="hljs-attr">atime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Sun, 06 Nov 2011 22:07:12 GMT'</span>),
      <span class="hljs-string">'LIBARCHIVE.creationtime'</span>: <span class="hljs-string">'1319686852'</span>,
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51681874</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">2</span> },
    <span class="hljs-literal">undefined</span> ],
  [ <span class="hljs-string">'extendedHeader'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'PaxHeader/200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">353</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:41:08 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">14488</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'x'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span> },
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">ctime</span>: <span class="hljs-number">1320617144</span>,
      <span class="hljs-attr">atime</span>: <span class="hljs-number">1320617406</span>,
      <span class="hljs-string">'LIBARCHIVE.creationtime'</span>: <span class="hljs-string">'1319686852'</span>,
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51681874</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">2</span> } ],
  [ <span class="hljs-string">'entry'</span>,
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'200ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc'</span>,
      <span class="hljs-attr">mode</span>: <span class="hljs-number">420</span>,
      <span class="hljs-attr">uid</span>: <span class="hljs-number">24561</span>,
      <span class="hljs-attr">gid</span>: <span class="hljs-number">20</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">mtime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Thu, 27 Oct 2011 03:41:08 GMT'</span>),
      <span class="hljs-attr">cksum</span>: <span class="hljs-number">15173</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">'1'</span>,
      <span class="hljs-attr">linkpath</span>: <span class="hljs-string">'200-hard'</span>,
      <span class="hljs-attr">ustar</span>: <span class="hljs-string">'ustar\0'</span>,
      <span class="hljs-attr">ustarver</span>: <span class="hljs-string">'00'</span>,
      <span class="hljs-attr">uname</span>: <span class="hljs-string">'isaacs'</span>,
      <span class="hljs-attr">gname</span>: <span class="hljs-string">'staff'</span>,
      <span class="hljs-attr">devmaj</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">devmin</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">fill</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">ctime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Sun, 06 Nov 2011 22:05:44 GMT'</span>),
      <span class="hljs-attr">atime</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-string">'Sun, 06 Nov 2011 22:10:06 GMT'</span>),
      <span class="hljs-string">'LIBARCHIVE.creationtime'</span>: <span class="hljs-string">'1319686852'</span>,
      <span class="hljs-attr">dev</span>: <span class="hljs-number">234881026</span>,
      <span class="hljs-attr">ino</span>: <span class="hljs-number">51681874</span>,
      <span class="hljs-attr">nlink</span>: <span class="hljs-number">2</span> },
    <span class="hljs-literal">undefined</span> ] ]


tap.test(<span class="hljs-string">"parser test"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">t</span>) </span>{
  <span class="hljs-keyword">var</span> parser = tar.Parse()

  parser.on(<span class="hljs-string">"end"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    t.equal(index, expect.length, <span class="hljs-string">"saw all expected events"</span>)
    t.end()
  })

  fs.createReadStream(file)
    .pipe(parser)
    .on(<span class="hljs-string">"*"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">ev, entry</span>) </span>{
      <span class="hljs-keyword">var</span> wanted = expect[index]
      <span class="hljs-keyword">if</span> (!wanted) {
        <span class="hljs-keyword">return</span> t.fail(<span class="hljs-string">"Unexpected event: "</span> + ev)
      }
      <span class="hljs-keyword">var</span> result = [ev, entry.props]
      entry.on(<span class="hljs-string">"end"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        result.push(entry.fields || entry.body)

        t.equal(ev, wanted[<span class="hljs-number">0</span>], index + <span class="hljs-string">" event type"</span>)
        t.equivalent(entry.props, wanted[<span class="hljs-number">1</span>], wanted[<span class="hljs-number">1</span>].path + <span class="hljs-string">" entry properties"</span>)
        <span class="hljs-keyword">if</span> (wanted[<span class="hljs-number">2</span>]) {
          t.equivalent(result[<span class="hljs-number">2</span>], wanted[<span class="hljs-number">2</span>], <span class="hljs-string">"metadata values"</span>)
        }
        index ++
      })
    })
})

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
