<!DOCTYPE html>
<html>
<head>
  <title>utils.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../doc-style.css" />
  <script src="../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../";
    var thisFile = "node_modules/serialport/node_modules/qs/lib/utils.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>utils.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> hexTable = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">256</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; ++i) {
        array[i] = <span class="hljs-string">'%'</span> + ((i &lt; <span class="hljs-number">16</span> ? <span class="hljs-string">'0'</span> : <span class="hljs-string">''</span>) + i.toString(<span class="hljs-number">16</span>)).toUpperCase();
    }

    <span class="hljs-keyword">return</span> array;
}());

exports.arrayToObject = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">source, options</span>) </span>{
    <span class="hljs-keyword">var</span> obj = options.plainObjects ? <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>) : {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; source.length; ++i) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> source[i] !== <span class="hljs-string">'undefined'</span>) {
            obj[i] = source[i];
        }
    }

    <span class="hljs-keyword">return</span> obj;
};

exports.merge = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">target, source, options</span>) </span>{
    <span class="hljs-keyword">if</span> (!source) {
        <span class="hljs-keyword">return</span> target;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> source !== <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(target)) {
            target.push(source);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target === <span class="hljs-string">'object'</span>) {
            target[source] = <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> [target, source];
        }

        <span class="hljs-keyword">return</span> target;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> target !== <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">return</span> [target].concat(source);
    }

    <span class="hljs-keyword">var</span> mergeTarget = target;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(target) &amp;&amp; !<span class="hljs-built_in">Array</span>.isArray(source)) {
        mergeTarget = exports.arrayToObject(target, options);
    }

	<span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(source).reduce(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">acc, key</span>) </span>{
        <span class="hljs-keyword">var</span> value = source[key];

        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(acc, key)) {
            acc[key] = exports.merge(acc[key], value, options);
        } <span class="hljs-keyword">else</span> {
            acc[key] = value;
        }
		<span class="hljs-keyword">return</span> acc;
    }, mergeTarget);
};

exports.decode = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str</span>) </span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(str.replace(<span class="hljs-regexp">/\+/g</span>, <span class="hljs-string">' '</span>));
    } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-keyword">return</span> str;
    }
};

exports.encode = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>This code was originally written by Brian White (mscdex) for the io.js core querystring library.
It has been adapted here for stricter adherence to RFC 3986</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (str.length === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> str;
    }

    <span class="hljs-keyword">var</span> string = <span class="hljs-keyword">typeof</span> str === <span class="hljs-string">'string'</span> ? str : <span class="hljs-built_in">String</span>(str);

    <span class="hljs-keyword">var</span> out = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; string.length; ++i) {
        <span class="hljs-keyword">var</span> c = string.charCodeAt(i);

        <span class="hljs-keyword">if</span> (
            c === <span class="hljs-number">0x2D</span> || <span class="hljs-comment">// -</span>
            c === <span class="hljs-number">0x2E</span> || <span class="hljs-comment">// .</span>
            c === <span class="hljs-number">0x5F</span> || <span class="hljs-comment">// _</span>
            c === <span class="hljs-number">0x7E</span> || <span class="hljs-comment">// ~</span>
            (c &gt;= <span class="hljs-number">0x30</span> &amp;&amp; c &lt;= <span class="hljs-number">0x39</span>) || <span class="hljs-comment">// 0-9</span>
            (c &gt;= <span class="hljs-number">0x41</span> &amp;&amp; c &lt;= <span class="hljs-number">0x5A</span>) || <span class="hljs-comment">// a-z</span>
            (c &gt;= <span class="hljs-number">0x61</span> &amp;&amp; c &lt;= <span class="hljs-number">0x7A</span>) <span class="hljs-comment">// A-Z</span>
        ) {
            out += string.charAt(i);
            <span class="hljs-keyword">continue</span>;
        }

        <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">0x80</span>) {
            out = out + hexTable[c];
            <span class="hljs-keyword">continue</span>;
        }

        <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">0x800</span>) {
            out = out + (hexTable[<span class="hljs-number">0xC0</span> | (c &gt;&gt; <span class="hljs-number">6</span>)] + hexTable[<span class="hljs-number">0x80</span> | (c &amp; <span class="hljs-number">0x3F</span>)]);
            <span class="hljs-keyword">continue</span>;
        }

        <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">0xD800</span> || c &gt;= <span class="hljs-number">0xE000</span>) {
            out = out + (hexTable[<span class="hljs-number">0xE0</span> | (c &gt;&gt; <span class="hljs-number">12</span>)] + hexTable[<span class="hljs-number">0x80</span> | ((c &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3F</span>)] + hexTable[<span class="hljs-number">0x80</span> | (c &amp; <span class="hljs-number">0x3F</span>)]);
            <span class="hljs-keyword">continue</span>;
        }

        i += <span class="hljs-number">1</span>;
        c = <span class="hljs-number">0x10000</span> + (((c &amp; <span class="hljs-number">0x3FF</span>) &lt;&lt; <span class="hljs-number">10</span>) | (string.charCodeAt(i) &amp; <span class="hljs-number">0x3FF</span>));
        out += (hexTable[<span class="hljs-number">0xF0</span> | (c &gt;&gt; <span class="hljs-number">18</span>)] + hexTable[<span class="hljs-number">0x80</span> | ((c &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x3F</span>)] + hexTable[<span class="hljs-number">0x80</span> | ((c &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3F</span>)] + hexTable[<span class="hljs-number">0x80</span> | (c &amp; <span class="hljs-number">0x3F</span>)]);
    }

    <span class="hljs-keyword">return</span> out;
};

exports.compact = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, references</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj !== <span class="hljs-string">'object'</span> || obj === <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> obj;
    }

    <span class="hljs-keyword">var</span> refs = references || [];
    <span class="hljs-keyword">var</span> lookup = refs.indexOf(obj);
    <span class="hljs-keyword">if</span> (lookup !== <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">return</span> refs[lookup];
    }

    refs.push(obj);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(obj)) {
        <span class="hljs-keyword">var</span> compacted = [];

        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; obj.length; ++i) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj[i] !== <span class="hljs-string">'undefined'</span>) {
                compacted.push(obj[i]);
            }
        }

        <span class="hljs-keyword">return</span> compacted;
    }

    <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(obj);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; keys.length; ++j) {
        <span class="hljs-keyword">var</span> key = keys[j];
        obj[key] = exports.compact(obj[key], refs);
    }

    <span class="hljs-keyword">return</span> obj;
};

exports.isRegExp = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.toString.call(obj) === <span class="hljs-string">'[object RegExp]'</span>;
};

exports.isBuffer = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">if</span> (obj === <span class="hljs-literal">null</span> || <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">'undefined'</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">return</span> !!(obj.constructor &amp;&amp; obj.constructor.isBuffer &amp;&amp; obj.constructor.isBuffer(obj));
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
