<!DOCTYPE html>
<html>
<head>
  <title>disphelper.h</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../";
    var thisFile = "node_modules/serialport/src/win/disphelper.h";
    var defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>disphelper.h</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<p>This file is part of the source code for the DispHelper COM helper library.
DispHelper allows you to call COM objects with an extremely simple printf style syntax.
DispHelper can be used from C++ or even plain C. It works with most Windows compilers
including Dev-CPP, Visual C++ and LCC-WIN32. Including DispHelper in your project
couldn't be simpler as it is available in a compacted single file version.</p>
<p>Included with DispHelper are over 20 samples that demonstrate using COM objects
including ADO, CDO, Outlook, Eudora, Excel, Word, Internet Explorer, MSHTML,
PocketSoap, Word Perfect, MS Agent, SAPI, MSXML, WIA, dexplorer and WMI.</p>
<p>DispHelper is free open source software provided under the BSD license.</p>
<p>Find out more and download DispHelper at:
http://sourceforge.net/projects/disphelper/
http://disphelper.sourceforge.net/</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="c">

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_H_INCLUDED</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DISPHELPER_H_INCLUDED</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;objbase.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;time.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> __cplusplus</span>
<span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-function">HRESULT <span class="hljs-title">dhCreateObject</span><span class="hljs-params">(LPCOLESTR szProgId, LPCWSTR szMachine, IDispatch ** ppDisp)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhGetObject</span><span class="hljs-params">(LPCOLESTR szFile, LPCOLESTR szProgId, IDispatch ** ppDisp)</span></span>;

<span class="hljs-function">HRESULT <span class="hljs-title">dhCreateObjectEx</span><span class="hljs-params">(LPCOLESTR szProgId, REFIID riid, DWORD dwClsContext, COSERVERINFO * pServerInfo, <span class="hljs-keyword">void</span> ** ppv)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhGetObjectEx</span><span class="hljs-params">(LPCOLESTR szFile, LPCOLESTR szProgId, REFIID riid, DWORD dwClsContext, LPVOID lpvReserved, <span class="hljs-keyword">void</span> ** ppv)</span></span>;

<span class="hljs-function">HRESULT <span class="hljs-title">dhCallMethod</span><span class="hljs-params">(IDispatch * pDisp, LPCOLESTR szMember, ...)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhPutValue</span><span class="hljs-params">(IDispatch * pDisp, LPCOLESTR szMember, ...)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhPutRef</span><span class="hljs-params">(IDispatch * pDisp, LPCOLESTR szMember, ...)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhGetValue</span><span class="hljs-params">(LPCWSTR szIdentifier, <span class="hljs-keyword">void</span> * pResult, IDispatch * pDisp, LPCOLESTR szMember, ...)</span></span>;

<span class="hljs-function">HRESULT <span class="hljs-title">dhInvoke</span><span class="hljs-params">(<span class="hljs-keyword">int</span> invokeType, VARTYPE returnType, VARIANT * pvResult, IDispatch * pDisp, LPCOLESTR szMember, ...)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhInvokeArray</span><span class="hljs-params">(<span class="hljs-keyword">int</span> invokeType, VARIANT * pvResult, UINT cArgs, IDispatch * pDisp, LPCOLESTR szMember, VARIANT * pArgs)</span></span>;

<span class="hljs-function">HRESULT <span class="hljs-title">dhCallMethodV</span><span class="hljs-params">(IDispatch * pDisp, LPCOLESTR szMember, va_list * marker)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhPutValueV</span><span class="hljs-params">(IDispatch * pDisp, LPCOLESTR szMember, va_list * marker)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhPutRefV</span><span class="hljs-params">(IDispatch * pDisp, LPCOLESTR szMember, va_list * marker)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhGetValueV</span><span class="hljs-params">(LPCWSTR szIdentifier, <span class="hljs-keyword">void</span> * pResult, IDispatch * pDisp, LPCOLESTR szMember, va_list * marker)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhInvokeV</span><span class="hljs-params">(<span class="hljs-keyword">int</span> invokeType, VARTYPE returnType, VARIANT * pvResult, IDispatch * pDisp, LPCOLESTR szMember, va_list * marker)</span></span>;

<span class="hljs-function">HRESULT <span class="hljs-title">dhAutoWrap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> invokeType, VARIANT * pvResult, IDispatch * pDisp, LPCOLESTR szMember, UINT cArgs, ...)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhParseProperties</span><span class="hljs-params">(IDispatch * pDisp, LPCWSTR szProperties, UINT * lpcPropsSet)</span></span>;

<span class="hljs-function">HRESULT <span class="hljs-title">dhEnumBegin</span><span class="hljs-params">(IEnumVARIANT ** ppEnum, IDispatch * pDisp, LPCOLESTR szMember, ...)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhEnumBeginV</span><span class="hljs-params">(IEnumVARIANT ** ppEnum, IDispatch * pDisp, LPCOLESTR szMember, va_list * marker)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhEnumNextObject</span><span class="hljs-params">(IEnumVARIANT * pEnum, IDispatch ** ppDisp)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhEnumNextVariant</span><span class="hljs-params">(IEnumVARIANT * pEnum, VARIANT * pvResult)</span></span>;

<span class="hljs-function">HRESULT <span class="hljs-title">dhInitializeImp</span><span class="hljs-params">(BOOL bInitializeCOM, BOOL bUnicode)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dhUninitialize</span><span class="hljs-params">(BOOL bUninitializeCOM)</span></span>;

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhInitializeA(bInitializeCOM) dhInitializeImp(bInitializeCOM, FALSE)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhInitializeW(bInitializeCOM) dhInitializeImp(bInitializeCOM, TRUE)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> UNICODE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhInitialize dhInitializeW</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhInitialize dhInitializeA</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> AutoWrap dhAutoWrap</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DISPATCH_OBJ(objName) IDispatch * objName = NULL</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhFreeString(string) SysFreeString((BSTR) string)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> SAFE_RELEASE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> __cplusplus</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SAFE_RELEASE(pObj) { <span class="hljs-meta-keyword">if</span> (pObj) { (pObj)-&gt;Release(); (pObj) = NULL; } }</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SAFE_RELEASE(pObj) { <span class="hljs-meta-keyword">if</span> (pObj) { (pObj)-&gt;lpVtbl-&gt;Release(pObj); (pObj) = NULL; } }</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> SAFE_FREE_STRING(string) { dhFreeString(string); (string) = NULL; }</span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_WITH</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH0(objName, pDisp, szMember) { \</span>
	DISPATCH_OBJ(objName);            \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH1(objName, pDisp, szMember, arg1) { \</span>
	DISPATCH_OBJ(objName);                  \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH2(objName, pDisp, szMember, arg1, arg2) { \</span>
	DISPATCH_OBJ(objName);                        \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1, arg2))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH3(objName, pDisp, szMember, arg1, arg2, arg3) { \</span>
	DISPATCH_OBJ(objName);                              \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1, arg2, arg3))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH4(objName, pDisp, szMember, arg1, arg2, arg3, arg4) { \</span>
	DISPATCH_OBJ(objName);                                    \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1, arg2, arg3, arg4))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH WITH0</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ON_WITH_ERROR(objName) } <span class="hljs-meta-keyword">else</span> {</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> END_WITH(objName) } SAFE_RELEASE(objName); }</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* ----- DISPHELPER_NO_WITH ----- */</span></span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_FOR_EACH</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH0(objName, pDisp, szMember) { \</span>
	IEnumVARIANT * xx_pEnum_xx = <span class="hljs-literal">NULL</span>;    \
	DISPATCH_OBJ(objName);                \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember))) { \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH1(objName, pDisp, szMember, arg1) { \</span>
	IEnumVARIANT * xx_pEnum_xx = <span class="hljs-literal">NULL</span>;          \
	DISPATCH_OBJ(objName);                      \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1))) { \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH2(objName, pDisp, szMember, arg1, arg2) { \</span>
	IEnumVARIANT * xx_pEnum_xx = <span class="hljs-literal">NULL</span>;          \
	DISPATCH_OBJ(objName);                      \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1, arg2))) { \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {


<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH3(objName, pDisp, szMember, arg1, arg2, arg3) { \</span>
	IEnumVARIANT * xx_pEnum_xx = <span class="hljs-literal">NULL</span>;          \
	DISPATCH_OBJ(objName);                      \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1, arg2, arg3))) { \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {


<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH4(objName, pDisp, szMember, arg1, arg2, arg3, arg4) { \</span>
	IEnumVARIANT * xx_pEnum_xx = <span class="hljs-literal">NULL</span>;          \
	DISPATCH_OBJ(objName);                      \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1, arg2, arg3, arg4))) { \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH FOR_EACH0</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ON_FOR_EACH_ERROR(objName) SAFE_RELEASE(objName); }} <span class="hljs-meta-keyword">else</span> {{</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NEXT(objName) SAFE_RELEASE(objName); }} SAFE_RELEASE(objName); SAFE_RELEASE(xx_pEnum_xx); }</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* ----- DISPHELPER_NO_FOR_EACH ----- */</span></span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_EXCEPTIONS</span>

<span class="hljs-comment">/* Structure to store a DispHelper exception */</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> tagDH_EXCEPTION
{
	LPCWSTR szInitialFunction;
	LPCWSTR szErrorFunction;

	HRESULT hr;

	WCHAR szMember[<span class="hljs-number">64</span>];
	WCHAR szCompleteMember[<span class="hljs-number">256</span>];

	UINT swCode;
	LPWSTR szDescription;
	LPWSTR szSource;
	LPWSTR szHelpFile;
	DWORD dwHelpContext;

	UINT iArgError;

	BOOL bDispatchError;

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> DISPHELPER_INTERNAL_BUILD</span>
	BOOL bOld;
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
} DH_EXCEPTION, * PDH_EXCEPTION;

<span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">void</span> <span class="hljs-params">(*DH_EXCEPTION_CALLBACK)</span> <span class="hljs-params">(PDH_EXCEPTION)</span></span>;

<span class="hljs-comment">/* Structure to store exception options. */</span>
<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> tagDH_EXCEPTION_OPTIONS
{
	HWND hwnd;
	LPCWSTR szAppName;
	BOOL bShowExceptions;
	BOOL bDisableRecordExceptions;
	DH_EXCEPTION_CALLBACK pfnExceptionCallback;
} DH_EXCEPTION_OPTIONS, * PDH_EXCEPTION_OPTIONS;

<span class="hljs-comment">/* Functions to manipulate global exception options */</span>
<span class="hljs-function">HRESULT <span class="hljs-title">dhToggleExceptions</span><span class="hljs-params">(BOOL bShow)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhSetExceptionOptions</span><span class="hljs-params">(PDH_EXCEPTION_OPTIONS pExceptionOptions)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhGetExceptionOptions</span><span class="hljs-params">(PDH_EXCEPTION_OPTIONS pExceptionOptions)</span></span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Functions to show an exception, format an exception into a string
and get a copy of the last exception</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="c"><span class="hljs-function">HRESULT <span class="hljs-title">dhShowException</span><span class="hljs-params">(PDH_EXCEPTION pException)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhGetLastException</span><span class="hljs-params">(PDH_EXCEPTION * pException)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhFormatExceptionW</span><span class="hljs-params">(PDH_EXCEPTION pException, LPWSTR szBuffer, UINT cchBufferSize, BOOL bFixedFont)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhFormatExceptionA</span><span class="hljs-params">(PDH_EXCEPTION pException, LPSTR szBuffer, UINT cchBufferSize, BOOL bFixedFont)</span></span>;

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> UNICODE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhFormatException dhFormatExceptionW</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhFormatException dhFormatExceptionA</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> DISPHELPER_INTERNAL_BUILD</span>

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dhEnter</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;
<span class="hljs-function">HRESULT <span class="hljs-title">dhExitEx</span><span class="hljs-params">(HRESULT hr, BOOL bDispatchError, LPCWSTR szMember, LPCWSTR szCompleteMember, EXCEPINFO * pExcepInfo, UINT iArgError, LPCWSTR szFunctionName)</span></span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dhCleanupThreadException</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span>;

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_ENTER(szFunctionName) static LPCWSTR xx_szFunctionName_xx = szFunctionName; \</span>
				    dhEnter()

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_EXITEX(hr, bDispatchError, szMember, szCompleteMember, pExcepInfo, iArgError) \</span>
		dhExitEx(hr, bDispatchError, szMember, szCompleteMember, pExcepInfo, iArgError, xx_szFunctionName_xx)

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_EXIT(hr, szCompleteMember) DH_EXITEX(hr, FALSE, NULL, szCompleteMember, NULL, 0)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* ----- DISPHELPER_INTERNAL_BUILD ----- */</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span>  <span class="hljs-comment">/* ----- DISPHELPER_NO_EXCEPTIONS ----- */</span></span>

<span class="hljs-comment">/* These macros define out calls to selected exception functions */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhToggleExceptions(bShow) (E_NOTIMPL)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhSetExceptionOptions(pExcepOptions) (E_NOTIMPL)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> DISPHELPER_INTERNAL_BUILD</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_ENTER(szFunctionName)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_EXITEX(hr, bDispatchError, szMember, szCompleteMember, pExcepInfo, iArgError) \</span>
	(((hr == DISP_E_EXCEPTION &amp;&amp; pExcepInfo) ?                      \
	(SysFreeString(((EXCEPINFO *)(pExcepInfo))-&gt;bstrSource),        \
	 SysFreeString(((EXCEPINFO *)(pExcepInfo))-&gt;bstrDescription),   \
	 SysFreeString(((EXCEPINFO *)(pExcepInfo))-&gt;bstrHelpFile), <span class="hljs-number">0</span>) : (<span class="hljs-number">0</span>)), hr)
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_EXIT(hr, szCompleteMember)(hr)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* ----- DISPHELPER_NO_EXCEPTIONS ----- */</span></span>






<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> DISPHELPER_INTERNAL_BUILD</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdarg.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;wchar.h&gt;</span></span>

<span class="hljs-comment">/* Macro to include or lose debug code. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> DEBUG</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DBG_CODE(code) code</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DBG_CODE(code)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-comment">/* Are we in unicode mode? */</span>
<span class="hljs-keyword">extern</span> BOOL dh_g_bIsUnicodeMode;

<span class="hljs-comment">/* Number of objects in an array */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> ARRAYSIZE</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ARRAYSIZE(arr) (sizeof(arr) / sizeof((arr)[0]))</span>

<span class="hljs-comment">/* Maximum number of arguments for a member */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_MAX_ARGS 25</span>

<span class="hljs-comment">/* Maximum length of a member string */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DH_MAX_MEMBER 512</span>

<span class="hljs-comment">/* This macro is missing from Dev-Cpp/Mingw */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> V_UI4</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> V_UI4(X) V_UNION(X, ulVal)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-comment">/* Macro to notify programmer of invalid identifier in debug mode. */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> DEBUG_NOTIFY_INVALID_IDENTIFIER(chIdentifier) \</span>
DBG_CODE( { \
		<span class="hljs-keyword">char</span> buf[<span class="hljs-number">256</span>]; \
		<span class="hljs-built_in">sprintf</span>(buf,<span class="hljs-string">"DEBUG: The format string or return identifier contained the invalid identifier '%c'.\n"</span> \
		<span class="hljs-string">"The valid identifiers are \"d/u/e/b/v/B/S/s/T/o/O/t/W/D/f/m\".\n"</span> \
		<span class="hljs-string">"Each %% character should be followed by a valid identifier.\n"</span> \
		<span class="hljs-string">"Identifiers are case sensitive."</span>, (chIdentifier)); \
		MessageBoxA(<span class="hljs-literal">NULL</span>, buf, <span class="hljs-string">"DEBUG: Invalid Format Identifier"</span>, MB_ICONSTOP); \
	} )

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _MSC_VER</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> <span class="hljs-meta-keyword">warning</span>(disable : 4706) <span class="hljs-comment">/* Assignment in conditional expression */</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_PRAGMA_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> __LCC__</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> lib <span class="hljs-meta-string">&lt;ole32.lib&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> lib <span class="hljs-meta-string">&lt;oleaut32.lib&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> lib <span class="hljs-meta-string">&lt;uuid.lib&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>


<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* ----- DISPHELPER_INTERNAL_BUILD ----- */</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_PRAGMA_LIB</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(_MSC_VER) || defined(__BORLANDC__)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib, <span class="hljs-meta-string">"ole32.lib"</span>)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib, <span class="hljs-meta-string">"oleaut32.lib"</span>)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> comment(lib, <span class="hljs-meta-string">"uuid.lib"</span>)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>



<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> __cplusplus</span>
}
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> defined(__cplusplus) &amp;&amp; !defined(DISPHELPER_NO_CPP_EXTENSIONS)</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _MSC_VER</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> <span class="hljs-meta-keyword">warning</span>( disable : 4290 ) <span class="hljs-comment">/* throw() specification ignored */</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_USE_MS_SMART_PTR</span>

<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">class</span> T&gt;
<span class="hljs-keyword">class</span> CDhComPtr
{
<span class="hljs-keyword">public</span>:
	CDhComPtr() <span class="hljs-keyword">throw</span>() : m_pInterface (<span class="hljs-literal">NULL</span>) {}

	CDhComPtr(T* pInterface) <span class="hljs-keyword">throw</span>() : m_pInterface (pInterface)
	{
		<span class="hljs-keyword">if</span> (m_pInterface) m_pInterface-&gt;AddRef();
	}

	CDhComPtr(<span class="hljs-keyword">const</span> CDhComPtr&amp; original) <span class="hljs-keyword">throw</span>() : m_pInterface (original.m_pInterface)
	{
		<span class="hljs-keyword">if</span> (m_pInterface) m_pInterface-&gt;AddRef();
	}

	~CDhComPtr() <span class="hljs-keyword">throw</span>()
	{
		Dispose();
	}

	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dispose</span><span class="hljs-params">()</span> <span class="hljs-title">throw</span><span class="hljs-params">()</span>
	</span>{
		<span class="hljs-keyword">if</span> (m_pInterface)
		{
			m_pInterface-&gt;Release();
			m_pInterface = <span class="hljs-literal">NULL</span>;
		}
	}

	<span class="hljs-function">T* <span class="hljs-title">Detach</span><span class="hljs-params">()</span> <span class="hljs-title">throw</span><span class="hljs-params">()</span>
	</span>{
		T* temp = m_pInterface;
		m_pInterface = <span class="hljs-literal">NULL</span>;
		<span class="hljs-keyword">return</span> temp;
	}

	<span class="hljs-keyword">inline</span> <span class="hljs-keyword">operator</span> T*() <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-title">throw</span><span class="hljs-params">()</span>
	</span>{
        	<span class="hljs-keyword">return</span> m_pInterface;
	}

	T** <span class="hljs-keyword">operator</span>&amp;() <span class="hljs-keyword">throw</span>()
	{
		Dispose();
        	<span class="hljs-keyword">return</span> &amp;m_pInterface;
	}

	T* <span class="hljs-keyword">operator</span>-&gt;() <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-title">throw</span><span class="hljs-params">(HRESULT)</span>
	</span>{
		<span class="hljs-keyword">if</span> (!m_pInterface) <span class="hljs-keyword">throw</span> E_POINTER;
		<span class="hljs-keyword">return</span> m_pInterface;
	}

	CDhComPtr&amp; <span class="hljs-keyword">operator</span>=(T* pInterface) <span class="hljs-keyword">throw</span>()
	{
		<span class="hljs-keyword">if</span> (m_pInterface != pInterface)
		{
			T* pOldInterface = m_pInterface;
			m_pInterface = pInterface;
			<span class="hljs-keyword">if</span> (m_pInterface)  m_pInterface-&gt;AddRef();
			<span class="hljs-keyword">if</span> (pOldInterface) pOldInterface-&gt;Release();
		}

		<span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
	}

	CDhComPtr&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> null) <span class="hljs-keyword">throw</span>(HRESULT)
	{
		<span class="hljs-keyword">if</span> (null != <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span>(E_POINTER);
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">operator</span>=((T*) <span class="hljs-literal">NULL</span>);
	}

	CDhComPtr&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> CDhComPtr&amp; rhs) <span class="hljs-keyword">throw</span>()
	{
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">operator</span>=(rhs.m_pInterface);
	}

<span class="hljs-keyword">private</span>:
	T* m_pInterface;
};

<span class="hljs-keyword">typedef</span> CDhComPtr&lt;IDispatch&gt;    CDispPtr;
<span class="hljs-keyword">typedef</span> CDhComPtr&lt;IEnumVARIANT&gt; CEnumPtr;
<span class="hljs-keyword">typedef</span> CDhComPtr&lt;IUnknown&gt;     CUnknownPtr;

<span class="hljs-meta">#<span class="hljs-meta-keyword">else</span> <span class="hljs-comment">/* DISPHELPER_USE_MS_SMART_PTR */</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;comdef.h&gt;</span> </span>
<span class="hljs-keyword">typedef</span> IDispatchPtr    CDispPtr;
<span class="hljs-keyword">typedef</span> IEnumVARIANTPtr CEnumPtr;
<span class="hljs-keyword">typedef</span> IUnknownPtr     CUnknownPtr;

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* DISPHELPER_USE_MS_SMART_PTR */</span></span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">class</span> T&gt;
<span class="hljs-keyword">class</span> CDhStringTemplate
{
<span class="hljs-keyword">public</span>:
	CDhStringTemplate() <span class="hljs-keyword">throw</span>() : m_strptr (<span class="hljs-literal">NULL</span>) {}

	CDhStringTemplate(<span class="hljs-keyword">const</span> CDhStringTemplate&amp; original) <span class="hljs-keyword">throw</span>()
	{
		Copy(original.m_strptr);
	}

	CDhStringTemplate(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> null) <span class="hljs-keyword">throw</span>(HRESULT) : m_strptr (<span class="hljs-literal">NULL</span>)
	{
		<span class="hljs-keyword">if</span> (null != <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span>(E_POINTER);
	}

	~CDhStringTemplate() <span class="hljs-keyword">throw</span>()
	{
		Dispose();
	}

	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Dispose</span><span class="hljs-params">()</span> <span class="hljs-title">throw</span><span class="hljs-params">()</span>
	</span>{
		dhFreeString(m_strptr);
		m_strptr = <span class="hljs-literal">NULL</span>;
	}

	<span class="hljs-function">T* <span class="hljs-title">Detach</span><span class="hljs-params">()</span> <span class="hljs-title">throw</span><span class="hljs-params">()</span>
	</span>{
		T* temp = m_strptr;
		m_strptr = <span class="hljs-literal">NULL</span>;
		<span class="hljs-keyword">return</span> temp;
	}

	T** <span class="hljs-keyword">operator</span>&amp;() <span class="hljs-keyword">throw</span>()
	{
		Dispose();
		<span class="hljs-keyword">return</span> &amp;m_strptr;
	}

	<span class="hljs-keyword">inline</span> <span class="hljs-keyword">operator</span> T*() <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-title">throw</span><span class="hljs-params">()</span>
	</span>{
		<span class="hljs-keyword">return</span> m_strptr;
	}

	<span class="hljs-keyword">inline</span> T&amp; <span class="hljs-keyword">operator</span>[](<span class="hljs-keyword">int</span> nIndex) <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-title">throw</span><span class="hljs-params">()</span>
	</span>{
		<span class="hljs-keyword">return</span> m_strptr[nIndex];
	}

	CDhStringTemplate&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> CDhStringTemplate&amp; rhs)
	{
		<span class="hljs-keyword">if</span> (m_strptr != rhs.m_strptr)
		{
			T* temp = m_strptr;
			Copy(rhs.m_strptr);
			dhFreeString(temp);
		}

		<span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
	}

	CDhStringTemplate&amp; <span class="hljs-keyword">operator</span>=(<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> null) <span class="hljs-keyword">throw</span>(HRESULT)
	{
		<span class="hljs-keyword">if</span> (null != <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span>(E_POINTER);
		Dispose();
		<span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;
	}

<span class="hljs-keyword">private</span>:
	<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Copy</span><span class="hljs-params">(<span class="hljs-keyword">const</span> T* rhs)</span>
	</span>{
		<span class="hljs-keyword">if</span> (rhs == <span class="hljs-literal">NULL</span>)
		{
			m_strptr = <span class="hljs-literal">NULL</span>;
		}
		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">sizeof</span>(T) == <span class="hljs-keyword">sizeof</span>(CHAR))
		{
			m_strptr = (T*) SysAllocStringByteLen((LPCSTR) rhs, SysStringByteLen((BSTR) rhs));
		}
		<span class="hljs-keyword">else</span>
		{
			m_strptr = (T*) SysAllocStringLen((OLECHAR *) rhs, SysStringLen((BSTR) rhs));
		}
	}

	T* m_strptr;
};

<span class="hljs-keyword">typedef</span> CDhStringTemplate&lt;CHAR&gt;    CDhStringA;  <span class="hljs-comment">/* Ansi string - LPSTR */</span>
<span class="hljs-keyword">typedef</span> CDhStringTemplate&lt;WCHAR&gt;   CDhStringW;  <span class="hljs-comment">/* Unicode string - LPWSTR */</span>
<span class="hljs-keyword">typedef</span> CDhStringTemplate&lt;OLECHAR&gt; CDhStringB;  <span class="hljs-comment">/* Unicode bstring - BSTR */</span>
<span class="hljs-keyword">typedef</span> CDhStringTemplate&lt;TCHAR&gt;   CDhStringT;  <span class="hljs-comment">/* T string - LPTSTR */</span>
<span class="hljs-keyword">typedef</span> CDhStringTemplate&lt;TCHAR&gt;   CDhString;   <span class="hljs-comment">/* T string - LPTSTR */</span>

<span class="hljs-keyword">inline</span> <span class="hljs-built_in">std</span>::ostream&amp; <span class="hljs-keyword">operator</span>&lt;&lt;(<span class="hljs-built_in">std</span>::ostream&amp; os, <span class="hljs-keyword">const</span> CDhStringA&amp; s)
{
	<span class="hljs-keyword">return</span> os &lt;&lt; (s ? s : (<span class="hljs-keyword">char</span>*) <span class="hljs-string">"(null)"</span>);
}

<span class="hljs-keyword">inline</span> <span class="hljs-built_in">std</span>::wostream&amp; <span class="hljs-keyword">operator</span>&lt;&lt;(<span class="hljs-built_in">std</span>::wostream&amp; os, <span class="hljs-keyword">const</span> CDhStringW&amp; s)
{
	<span class="hljs-keyword">return</span> os &lt;&lt; (s ? s : (<span class="hljs-keyword">wchar_t</span>*) <span class="hljs-string">L"(null)"</span>);
}




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-keyword">class</span> CDhInitialize
{
<span class="hljs-keyword">public</span>:
	CDhInitialize(<span class="hljs-keyword">const</span> BOOL bInitCom = TRUE) <span class="hljs-keyword">throw</span>() : m_bInitCom (bInitCom)
	{
		dhInitialize(m_bInitCom);
	}

	~CDhInitialize() <span class="hljs-keyword">throw</span>()
	{
		dhUninitialize(m_bInitCom);
	}
<span class="hljs-keyword">private</span>:
	BOOL m_bInitCom;
};




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_EXCEPTIONS</span>
<span class="hljs-keyword">class</span> dhThrowFunctions
{
<span class="hljs-keyword">public</span>:
	<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">throw_string</span><span class="hljs-params">()</span> <span class="hljs-title">throw</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>)</span>
	</span>{
		CHAR szMessage[<span class="hljs-number">512</span>];
		dhFormatExceptionA(<span class="hljs-literal">NULL</span>, szMessage, <span class="hljs-keyword">sizeof</span>(szMessage)/<span class="hljs-keyword">sizeof</span>(szMessage[<span class="hljs-number">0</span>]), TRUE);
		<span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>(szMessage);
	}

	<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">throw_wstring</span><span class="hljs-params">()</span> <span class="hljs-title">throw</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::wstring)</span>
	</span>{
		WCHAR szMessage[<span class="hljs-number">512</span>];
		dhFormatExceptionW(<span class="hljs-literal">NULL</span>, szMessage, <span class="hljs-keyword">sizeof</span>(szMessage)/<span class="hljs-keyword">sizeof</span>(szMessage[<span class="hljs-number">0</span>]), TRUE);
		<span class="hljs-keyword">throw</span> <span class="hljs-built_in">std</span>::wstring(szMessage);
	}
	
	<span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">throw_dhexception</span><span class="hljs-params">()</span> <span class="hljs-title">throw</span><span class="hljs-params">(PDH_EXCEPTION)</span>
	</span>{
		PDH_EXCEPTION pException = <span class="hljs-literal">NULL</span>;
		dhGetLastException(&amp;pException);
		<span class="hljs-keyword">throw</span> pException;
	}
};
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* DISPHELPER_NO_EXCEPTIONS */</span></span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_EXCEPTIONS</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">dhIfFailThrowString</span><span class="hljs-params">(HRESULT hr)</span> <span class="hljs-title">throw</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span>)</span>
</span>{
	<span class="hljs-keyword">if</span> (FAILED(hr)) dhThrowFunctions::throw_string();
	<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">dhIfFailThrowWString</span><span class="hljs-params">(HRESULT hr)</span> <span class="hljs-title">throw</span><span class="hljs-params">(<span class="hljs-built_in">std</span>::wstring)</span>
</span>{
	<span class="hljs-keyword">if</span> (FAILED(hr)) dhThrowFunctions::throw_wstring();
	<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">dhIfFailThrowDhException</span><span class="hljs-params">(HRESULT hr)</span> <span class="hljs-title">throw</span><span class="hljs-params">(PDH_EXCEPTION)</span>
</span>{
	<span class="hljs-keyword">if</span> (FAILED(hr)) dhThrowFunctions::throw_dhexception();
	<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dhCheck dhIfFailThrowString</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* DISPHELPER_NO_EXCEPTIONS */</span></span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_WITH</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> WITH0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH0(objName, pDisp, szMember) { \</span>
	CDispPtr objName;                 \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> WITH1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH1(objName, pDisp, szMember, arg1) { \</span>
	CDispPtr objName;                       \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> WITH2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH2(objName, pDisp, szMember, arg1, arg2) { \</span>
	CDispPtr objName;                             \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1, arg2))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> WITH3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH3(objName, pDisp, szMember, arg1, arg2, arg3) { \</span>
	CDispPtr objName;                                   \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1, arg2, arg3))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> WITH4</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> WITH4(objName, pDisp, szMember, arg1, arg2, arg3, arg4) { \</span>
	CDispPtr objName;                                         \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhGetValue(<span class="hljs-string">L"%o"</span>, &amp;objName, pDisp, szMember, arg1, arg2, arg3, arg4))) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> ON_WITH_ERROR</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ON_WITH_ERROR(objName) } <span class="hljs-meta-keyword">else</span> {</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> END_WITH</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> END_WITH(objName) }}</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> END_WITH_THROW(objName) } <span class="hljs-meta-keyword">else</span> { dhThrowFunctions::throw_string(); }}</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* DISPHELPER_NO_WITH */</span></span>




<span class="hljs-comment">/* ===================================================================== */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> DISPHELPER_NO_FOR_EACH</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> FOR_EACH0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH0(objName, pDisp, szMember) { \</span>
	CEnumPtr xx_pEnum_xx;     \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember))) { \
		CDispPtr objName; \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> FOR_EACH1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH1(objName, pDisp, szMember, arg1) { \</span>
	CEnumPtr xx_pEnum_xx;     \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1))) { \
		CDispPtr objName; \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> FOR_EACH2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH2(objName, pDisp, szMember, arg1, arg2) { \</span>
	CEnumPtr xx_pEnum_xx;     \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1, arg2))) { \
		CDispPtr objName; \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> FOR_EACH3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH3(objName, pDisp, szMember, arg1, arg2, arg3) { \</span>
	CEnumPtr xx_pEnum_xx;     \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1, arg2, arg3))) { \
		CDispPtr objName; \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> FOR_EACH4</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> FOR_EACH4(objName, pDisp, szMember, arg1, arg2, arg3, arg4) { \</span>
	CEnumPtr xx_pEnum_xx;     \
	<span class="hljs-keyword">if</span> (SUCCEEDED(dhEnumBegin(&amp;xx_pEnum_xx, pDisp, szMember, arg1, arg2, arg3, arg4))) { \
		CDispPtr objName; \
		<span class="hljs-keyword">while</span> (dhEnumNextObject(xx_pEnum_xx, &amp;objName) == NOERROR) {

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> ON_FOR_EACH_ERROR</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> ON_FOR_EACH_ERROR(objName) }} <span class="hljs-meta-keyword">else</span> {{</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">undef</span> NEXT</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NEXT(objName) }}}</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NEXT_THROW(objName) }} <span class="hljs-meta-keyword">else</span> { dhThrowFunctions::throw_string(); }}</span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* DISPHELPER_NO_FOR_EACH */</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">ifdef</span> _MSC_VER</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">pragma</span> <span class="hljs-meta-keyword">warning</span>( default : 4290 )</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* defined(__cplusplus) &amp;&amp; !defined(DISPHELPER_NO_CPP_EXTENSIONS) */</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span> <span class="hljs-comment">/* ----- DISPHELPER_H_INCLUDED ----- */</span></span>

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
