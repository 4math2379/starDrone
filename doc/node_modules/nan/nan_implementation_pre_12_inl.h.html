<!DOCTYPE html>
<html>
<head>
  <title>nan_implementation_pre_12_inl.h</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/nan/nan_implementation_pre_12_inl.h";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#node-v0.10-implementation">==============================================================================
node v0.10 implementation</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>nan_implementation_pre_12_inl.h</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>
<div class="dox">
<div class="summary">
<hr>
<p>NAN - Native Abstractions for Node.js</p>
</div>
<div class="body">
<p>Copyright (c) 2016 NAN contributors</p>
<p>MIT License <a href="https://github.com/nodejs/nan/blob/master/LICENSE.md">https://github.com/nodejs/nan/blob/master/LICENSE.md</a></p>
<hr>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="c">
<span class="hljs-meta">#<span class="hljs-meta-keyword">ifndef</span> NAN_IMPLEMENTATION_PRE_12_INL_H_</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> NAN_IMPLEMENTATION_PRE_12_INL_H_</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="node-v0.10-implementation">
  <h1>
    <a href="#node-v0.10-implementation" name="node-v0.10-implementation" class="pilcrow"></a>
==============================================================================
node v0.10 implementation
  </h1>
</div>

        </td>
        <td class="code highlight">
          <pre class="c">
<span class="hljs-keyword">namespace</span> imp {

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>=== Array ====================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Array&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Array&gt;::New() {
  <span class="hljs-keyword">return</span> v8::Array::New();
}

Factory&lt;v8::Array&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Array&gt;::New(<span class="hljs-keyword">int</span> length) {
  <span class="hljs-keyword">return</span> v8::Array::New(length);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>=== Boolean ==================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Boolean&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Boolean&gt;::New(<span class="hljs-keyword">bool</span> value) {
  <span class="hljs-keyword">return</span> v8::Boolean::New(value)-&gt;ToBoolean();
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>=== Boolean Object ===========================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::BooleanObject&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::BooleanObject&gt;::New(<span class="hljs-keyword">bool</span> value) {
  <span class="hljs-keyword">return</span> v8::BooleanObject::New(value).As&lt;v8::BooleanObject&gt;();
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>=== Context ==================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Context&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Context&gt;::New( v8::ExtensionConfiguration* extensions
                         , v8::Local&lt;v8::ObjectTemplate&gt; tmpl
                         , v8::Local&lt;v8::Value&gt; obj) {
  v8::Persistent&lt;v8::Context&gt; ctx = v8::Context::New(extensions, tmpl, obj);
  v8::Local&lt;v8::Context&gt; lctx = v8::Local&lt;v8::Context&gt;::New(ctx);
  ctx.Dispose();
  <span class="hljs-keyword">return</span> lctx;
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>=== Date =====================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Date&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Date&gt;::New(<span class="hljs-keyword">double</span> value) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::Date&gt;::<span class="hljs-keyword">return_t</span>(v8::Date::New(value).As&lt;v8::Date&gt;());
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>=== External =================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::External&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::External&gt;::New(<span class="hljs-keyword">void</span> * value) {
  <span class="hljs-keyword">return</span> v8::External::New(value);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>=== Function =================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Function&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Function&gt;::New( FunctionCallback callback
                          , v8::Local&lt;v8::Value&gt; data) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::FunctionTemplate&gt;::New( callback
                                           , data
                                           , v8::Local&lt;v8::Signature&gt;()
                                           )-&gt;GetFunction();
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>=== FunctionTemplate =========================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::FunctionTemplate&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::FunctionTemplate&gt;::New( FunctionCallback callback
                                  , v8::Local&lt;v8::Value&gt; data
                                  , v8::Local&lt;v8::Signature&gt; signature) {
  <span class="hljs-keyword">if</span> (callback) {
    v8::HandleScope scope;

    v8::Local&lt;v8::ObjectTemplate&gt; tpl = v8::ObjectTemplate::New();
    tpl-&gt;SetInternalFieldCount(imp::kFunctionFieldCount);
    v8::Local&lt;v8::Object&gt; obj = tpl-&gt;NewInstance();

    obj-&gt;SetInternalField(
        imp::kFunctionIndex
      , v8::External::New(<span class="hljs-keyword">reinterpret_cast</span>&lt;<span class="hljs-keyword">void</span> *&gt;(callback)));

    v8::Local&lt;v8::Value&gt; val = v8::Local&lt;v8::Value&gt;::New(data);

    <span class="hljs-keyword">if</span> (!val.IsEmpty()) {
      obj-&gt;SetInternalField(imp::kDataIndex, val);
    }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Note(agnat): Emulate length argument here. Unfortunately, I couldn't find
a way. Have at it though...</p>

        </td>
        <td class="code highlight">
          <pre class="c">    <span class="hljs-keyword">return</span> scope.Close(
        v8::FunctionTemplate::New(imp::FunctionCallbackWrapper
                                 , obj
                                 , signature));
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> v8::FunctionTemplate::New(<span class="hljs-number">0</span>, data, signature);
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>=== Number ===================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Number&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Number&gt;::New(<span class="hljs-keyword">double</span> value) {
  <span class="hljs-keyword">return</span> v8::Number::New(value);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>=== Number Object ============================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::NumberObject&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::NumberObject&gt;::New(<span class="hljs-keyword">double</span> value) {
  <span class="hljs-keyword">return</span> v8::NumberObject::New(value).As&lt;v8::NumberObject&gt;();
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>=== Integer, Int32 and Uint32 ================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">typename</span> IntegerFactory&lt;T&gt;::<span class="hljs-keyword">return_t</span>
IntegerFactory&lt;T&gt;::New(<span class="hljs-keyword">int32_t</span> value) {
  <span class="hljs-keyword">return</span> To&lt;T&gt;(T::New(value));
}

<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">typename</span> IntegerFactory&lt;T&gt;::<span class="hljs-keyword">return_t</span>
IntegerFactory&lt;T&gt;::New(<span class="hljs-keyword">uint32_t</span> value) {
  <span class="hljs-keyword">return</span> To&lt;T&gt;(T::NewFromUnsigned(value));
}

Factory&lt;v8::Uint32&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Uint32&gt;::New(<span class="hljs-keyword">int32_t</span> value) {
  <span class="hljs-keyword">return</span> To&lt;v8::Uint32&gt;(v8::Uint32::NewFromUnsigned(value));
}

Factory&lt;v8::Uint32&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Uint32&gt;::New(<span class="hljs-keyword">uint32_t</span> value) {
  <span class="hljs-keyword">return</span> To&lt;v8::Uint32&gt;(v8::Uint32::NewFromUnsigned(value));
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>=== Object ===================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Object&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Object&gt;::New() {
  <span class="hljs-keyword">return</span> v8::Object::New();
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>=== Object Template ==========================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::ObjectTemplate&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::ObjectTemplate&gt;::New() {
  <span class="hljs-keyword">return</span> v8::ObjectTemplate::New();
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>=== RegExp ===================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::RegExp&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::RegExp&gt;::New(
    v8::Local&lt;v8::String&gt; pattern
  , v8::RegExp::Flags flags) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::RegExp&gt;::<span class="hljs-keyword">return_t</span>(v8::RegExp::New(pattern, flags));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>=== Script ===================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Script&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Script&gt;::New( v8::Local&lt;v8::String&gt; source) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::Script&gt;::<span class="hljs-keyword">return_t</span>(v8::Script::New(source));
}
Factory&lt;v8::Script&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Script&gt;::New( v8::Local&lt;v8::String&gt; source
                        , v8::ScriptOrigin <span class="hljs-keyword">const</span>&amp; origin) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::Script&gt;::<span class="hljs-keyword">return_t</span>(
      v8::Script::New(source, <span class="hljs-keyword">const_cast</span>&lt;v8::ScriptOrigin*&gt;(&amp;origin)));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>=== Signature ================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::Signature&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::Signature&gt;::New(Factory&lt;v8::Signature&gt;::FTH receiver) {
  <span class="hljs-keyword">return</span> v8::Signature::New(receiver);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<p>=== String ===================================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::String&gt;::New() {
  <span class="hljs-keyword">return</span> Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>(v8::String::Empty());
}

Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::String&gt;::New(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> * value, <span class="hljs-keyword">int</span> length) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>(v8::String::New(value, length));
}

Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::String&gt;::New(
    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> <span class="hljs-keyword">const</span>&amp; value) <span class="hljs-comment">/* NOLINT(build/include_what_you_use) */</span> {
  assert(value.size() &lt;= INT_MAX &amp;&amp; <span class="hljs-string">"string too long"</span>);
  <span class="hljs-keyword">return</span> Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>(
      v8::String::New( value.data(), <span class="hljs-keyword">static_cast</span>&lt;<span class="hljs-keyword">int</span>&gt;(value.size())));
}

Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::String&gt;::New(<span class="hljs-keyword">const</span> <span class="hljs-keyword">uint16_t</span> * value, <span class="hljs-keyword">int</span> length) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>(v8::String::New(value, length));
}

Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::String&gt;::New(v8::String::ExternalStringResource * value) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>(v8::String::NewExternal(value));
}

Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::String&gt;::New(v8::String::ExternalAsciiStringResource * value) {
  <span class="hljs-keyword">return</span> Factory&lt;v8::String&gt;::<span class="hljs-keyword">return_t</span>(v8::String::NewExternal(value));
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>=== String Object ============================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
Factory&lt;v8::StringObject&gt;::<span class="hljs-keyword">return_t</span>
Factory&lt;v8::StringObject&gt;::New(v8::Local&lt;v8::String&gt; value) {
  <span class="hljs-keyword">return</span> v8::StringObject::New(value).As&lt;v8::StringObject&gt;();
}

}  <span class="hljs-comment">// end of namespace imp</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<p>=== Presistents and Handles ==================================================</p>

        </td>
        <td class="code highlight">
          <pre class="c">
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">inline</span> v8::Local&lt;T&gt; New(v8::Handle&lt;T&gt; h) {
  <span class="hljs-keyword">return</span> v8::Local&lt;T&gt;::New(h);
}

<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">inline</span> v8::Local&lt;T&gt; New(v8::Persistent&lt;T&gt; <span class="hljs-keyword">const</span>&amp; p) {
  <span class="hljs-keyword">return</span> v8::Local&lt;T&gt;::New(p);
}

<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T, <span class="hljs-keyword">typename</span> M&gt;
<span class="hljs-keyword">inline</span> v8::Local&lt;T&gt; New(Persistent&lt;T, M&gt; <span class="hljs-keyword">const</span>&amp; p) {
  <span class="hljs-keyword">return</span> v8::Local&lt;T&gt;::New(p.persistent);
}

<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> T&gt;
<span class="hljs-keyword">inline</span> v8::Local&lt;T&gt; New(Global&lt;T&gt; <span class="hljs-keyword">const</span>&amp; p) {
  <span class="hljs-keyword">return</span> v8::Local&lt;T&gt;::New(p.persistent);
}

<span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span>  <span class="hljs-comment">// NAN_IMPLEMENTATION_PRE_12_INL_H_</span></span>

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
