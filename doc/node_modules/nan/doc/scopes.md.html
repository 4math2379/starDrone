<!DOCTYPE html>
<html>
<head>
  <title>scopes.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "node_modules/nan/doc/scopes.md";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h2">
        <a href="#scopes">Scopes</a>
      </div>

      <div class="heading h3">
        <a href="#nan-handlescope">Nan::HandleScope</a>
      </div>

      <div class="heading h3">
        <a href="#nan-escapablehandlescope">Nan::EscapableHandleScope</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="scopes">
  <h2>
    <a href="#scopes" name="scopes" class="pilcrow"></a>
Scopes
  </h2>
</div>
<p>A <em>local handle</em> is a pointer to an object. All V8 objects are accessed using handles, they are necessary because of the way the V8 garbage collector works.</p>
<p>A handle scope can be thought of as a container for any number of handles. When you've finished with your handles, instead of deleting each one individually you can simply delete their scope.</p>
<p>The creation of <code>HandleScope</code> objects is different across the supported versions of V8. Therefore, NAN provides its own implementations that can be used safely across these.</p>
<ul>
<li><a href="#api_nan_handle_scope"><b><code>Nan::HandleScope</code></b></a></li>
<li><a href="#api_nan_escapable_handle_scope"><b><code>Nan::EscapableHandleScope</code></b></a></li>
</ul>
<p>Also see the V8 Embedders Guide section on <a href="https://developers.google.com/v8/embed#handles">Handles and Garbage Collection</a>.</p>
<p><a name="api_nan_handle_scope"></a></p>
<div class="pilwrap" id="nan-handlescope">
  <h3>
    <a href="#nan-handlescope" name="nan-handlescope" class="pilcrow"></a>
Nan::HandleScope
  </h3>
</div>
<p>A simple wrapper around <a href="https://v8docs.nodesource.com/io.js-3.0/d3/d95/classv8_1_1_handle_scope.html"><code>v8::HandleScope</code></a>.</p>
<p>Definition:</p>
<pre><code class="c++"><span class="hljs-keyword">class</span> Nan::HandleScope {
 <span class="hljs-keyword">public</span>:
  Nan::HandleScope();
  <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">NumberOfHandles</span><span class="hljs-params">()</span></span>;
};
</code></pre>
<p>Allocate a new <code>Nan::HandleScope</code> whenever you are creating new V8 JavaScript objects. Note that an implicit <code>HandleScope</code> is created for you on JavaScript-accessible methods so you do not need to insert one yourself.</p>
<p>Example:</p>
<pre><code class="c++"><span class="hljs-comment">// new object is created, it needs a new scope:</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Pointless</span><span class="hljs-params">()</span> </span>{
  Nan::HandleScope scope;
  v8::Local&lt;v8::Object&gt; obj = Nan::New&lt;v8::Object&gt;();
}

<span class="hljs-comment">// JavaScript-accessible method already has a HandleScope</span>
NAN_METHOD(Pointless2) {
  v8::Local&lt;v8::Object&gt; obj = Nan::New&lt;v8::Object&gt;();
}
</code></pre>
<p><a name="api_nan_escapable_handle_scope"></a></p>
<div class="pilwrap" id="nan-escapablehandlescope">
  <h3>
    <a href="#nan-escapablehandlescope" name="nan-escapablehandlescope" class="pilcrow"></a>
Nan::EscapableHandleScope
  </h3>
</div>
<p>Similar to <a href="#api_nan_handle_scope.html"><code>Nan::HandleScope</code></a> but should be used in cases where a function needs to return a V8 JavaScript type that has been created within it.</p>
<p>Definition:</p>
<pre><code class="c++"><span class="hljs-keyword">class</span> Nan::EscapableHandleScope {
 <span class="hljs-keyword">public</span>:
  Nan::EscapableHandleScope();
  <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">NumberOfHandles</span><span class="hljs-params">()</span></span>;
  <span class="hljs-keyword">template</span>&lt;<span class="hljs-keyword">typename</span> T&gt; v8::Local&lt;T&gt; Escape(v8::Local&lt;T&gt; value);
}
</code></pre>
<p>Use <code>Escape(value)</code> to return the object.</p>
<p>Example:</p>
<pre><code class="c++">v8::Local&lt;v8::Object&gt; EmptyObj() {
  Nan::EscapableHandleScope scope;
  v8::Local&lt;v8::Object&gt; obj = Nan::New&lt;v8::Object&gt;();
  <span class="hljs-keyword">return</span> scope.Escape(obj);
}
</code></pre>
</div>
  </div>
</body>
</html>
