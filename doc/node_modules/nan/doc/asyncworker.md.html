<!DOCTYPE html>
<html>
<head>
  <title>asyncworker.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "node_modules/nan/doc/asyncworker.md";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h2">
        <a href="#asynchronous-work-helpers">Asynchronous work helpers</a>
      </div>

      <div class="heading h3">
        <a href="#nan-asyncworker">Nan::AsyncWorker</a>
      </div>

      <div class="heading h3">
        <a href="#nan-asyncprogressworker">Nan::AsyncProgressWorker</a>
      </div>

      <div class="heading h3">
        <a href="#nan-asyncqueueworker">Nan::AsyncQueueWorker</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="asynchronous-work-helpers">
  <h2>
    <a href="#asynchronous-work-helpers" name="asynchronous-work-helpers" class="pilcrow"></a>
Asynchronous work helpers
  </h2>
</div>
<p><code>Nan::AsyncWorker</code> and <code>Nan::AsyncProgressWorker</code> are helper classes that make working with asynchronous code easier.</p>
<ul>
<li><a href="#api_nan_async_worker"><b><code>Nan::AsyncWorker</code></b></a></li>
<li><a href="#api_nan_async_progress_worker"><b><code>Nan::AsyncProgressWorker</code></b></a></li>
<li><a href="#api_nan_async_queue_worker"><b><code>Nan::AsyncQueueWorker</code></b></a></li>
</ul>
<p><a name="api_nan_async_worker"></a></p>
<div class="pilwrap" id="nan-asyncworker">
  <h3>
    <a href="#nan-asyncworker" name="nan-asyncworker" class="pilcrow"></a>
Nan::AsyncWorker
  </h3>
</div>
<p><code>Nan::AsyncWorker</code> is an <em>abstract</em> class that you can subclass to have much of the annoying asynchronous queuing and handling taken care of for you. It can even store arbitrary V8 objects for you and have them persist while the asynchronous work is in progress.</p>
<p>Definition:</p>
<pre><code class="c++"><span class="hljs-keyword">class</span> AsyncWorker {
 <span class="hljs-keyword">public</span>:
  <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">AsyncWorker</span><span class="hljs-params">(Callback *callback_)</span></span>;

  <span class="hljs-keyword">virtual</span> ~AsyncWorker();

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WorkComplete</span><span class="hljs-params">()</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SaveToPersistent</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *key, <span class="hljs-keyword">const</span> v8::Local&lt;v8::Value&gt; &amp;value)</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SaveToPersistent</span><span class="hljs-params">(<span class="hljs-keyword">const</span> v8::Local&lt;v8::String&gt; &amp;key,
                        <span class="hljs-keyword">const</span> v8::Local&lt;v8::Value&gt; &amp;value)</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SaveToPersistent</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span> index,
                        <span class="hljs-keyword">const</span> v8::Local&lt;v8::Value&gt; &amp;value)</span></span>;

  v8::Local&lt;v8::Value&gt; GetFromPersistent(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *key) <span class="hljs-keyword">const</span>;

  v8::Local&lt;v8::Value&gt; GetFromPersistent(<span class="hljs-keyword">const</span> v8::Local&lt;v8::String&gt; &amp;key) <span class="hljs-keyword">const</span>;

  v8::Local&lt;v8::Value&gt; GetFromPersistent(<span class="hljs-keyword">uint32_t</span> index) <span class="hljs-keyword">const</span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Execute</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;

  <span class="hljs-keyword">uv_work_t</span> request;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Destroy</span><span class="hljs-params">()</span></span>;

 <span class="hljs-keyword">protected</span>:
  Persistent&lt;v8::Object&gt; persistentHandle;

  Callback *callback;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleOKCallback</span><span class="hljs-params">()</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleErrorCallback</span><span class="hljs-params">()</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetErrorMessage</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *msg)</span></span>;

  <span class="hljs-function"><span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* <span class="hljs-title">ErrorMessage</span><span class="hljs-params">()</span></span>;
};
</code></pre>
<p><a name="api_nan_async_progress_worker"></a></p>
<div class="pilwrap" id="nan-asyncprogressworker">
  <h3>
    <a href="#nan-asyncprogressworker" name="nan-asyncprogressworker" class="pilcrow"></a>
Nan::AsyncProgressWorker
  </h3>
</div>
<p><code>Nan::AsyncProgressWorker</code> is an <em>abstract</em> class that extends <code>Nan::AsyncWorker</code> and adds additional progress reporting callbacks that can be used during the asynchronous work execution to provide progress data back to JavaScript.</p>
<p>Definition:</p>
<pre><code class="c++"><span class="hljs-keyword">class</span> AsyncProgressWorker : <span class="hljs-keyword">public</span> AsyncWorker {
 <span class="hljs-keyword">public</span>:
  <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">AsyncProgressWorker</span><span class="hljs-params">(Callback *callback_)</span></span>;

  <span class="hljs-keyword">virtual</span> ~AsyncProgressWorker();

  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">WorkProgress</span><span class="hljs-params">()</span></span>;

  <span class="hljs-keyword">class</span> ExecutionProgress {
   <span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Send</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* data, <span class="hljs-keyword">size_t</span> size)</span> <span class="hljs-keyword">const</span></span>;
  };

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Execute</span><span class="hljs-params">(<span class="hljs-keyword">const</span> ExecutionProgress&amp; progress)</span> </span>= <span class="hljs-number">0</span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HandleProgressCallback</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *data, <span class="hljs-keyword">size_t</span> size)</span> </span>= <span class="hljs-number">0</span>;

  <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Destroy</span><span class="hljs-params">()</span></span>;
</code></pre>
<p><a name="api_nan_async_queue_worker"></a></p>
<div class="pilwrap" id="nan-asyncqueueworker">
  <h3>
    <a href="#nan-asyncqueueworker" name="nan-asyncqueueworker" class="pilcrow"></a>
Nan::AsyncQueueWorker
  </h3>
</div>
<p><code>Nan::AsyncQueueWorker</code> will run a <code>Nan::AsyncWorker</code> asynchronously via libuv. Both the <code>execute</code> and <code>after_work</code> steps are taken care of for you. Most of the logic for this is embedded in <code>Nan::AsyncWorker</code>.</p>
<p>Definition:</p>
<pre><code class="c++"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">AsyncQueueWorker</span><span class="hljs-params">(AsyncWorker *)</span></span>;
</code></pre>
</div>
  </div>
</body>
</html>
