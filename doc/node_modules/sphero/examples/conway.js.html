<!DOCTYPE html>
<html>
<head>
  <title>conway.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "node_modules/sphero/examples/conway.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>conway.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">"use strict"</span>;

<span class="hljs-comment">/* eslint key-spacing: 0, no-use-before-define: 0 */</span>

<span class="hljs-keyword">var</span> sphero = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../"</span>);

<span class="hljs-keyword">var</span> spheros = {
  <span class="hljs-attr">Thelma</span> : sphero(process.env.PORT),
  <span class="hljs-attr">Louise</span> : sphero(<span class="hljs-string">"/dev/rfcomm1"</span>),
  <span class="hljs-attr">Grace</span>  : sphero(<span class="hljs-string">"/dev/rfcomm2"</span>),
  <span class="hljs-attr">Ada</span>    : sphero(<span class="hljs-string">"/dev/rfcomm3"</span>)
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{
  connect(spheros, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Spheros are connected, starting game."</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> spheros) { start(name); }
  });
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>connects all spheros, triggering callback when done</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">connect</span>(<span class="hljs-params">orbs, callback</span>) </span>{
  <span class="hljs-keyword">var</span> total = <span class="hljs-built_in">Object</span>.keys(orbs).length,
      finished = <span class="hljs-number">0</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">done</span>(<span class="hljs-params"></span>) </span>{
    finished++;
    <span class="hljs-keyword">if</span> (finished &gt;= total) { callback(); }
  }

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> orbs) {
    orbs[name].connect(done);
  }
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>tells each Sphero what to do</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">var</span> orb = spheros[name],
      contacts = <span class="hljs-number">0</span>,
      age = <span class="hljs-number">0</span>,
      alive = <span class="hljs-literal">false</span>;

  orb.detectCollisions();

  born();

  orb.on(<span class="hljs-string">"collision"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ contacts += <span class="hljs-number">1</span>; });

  setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">if</span> (alive) { move(); } }, <span class="hljs-number">3000</span>);
  setInterval(birthday, <span class="hljs-number">10000</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>roll Sphero in a random direction</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">move</span>(<span class="hljs-params"></span>) </span>{
    orb.roll(<span class="hljs-number">60</span>, <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">360</span>));
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>stop Sphero</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stop</span>(<span class="hljs-params"></span>) </span>{
    orb.stop();
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>set Sphero's color</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">color</span>(<span class="hljs-params">str</span>) </span>{
    orb.color(str);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">born</span>(<span class="hljs-params"></span>) </span>{
    contacts = <span class="hljs-number">0</span>;
    age = <span class="hljs-number">0</span>;
    life();
    move();
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">life</span>(<span class="hljs-params"></span>) </span>{
    alive = <span class="hljs-literal">true</span>;
    color(<span class="hljs-string">"green"</span>);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">death</span>(<span class="hljs-params"></span>) </span>{
    alive = <span class="hljs-literal">false</span>;
    color(<span class="hljs-string">"red"</span>);
    stop();
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">enoughContacts</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> contacts &gt;= <span class="hljs-number">2</span> &amp;&amp; contacts &lt; <span class="hljs-number">7</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">birthday</span>(<span class="hljs-params"></span>) </span>{
    age += <span class="hljs-number">1</span>;

    <span class="hljs-keyword">if</span> (alive) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Happy birthday,"</span>, name);
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"You are"</span>, age, <span class="hljs-string">"and had"</span>, contacts, <span class="hljs-string">"contacts."</span>);
    }

    <span class="hljs-keyword">if</span> (enoughContacts()) {
      <span class="hljs-keyword">if</span> (!alive) { born(); }
    } <span class="hljs-keyword">else</span> {
      death();
    }
  }
}

main();

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
