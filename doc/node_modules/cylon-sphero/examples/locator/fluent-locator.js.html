<!DOCTYPE html>
<html>
<head>
  <title>fluent-locator.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../";
    var thisFile = "node_modules/cylon-sphero/examples/locator/fluent-locator.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>fluent-locator.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">"use strict"</span>;

<span class="hljs-keyword">var</span> Cylon = <span class="hljs-built_in">require</span>(<span class="hljs-string">"cylon"</span>);

Cylon
  .robot()
  .connection(<span class="hljs-string">"sphero"</span>, { <span class="hljs-attr">adaptor</span>: <span class="hljs-string">"sphero"</span>, <span class="hljs-attr">port</span>: <span class="hljs-string">"/dev/rfcomm0"</span> })
  .device(<span class="hljs-string">"sphero"</span>, { <span class="hljs-attr">driver</span>: <span class="hljs-string">"sphero"</span> })
  .on(<span class="hljs-string">"ready"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bot</span>) </span>{
    <span class="hljs-keyword">var</span> color = <span class="hljs-number">0x00FF00</span>,
    bitFilter = <span class="hljs-number">0xFFFF00</span>;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Setting up Collision Detection..."</span>);

    bot.sphero.on(<span class="hljs-string">"dataStreaming"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"data:"</span>);
      <span class="hljs-built_in">console</span>.log(data);
    });

    bot.sphero.on(<span class="hljs-string">"collision"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Collision:"</span>);
      color = color ^ bitFilter;
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Color: "</span> + (color.toString(<span class="hljs-number">16</span>)) + <span class="hljs-string">" "</span>);
      bot.sphero.color(color);
      bot.sphero.roll(<span class="hljs-number">128</span>, <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">360</span>));
    });

    bot.sphero.detectCollisions();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>To detect locator, accelOne and velocity from the sphero
we use setDataStreaming.
sphero API data sources for locator info are as follows:
[&quot;locator&quot;, &quot;accelOne&quot;, &quot;velocity&quot;]
It is also possible to pass an opts object to setDataStreaming():</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> opts = {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>n: int, divisor of the max sampling rate, 400 hz/s
n = 40 means 400/40 = 10 data samples per second,
n = 200 means 400/200 = 2 data samples per second</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      n: <span class="hljs-number">200</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>m: int, number of data packets buffered before passing to the stream
m = 10 means each time you get data it will contain 10 data packets
m = 1 is usually best for real time data readings.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      m: <span class="hljs-number">1</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>pcnt: 1 -255, how many packets to send.
pcnt = 0 means unlimited data Streaming
pcnt = 10 means stop after 10 data packets</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      pcnt: <span class="hljs-number">0</span>,
      <span class="hljs-attr">dataSources</span>: [<span class="hljs-string">"locator"</span>, <span class="hljs-string">"accelOne"</span>, <span class="hljs-string">"velocity"</span>]
    };

    bot.sphero.setDataStreaming(opts);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>SetBackLED turns on the tail LED of the sphero that helps
identify the direction the sphero is heading.
accepts a param with a value from 0 to 255, led brightness.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    bot.sphero.setBackLed(<span class="hljs-number">192</span>);
    bot.sphero.color(color);
  });

Cylon.start();

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
