<!DOCTYPE html>
<html>
<head>
  <title>messages.markdown</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../doc-style.css" />
  <script src="../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../";
    var thisFile = "node_modules/cylon-sphero/examples/messages/messages.markdown";
    var defaultSidebar = true;
  </script>
  <script src="../../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#sphero-messages">Sphero Messages</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="sphero-messages">
  <h1>
    <a href="#sphero-messages" name="sphero-messages" class="pilcrow"></a>
Sphero Messages
  </h1>
</div>
<p>For this Cylon example, we're going to hook up to a Sphero, and respond to
a number of events the Sphero adaptor is capable of emitting. Before we get
started, make sure you've got the <code>cylon-sphero</code> module installed.</p>
<p>To get started, let's import the Cylon module:</p>
<pre><code>var Cylon = require('cylon');
</code></pre>
<p>With that set up, we can start defining our robot:</p>
<pre><code>Cylon.robot({
</code></pre>
<p>As with other Sphero examples, we'll have one connection and one device, both
the same Sphero.</p>
<pre><code>  connections: {
    sphero: { adaptor: 'sphero', port: '/dev/rfcomm0' }
  },

  devices: {
    sphero: { driver: 'sphero' }
  },
</code></pre>
<p>And now we can start defining our robot's work.</p>
<pre><code>  work: function(bot) {

    console.log(&quot;Setting up Collision Detection...&quot;);
</code></pre>
<p>First we add our listeners, when the Sphero emits an 'update' event, we want to
log the data it's provided to us:
bot.sphero.on(&quot;update&quot;, function(data) {
console.log(&quot;Update event eventName: &quot; + data + &quot; &quot;);
console.log(&quot;Update event args: &quot;);
console.log(data);
});</p>
<p>Similarly, when we get <code>data</code> from the Sphero, we want to log it, but
we'll also change it's color while we're at it.</p>
<pre><code>    bot.sphero.on(&quot;data&quot;, function(data) {
      bot.sphero.color(0x00FFFF);
      console.log(&quot;Data event args: &quot;);
      console.log(data);
    });
</code></pre>
<p>We also display the payload for <code>response</code> events, this are triggered when we get a
response from a command back.</p>
<pre><code>    bot.sphero.on(&quot;response&quot;, function(data) {
      bot.sphero.color(0x0000FF);
      console.log(&quot;Response:&quot;);
      console.log(data);
    });
</code></pre>
<p>In the event of a collision, we want to change the color of the Sphero again, as
well as logging the data provided by the collision event.</p>
<pre><code>    bot.sphero.on(&quot;collision&quot;, function(data) {
      bot.sphero.color(0xFFDD00);
      console.log(&quot;Collision:&quot;);
      console.log(data);
    });
</code></pre>
<p>And, last but not least, when we get an <code>async</code> event every time sphero streams
asynchronous data.</p>
<pre><code>    bot.sphero.on(&quot;async&quot;, function(data) {
      bot.sphero.color(0xFF0000);
      console.log(&quot;Async:&quot;);
      console.log(data);
    });
</code></pre>
<p>After addinr our listeners, we want to set up collision detection and change
it's color.</p>
<pre><code>    bot.sphero.detectCollisions();
    bot.sphero.color(0x00FF00);

  }
</code></pre>
<p>And with all that done, we can finally start the robot.</p>
<pre><code>}).start();
</code></pre>
</div>
  </div>
</body>
</html>
