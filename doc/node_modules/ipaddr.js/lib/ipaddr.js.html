<!DOCTYPE html>
<html>
<head>
  <title>ipaddr.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "node_modules/ipaddr.js/lib/ipaddr.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>ipaddr.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> expandIPv6, ipaddr, ipv4Part, ipv4Regexes, ipv6Part, ipv6Regexes, matchCIDR, root;

  ipaddr = {};

  root = <span class="hljs-keyword">this</span>;

  <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> !== <span class="hljs-string">"undefined"</span> &amp;&amp; <span class="hljs-built_in">module</span> !== <span class="hljs-literal">null</span>) &amp;&amp; <span class="hljs-built_in">module</span>.exports) {
    <span class="hljs-built_in">module</span>.exports = ipaddr;
  } <span class="hljs-keyword">else</span> {
    root[<span class="hljs-string">'ipaddr'</span>] = ipaddr;
  }

  matchCIDR = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">first, second, partSize, cidrBits</span>) </span>{
    <span class="hljs-keyword">var</span> part, shift;
    <span class="hljs-keyword">if</span> (first.length !== second.length) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: cannot match CIDR for objects with different lengths"</span>);
    }
    part = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (cidrBits &gt; <span class="hljs-number">0</span>) {
      shift = partSize - cidrBits;
      <span class="hljs-keyword">if</span> (shift &lt; <span class="hljs-number">0</span>) {
        shift = <span class="hljs-number">0</span>;
      }
      <span class="hljs-keyword">if</span> (first[part] &gt;&gt; shift !== second[part] &gt;&gt; shift) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      }
      cidrBits -= partSize;
      part += <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  };

  ipaddr.subnetMatch = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">address, rangeList, defaultName</span>) </span>{
    <span class="hljs-keyword">var</span> rangeName, rangeSubnets, subnet, _i, _len;
    <span class="hljs-keyword">if</span> (defaultName == <span class="hljs-literal">null</span>) {
      defaultName = <span class="hljs-string">'unicast'</span>;
    }
    <span class="hljs-keyword">for</span> (rangeName <span class="hljs-keyword">in</span> rangeList) {
      rangeSubnets = rangeList[rangeName];
      <span class="hljs-keyword">if</span> (rangeSubnets[<span class="hljs-number">0</span>] &amp;&amp; !(rangeSubnets[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>)) {
        rangeSubnets = [rangeSubnets];
      }
      <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = rangeSubnets.length; _i &lt; _len; _i++) {
        subnet = rangeSubnets[_i];
        <span class="hljs-keyword">if</span> (address.match.apply(address, subnet)) {
          <span class="hljs-keyword">return</span> rangeName;
        }
      }
    }
    <span class="hljs-keyword">return</span> defaultName;
  };

  ipaddr.IPv4 = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IPv4</span>(<span class="hljs-params">octets</span>) </span>{
      <span class="hljs-keyword">var</span> octet, _i, _len;
      <span class="hljs-keyword">if</span> (octets.length !== <span class="hljs-number">4</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: ipv4 octet count should be 4"</span>);
      }
      <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = octets.length; _i &lt; _len; _i++) {
        octet = octets[_i];
        <span class="hljs-keyword">if</span> (!((<span class="hljs-number">0</span> &lt;= octet &amp;&amp; octet &lt;= <span class="hljs-number">255</span>))) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: ipv4 octet should fit in 8 bits"</span>);
        }
      }
      <span class="hljs-keyword">this</span>.octets = octets;
    }

    IPv4.prototype.kind = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">'ipv4'</span>;
    };

    IPv4.prototype.toString = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.octets.join(<span class="hljs-string">"."</span>);
    };

    IPv4.prototype.toByteArray = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.octets.slice(<span class="hljs-number">0</span>);
    };

    IPv4.prototype.match = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">other, cidrRange</span>) </span>{
      <span class="hljs-keyword">var</span> _ref;
      <span class="hljs-keyword">if</span> (cidrRange === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>) {
        _ref = other, other = _ref[<span class="hljs-number">0</span>], cidrRange = _ref[<span class="hljs-number">1</span>];
      }
      <span class="hljs-keyword">if</span> (other.kind() !== <span class="hljs-string">'ipv4'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: cannot match ipv4 address with non-ipv4 one"</span>);
      }
      <span class="hljs-keyword">return</span> matchCIDR(<span class="hljs-keyword">this</span>.octets, other.octets, <span class="hljs-number">8</span>, cidrRange);
    };

    IPv4.prototype.SpecialRanges = {
      <span class="hljs-attr">unspecified</span>: [[<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">8</span>]],
      <span class="hljs-attr">broadcast</span>: [[<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>]), <span class="hljs-number">32</span>]],
      <span class="hljs-attr">multicast</span>: [[<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">224</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">4</span>]],
      <span class="hljs-attr">linkLocal</span>: [[<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">169</span>, <span class="hljs-number">254</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">16</span>]],
      <span class="hljs-attr">loopback</span>: [[<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">127</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">8</span>]],
      <span class="hljs-string">"private"</span>: [[<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">8</span>], [<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">172</span>, <span class="hljs-number">16</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">12</span>], [<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">192</span>, <span class="hljs-number">168</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">16</span>]],
      <span class="hljs-attr">reserved</span>: [[<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">192</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">24</span>], [<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">192</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">24</span>], [<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">192</span>, <span class="hljs-number">88</span>, <span class="hljs-number">99</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">24</span>], [<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">198</span>, <span class="hljs-number">51</span>, <span class="hljs-number">100</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">24</span>], [<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">203</span>, <span class="hljs-number">0</span>, <span class="hljs-number">113</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">24</span>], [<span class="hljs-keyword">new</span> IPv4([<span class="hljs-number">240</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">4</span>]]
    };

    IPv4.prototype.range = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> ipaddr.subnetMatch(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.SpecialRanges);
    };

    IPv4.prototype.toIPv4MappedAddress = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> ipaddr.IPv6.parse(<span class="hljs-string">"::ffff:"</span> + (<span class="hljs-keyword">this</span>.toString()));
    };

    IPv4.prototype.prefixLengthFromSubnetMask = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> cidr, i, octet, stop, zeros, zerotable, _i;
      zerotable = {
        <span class="hljs-number">0</span>: <span class="hljs-number">8</span>,
        <span class="hljs-number">128</span>: <span class="hljs-number">7</span>,
        <span class="hljs-number">192</span>: <span class="hljs-number">6</span>,
        <span class="hljs-number">224</span>: <span class="hljs-number">5</span>,
        <span class="hljs-number">240</span>: <span class="hljs-number">4</span>,
        <span class="hljs-number">248</span>: <span class="hljs-number">3</span>,
        <span class="hljs-number">252</span>: <span class="hljs-number">2</span>,
        <span class="hljs-number">254</span>: <span class="hljs-number">1</span>,
        <span class="hljs-number">255</span>: <span class="hljs-number">0</span>
      };
      cidr = <span class="hljs-number">0</span>;
      stop = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">for</span> (i = _i = <span class="hljs-number">3</span>; _i &gt;= <span class="hljs-number">0</span>; i = _i += <span class="hljs-number">-1</span>) {
        octet = <span class="hljs-keyword">this</span>.octets[i];
        <span class="hljs-keyword">if</span> (octet <span class="hljs-keyword">in</span> zerotable) {
          zeros = zerotable[octet];
          <span class="hljs-keyword">if</span> (stop &amp;&amp; zeros !== <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
          }
          <span class="hljs-keyword">if</span> (zeros !== <span class="hljs-number">8</span>) {
            stop = <span class="hljs-literal">true</span>;
          }
          cidr += zeros;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-number">32</span> - cidr;
    };

    <span class="hljs-keyword">return</span> IPv4;

  })();

  ipv4Part = <span class="hljs-string">"(0?\\d+|0x[a-f0-9]+)"</span>;

  ipv4Regexes = {
    <span class="hljs-attr">fourOctet</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"^"</span> + ipv4Part + <span class="hljs-string">"\\."</span> + ipv4Part + <span class="hljs-string">"\\."</span> + ipv4Part + <span class="hljs-string">"\\."</span> + ipv4Part + <span class="hljs-string">"$"</span>, <span class="hljs-string">'i'</span>),
    <span class="hljs-attr">longValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"^"</span> + ipv4Part + <span class="hljs-string">"$"</span>, <span class="hljs-string">'i'</span>)
  };

  ipaddr.IPv4.parser = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> match, parseIntAuto, part, shift, value;
    parseIntAuto = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
      <span class="hljs-keyword">if</span> (string[<span class="hljs-number">0</span>] === <span class="hljs-string">"0"</span> &amp;&amp; string[<span class="hljs-number">1</span>] !== <span class="hljs-string">"x"</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(string, <span class="hljs-number">8</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(string);
      }
    };
    <span class="hljs-keyword">if</span> (match = string.match(ipv4Regexes.fourOctet)) {
      <span class="hljs-keyword">return</span> (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> _i, _len, _ref, _results;
        _ref = match.slice(<span class="hljs-number">1</span>, <span class="hljs-number">6</span>);
        _results = [];
        <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = _ref.length; _i &lt; _len; _i++) {
          part = _ref[_i];
          _results.push(parseIntAuto(part));
        }
        <span class="hljs-keyword">return</span> _results;
      })();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (match = string.match(ipv4Regexes.longValue)) {
      value = parseIntAuto(match[<span class="hljs-number">1</span>]);
      <span class="hljs-keyword">if</span> (value &gt; <span class="hljs-number">0xffffffff</span> || value &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: address outside defined range"</span>);
      }
      <span class="hljs-keyword">return</span> ((<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> _i, _results;
        _results = [];
        <span class="hljs-keyword">for</span> (shift = _i = <span class="hljs-number">0</span>; _i &lt;= <span class="hljs-number">24</span>; shift = _i += <span class="hljs-number">8</span>) {
          _results.push((value &gt;&gt; shift) &amp; <span class="hljs-number">0xff</span>);
        }
        <span class="hljs-keyword">return</span> _results;
      })()).reverse();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  };

  ipaddr.IPv6 = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">IPv6</span>(<span class="hljs-params">parts</span>) </span>{
      <span class="hljs-keyword">var</span> i, part, _i, _j, _len, _ref;
      <span class="hljs-keyword">if</span> (parts.length === <span class="hljs-number">16</span>) {
        <span class="hljs-keyword">this</span>.parts = [];
        <span class="hljs-keyword">for</span> (i = _i = <span class="hljs-number">0</span>; _i &lt;= <span class="hljs-number">14</span>; i = _i += <span class="hljs-number">2</span>) {
          <span class="hljs-keyword">this</span>.parts.push((parts[i] &lt;&lt; <span class="hljs-number">8</span>) | parts[i + <span class="hljs-number">1</span>]);
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (parts.length === <span class="hljs-number">8</span>) {
        <span class="hljs-keyword">this</span>.parts = parts;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: ipv6 part count should be 8 or 16"</span>);
      }
      _ref = <span class="hljs-keyword">this</span>.parts;
      <span class="hljs-keyword">for</span> (_j = <span class="hljs-number">0</span>, _len = _ref.length; _j &lt; _len; _j++) {
        part = _ref[_j];
        <span class="hljs-keyword">if</span> (!((<span class="hljs-number">0</span> &lt;= part &amp;&amp; part &lt;= <span class="hljs-number">0xffff</span>))) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: ipv6 part should fit in 16 bits"</span>);
        }
      }
    }

    IPv6.prototype.kind = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-string">'ipv6'</span>;
    };

    IPv6.prototype.toString = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> compactStringParts, part, pushPart, state, stringParts, _i, _len;
      stringParts = (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> _i, _len, _ref, _results;
        _ref = <span class="hljs-keyword">this</span>.parts;
        _results = [];
        <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = _ref.length; _i &lt; _len; _i++) {
          part = _ref[_i];
          _results.push(part.toString(<span class="hljs-number">16</span>));
        }
        <span class="hljs-keyword">return</span> _results;
      }).call(<span class="hljs-keyword">this</span>);
      compactStringParts = [];
      pushPart = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">part</span>) </span>{
        <span class="hljs-keyword">return</span> compactStringParts.push(part);
      };
      state = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = stringParts.length; _i &lt; _len; _i++) {
        part = stringParts[_i];
        <span class="hljs-keyword">switch</span> (state) {
          <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
            <span class="hljs-keyword">if</span> (part === <span class="hljs-string">'0'</span>) {
              pushPart(<span class="hljs-string">''</span>);
            } <span class="hljs-keyword">else</span> {
              pushPart(part);
            }
            state = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
            <span class="hljs-keyword">if</span> (part === <span class="hljs-string">'0'</span>) {
              state = <span class="hljs-number">2</span>;
            } <span class="hljs-keyword">else</span> {
              pushPart(part);
            }
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
            <span class="hljs-keyword">if</span> (part !== <span class="hljs-string">'0'</span>) {
              pushPart(<span class="hljs-string">''</span>);
              pushPart(part);
              state = <span class="hljs-number">3</span>;
            }
            <span class="hljs-keyword">break</span>;
          <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
            pushPart(part);
        }
      }
      <span class="hljs-keyword">if</span> (state === <span class="hljs-number">2</span>) {
        pushPart(<span class="hljs-string">''</span>);
        pushPart(<span class="hljs-string">''</span>);
      }
      <span class="hljs-keyword">return</span> compactStringParts.join(<span class="hljs-string">":"</span>);
    };

    IPv6.prototype.toByteArray = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> bytes, part, _i, _len, _ref;
      bytes = [];
      _ref = <span class="hljs-keyword">this</span>.parts;
      <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = _ref.length; _i &lt; _len; _i++) {
        part = _ref[_i];
        bytes.push(part &gt;&gt; <span class="hljs-number">8</span>);
        bytes.push(part &amp; <span class="hljs-number">0xff</span>);
      }
      <span class="hljs-keyword">return</span> bytes;
    };

    IPv6.prototype.toNormalizedString = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> part;
      <span class="hljs-keyword">return</span> ((<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> _i, _len, _ref, _results;
        _ref = <span class="hljs-keyword">this</span>.parts;
        _results = [];
        <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = _ref.length; _i &lt; _len; _i++) {
          part = _ref[_i];
          _results.push(part.toString(<span class="hljs-number">16</span>));
        }
        <span class="hljs-keyword">return</span> _results;
      }).call(<span class="hljs-keyword">this</span>)).join(<span class="hljs-string">":"</span>);
    };

    IPv6.prototype.match = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">other, cidrRange</span>) </span>{
      <span class="hljs-keyword">var</span> _ref;
      <span class="hljs-keyword">if</span> (cidrRange === <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>) {
        _ref = other, other = _ref[<span class="hljs-number">0</span>], cidrRange = _ref[<span class="hljs-number">1</span>];
      }
      <span class="hljs-keyword">if</span> (other.kind() !== <span class="hljs-string">'ipv6'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: cannot match ipv6 address with non-ipv6 one"</span>);
      }
      <span class="hljs-keyword">return</span> matchCIDR(<span class="hljs-keyword">this</span>.parts, other.parts, <span class="hljs-number">16</span>, cidrRange);
    };

    IPv6.prototype.SpecialRanges = {
      <span class="hljs-attr">unspecified</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">128</span>],
      <span class="hljs-attr">linkLocal</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0xfe80</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">10</span>],
      <span class="hljs-attr">multicast</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0xff00</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">8</span>],
      <span class="hljs-attr">loopback</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>]), <span class="hljs-number">128</span>],
      <span class="hljs-attr">uniqueLocal</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0xfc00</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">7</span>],
      <span class="hljs-attr">ipv4Mapped</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0xffff</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">96</span>],
      <span class="hljs-attr">rfc6145</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0xffff</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">96</span>],
      <span class="hljs-attr">rfc6052</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0x64</span>, <span class="hljs-number">0xff9b</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">96</span>],
      <span class="hljs-string">'6to4'</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0x2002</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">16</span>],
      <span class="hljs-attr">teredo</span>: [<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0x2001</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">32</span>],
      <span class="hljs-attr">reserved</span>: [[<span class="hljs-keyword">new</span> IPv6([<span class="hljs-number">0x2001</span>, <span class="hljs-number">0xdb8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]), <span class="hljs-number">32</span>]]
    };

    IPv6.prototype.range = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> ipaddr.subnetMatch(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>.SpecialRanges);
    };

    IPv6.prototype.isIPv4MappedAddress = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.range() === <span class="hljs-string">'ipv4Mapped'</span>;
    };

    IPv6.prototype.toIPv4Address = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> high, low, _ref;
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isIPv4MappedAddress()) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: trying to convert a generic ipv6 address to ipv4"</span>);
      }
      _ref = <span class="hljs-keyword">this</span>.parts.slice(<span class="hljs-number">-2</span>), high = _ref[<span class="hljs-number">0</span>], low = _ref[<span class="hljs-number">1</span>];
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ipaddr.IPv4([high &gt;&gt; <span class="hljs-number">8</span>, high &amp; <span class="hljs-number">0xff</span>, low &gt;&gt; <span class="hljs-number">8</span>, low &amp; <span class="hljs-number">0xff</span>]);
    };

    <span class="hljs-keyword">return</span> IPv6;

  })();

  ipv6Part = <span class="hljs-string">"(?:[0-9a-f]+::?)+"</span>;

  ipv6Regexes = {
    <span class="hljs-string">"native"</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">"^(::)?("</span> + ipv6Part + <span class="hljs-string">")?([0-9a-f]+)?(::)?$"</span>, <span class="hljs-string">'i'</span>),
    <span class="hljs-attr">transitional</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>((<span class="hljs-string">"^((?:"</span> + ipv6Part + <span class="hljs-string">")|(?:::)(?:"</span> + ipv6Part + <span class="hljs-string">")?)"</span>) + (<span class="hljs-string">""</span> + ipv4Part + <span class="hljs-string">"\\."</span> + ipv4Part + <span class="hljs-string">"\\."</span> + ipv4Part + <span class="hljs-string">"\\."</span> + ipv4Part + <span class="hljs-string">"$"</span>), <span class="hljs-string">'i'</span>)
  };

  expandIPv6 = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string, parts</span>) </span>{
    <span class="hljs-keyword">var</span> colonCount, lastColon, part, replacement, replacementCount;
    <span class="hljs-keyword">if</span> (string.indexOf(<span class="hljs-string">'::'</span>) !== string.lastIndexOf(<span class="hljs-string">'::'</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    colonCount = <span class="hljs-number">0</span>;
    lastColon = <span class="hljs-number">-1</span>;
    <span class="hljs-keyword">while</span> ((lastColon = string.indexOf(<span class="hljs-string">':'</span>, lastColon + <span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span>) {
      colonCount++;
    }
    <span class="hljs-keyword">if</span> (string.substr(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) === <span class="hljs-string">'::'</span>) {
      colonCount--;
    }
    <span class="hljs-keyword">if</span> (string.substr(<span class="hljs-number">-2</span>, <span class="hljs-number">2</span>) === <span class="hljs-string">'::'</span>) {
      colonCount--;
    }
    <span class="hljs-keyword">if</span> (colonCount &gt; parts) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    replacementCount = parts - colonCount;
    replacement = <span class="hljs-string">':'</span>;
    <span class="hljs-keyword">while</span> (replacementCount--) {
      replacement += <span class="hljs-string">'0:'</span>;
    }
    string = string.replace(<span class="hljs-string">'::'</span>, replacement);
    <span class="hljs-keyword">if</span> (string[<span class="hljs-number">0</span>] === <span class="hljs-string">':'</span>) {
      string = string.slice(<span class="hljs-number">1</span>);
    }
    <span class="hljs-keyword">if</span> (string[string.length - <span class="hljs-number">1</span>] === <span class="hljs-string">':'</span>) {
      string = string.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>);
    }
    <span class="hljs-keyword">return</span> (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">var</span> _i, _len, _ref, _results;
      _ref = string.split(<span class="hljs-string">":"</span>);
      _results = [];
      <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = _ref.length; _i &lt; _len; _i++) {
        part = _ref[_i];
        _results.push(<span class="hljs-built_in">parseInt</span>(part, <span class="hljs-number">16</span>));
      }
      <span class="hljs-keyword">return</span> _results;
    })();
  };

  ipaddr.IPv6.parser = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> match, octet, octets, parts, _i, _len;
    <span class="hljs-keyword">if</span> (string.match(ipv6Regexes[<span class="hljs-string">'native'</span>])) {
      <span class="hljs-keyword">return</span> expandIPv6(string, <span class="hljs-number">8</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (match = string.match(ipv6Regexes[<span class="hljs-string">'transitional'</span>])) {
      parts = expandIPv6(match[<span class="hljs-number">1</span>].slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>), <span class="hljs-number">6</span>);
      <span class="hljs-keyword">if</span> (parts) {
        octets = [<span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">2</span>]), <span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">3</span>]), <span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">4</span>]), <span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">5</span>])];
        <span class="hljs-keyword">for</span> (_i = <span class="hljs-number">0</span>, _len = octets.length; _i &lt; _len; _i++) {
          octet = octets[_i];
          <span class="hljs-keyword">if</span> (!((<span class="hljs-number">0</span> &lt;= octet &amp;&amp; octet &lt;= <span class="hljs-number">255</span>))) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
          }
        }
        parts.push(octets[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">8</span> | octets[<span class="hljs-number">1</span>]);
        parts.push(octets[<span class="hljs-number">2</span>] &lt;&lt; <span class="hljs-number">8</span> | octets[<span class="hljs-number">3</span>]);
        <span class="hljs-keyword">return</span> parts;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  };

  ipaddr.IPv4.isIPv4 = ipaddr.IPv6.isIPv6 = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.parser(string) !== <span class="hljs-literal">null</span>;
  };

  ipaddr.IPv4.isValid = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> e;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>(<span class="hljs-keyword">this</span>.parser(string));
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (_error) {
      e = _error;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  };

  ipaddr.IPv4.isValidFourPartDecimal = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">if</span> (ipaddr.IPv4.isValid(string) &amp;&amp; string.match(<span class="hljs-regexp">/^\d+(\.\d+){3}$/</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  };

  ipaddr.IPv6.isValid = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> e;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> string === <span class="hljs-string">"string"</span> &amp;&amp; string.indexOf(<span class="hljs-string">":"</span>) === <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>(<span class="hljs-keyword">this</span>.parser(string));
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (_error) {
      e = _error;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  };

  ipaddr.IPv4.parse = ipaddr.IPv6.parse = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> parts;
    parts = <span class="hljs-keyword">this</span>.parser(string);
    <span class="hljs-keyword">if</span> (parts === <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: string is not formatted like ip address"</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-keyword">this</span>(parts);
  };

  ipaddr.IPv4.parseCIDR = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> maskLength, match;
    <span class="hljs-keyword">if</span> (match = string.match(<span class="hljs-regexp">/^(.+)\/(\d+)$/</span>)) {
      maskLength = <span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">2</span>]);
      <span class="hljs-keyword">if</span> (maskLength &gt;= <span class="hljs-number">0</span> &amp;&amp; maskLength &lt;= <span class="hljs-number">32</span>) {
        <span class="hljs-keyword">return</span> [<span class="hljs-keyword">this</span>.parse(match[<span class="hljs-number">1</span>]), maskLength];
      }
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: string is not formatted like an IPv4 CIDR range"</span>);
  };

  ipaddr.IPv6.parseCIDR = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> maskLength, match;
    <span class="hljs-keyword">if</span> (match = string.match(<span class="hljs-regexp">/^(.+)\/(\d+)$/</span>)) {
      maskLength = <span class="hljs-built_in">parseInt</span>(match[<span class="hljs-number">2</span>]);
      <span class="hljs-keyword">if</span> (maskLength &gt;= <span class="hljs-number">0</span> &amp;&amp; maskLength &lt;= <span class="hljs-number">128</span>) {
        <span class="hljs-keyword">return</span> [<span class="hljs-keyword">this</span>.parse(match[<span class="hljs-number">1</span>]), maskLength];
      }
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: string is not formatted like an IPv6 CIDR range"</span>);
  };

  ipaddr.isValid = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">return</span> ipaddr.IPv6.isValid(string) || ipaddr.IPv4.isValid(string);
  };

  ipaddr.parse = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">if</span> (ipaddr.IPv6.isValid(string)) {
      <span class="hljs-keyword">return</span> ipaddr.IPv6.parse(string);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ipaddr.IPv4.isValid(string)) {
      <span class="hljs-keyword">return</span> ipaddr.IPv4.parse(string);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: the address has neither IPv6 nor IPv4 format"</span>);
    }
  };

  ipaddr.parseCIDR = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> e;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">return</span> ipaddr.IPv6.parseCIDR(string);
    } <span class="hljs-keyword">catch</span> (_error) {
      e = _error;
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> ipaddr.IPv4.parseCIDR(string);
      } <span class="hljs-keyword">catch</span> (_error) {
        e = _error;
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: the address has neither IPv6 nor IPv4 CIDR format"</span>);
      }
    }
  };

  ipaddr.fromByteArray = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bytes</span>) </span>{
    <span class="hljs-keyword">var</span> length;
    length = bytes.length;
    <span class="hljs-keyword">if</span> (length === <span class="hljs-number">4</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ipaddr.IPv4(bytes);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (length === <span class="hljs-number">16</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ipaddr.IPv6(bytes);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"ipaddr: the binary input is neither an IPv6 nor IPv4 address"</span>);
    }
  };

  ipaddr.process = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">var</span> addr;
    addr = <span class="hljs-keyword">this</span>.parse(string);
    <span class="hljs-keyword">if</span> (addr.kind() === <span class="hljs-string">'ipv6'</span> &amp;&amp; addr.isIPv4MappedAddress()) {
      <span class="hljs-keyword">return</span> addr.toIPv4Address();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> addr;
    }
  };

}).call(<span class="hljs-keyword">this</span>);

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
